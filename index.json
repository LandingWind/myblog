[{"categories":["Web"],"content":"å†™åœ¨å‰é¢ Recoilä½œä¸ºReactå®˜æ–¹çš„è¯•éªŒæ€§çŠ¶æ€ç®¡ç†åº“ï¼Œæƒ³æ³•æ–°é¢– Hoxä½œä¸ºèš‚èšä½“éªŒæŠ€æœ¯éƒ¨çš„æˆæœï¼Œä¸šåŠ¡ç»éªŒä¸°å¯Œ åˆ°åº•ä½¿ç”¨èµ·æ¥å“ªä¸€ä¸ªæ¯”è¾ƒé¡ºæ‰‹å‘¢ï¼Ÿ è¿™æ˜¯ä¸€ç¯‡ä¸ä¸¥è°¨çš„React state managerä½“éªŒæ–‡ ","date":"2020-05-31","objectID":"/myblog/recoil-vs-hox/:0:1","tags":["hooks"],"title":"Recoil vs Hox","uri":"/myblog/recoil-vs-hox/"},{"categories":["Web"],"content":"æ¦‚å†µå¯¹æ¯” Recoil æºç åœ¨æ­¤ å®šä¹‰atomä½œä¸ºstateæ•°æ®æºå¤´ï¼Œåˆ‡å‰²å¤§stateä¸ºæœ€å°å•å…ƒ å®šä¹‰selectorå®šä¹‰å‡½æ•°æ˜ å°„åçš„atomï¼Œç›¸å½“äºcomputed atom ä»atom-selector-selectoré“¾è·¯æ¥çœ‹å®šä¹‰äº†ä¸€ä¸ªstate data flow mapï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯å®ƒå®é™…æ˜¯æ”¯æŒåŒå‘è¡ç”Ÿçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®æµåŠ¨å¯ä»¥æ˜¯åŒå‘çš„ï¼ŒselectoråŒæ ·å¯ä»¥å»set atom æ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»æ³¨æ„ä¾èµ–å¾ªç¯ï¼ Hox åŸºäºåŸç”Ÿçš„React Hooksâ€”â€”useStateã€useEffectè¿›è¡Œstateå­˜å‚¨ä»¥åŠä¾èµ–æ›´æ–° é‡‡ç”¨subscriberçš„æ•°æ®è®¢é˜…æ¨¡å¼ æ­¤å¤–é€šè¿‡Object.definePropertyè¿›è¡Œè·å–çŠ¶æ€æ•°æ®æ—¶çš„æ‹¦æˆª æ¨èé˜…è¯»å…¶æå…¶ç²¾ç®€çš„æºç  ","date":"2020-05-31","objectID":"/myblog/recoil-vs-hox/:0:2","tags":["hooks"],"title":"Recoil vs Hox","uri":"/myblog/recoil-vs-hox/"},{"categories":["Web"],"content":"TodoList Demoå¯¹æ¯” é€šè¿‡å®é™…æ¡ˆä¾‹æ¥å¯¹æ¯”ï¼Œæ˜¾å¾—æå…¶æ¸…æ¥š æˆ‘ä»¬åšä¸€ä¸ªtodolist é¦–å…ˆçœ‹çœ‹Recoil æºç  ç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œmockerä¸­å­˜æ”¾äº†æ¨¡æ‹Ÿåç«¯æ•°æ®ï¼Œsrc/storeæ–‡ä»¶å­˜æ”¾äº†æ‰€æœ‰atom/selector recoil-todolist-codetree\" recoil-todolist-codetree ä½¿ç”¨recoilçš„èŠ‚ç‚¹éœ€è¦è¢«åŒ…è£¹ \u003cRecoilRoot\u003e \u003cTodoList\u003e\u003c/TodoList\u003e \u003c/RecoilRoot\u003e å®šä¹‰todolist state atom const listDataState = atom({ key: \"listDataState\", default: [ { id: 1, label: \"learn react and recoil\", visible: true, isDone: false }, { id: 2, label: \"play GTA5\", visible: true, isDone: true }, { id: 3, label: \"listen to music\", visible: true, isDone: false }, { id: 4, label: \"hangout with gf\", visible: true, isDone: true } ] }) ä½¿ç”¨atomï¼Œç„¶åå±•ç¤º const [listData, setListData] = useRecoilState(listDataState); return ( \u003cdiv className=\"list\"\u003e \u003cul\u003e {filteredListData.map((item, index) =\u003e { return ( \u003cli key={index + md5(item.label)}\u003e\u003cTodoItem itemdata={item} /\u003e\u003c/li\u003e ) })} \u003c/ul\u003e \u003c/div\u003e // ...following code ) TodoItemä¸­é€šè¿‡useSetRecoilStateæ›´æ–°atomä¸­æ•°æ®ï¼Œä»è€Œå®ç°todolistçš„toggleã€delete function getNewListData(id, listData) { const list = List(listData); return list.update( list.findIndex((value,_)=\u003evalue.id===id), (item)=\u003e{ return {...item, isDone: !item.isDone} } ); } function delFromListData(id, listData) { return listData.filter(item =\u003e item.id !== id); } function TodoBtn(id, isDone) { const listData = useRecoilValue(listDataState); const setListDataState = useSetRecoilState(listDataState); const type = !isDone ? \"done\" : \"redo\" return ( \u003cspan style={{ marginLeft: 30 }}\u003e \u003cbutton onClick={() =\u003e { setListDataState(getNewListData(id, listData)) }}\u003e{type}\u003c/button\u003e \u003cbutton onClick={() =\u003e { setListDataState(delFromListData(id, listData)) }}\u003edel\u003c/button\u003e \u003c/span\u003e ) } å®šä¹‰ç­›é€‰çš„stateï¼ŒåŠç›¸å…³ç»´æŠ¤ // store.js const filterState = atom({ key: \"filterState\", default: \"all\" }) // TodoList.js const [filter, setFilter] = useRecoilState(filterState); // ... return ( \u003cselect value={filter} onChange={({ target: { value } }) =\u003e setFilter(value)}\u003e \u003coption value=\"all\"\u003eAll\u003c/option\u003e \u003coption value=\"completed\"\u003eCompleted\u003c/option\u003e \u003coption value=\"undos\"\u003eUncompleted\u003c/option\u003e \u003c/select\u003e ) å®šä¹‰ç­›é€‰åçš„todolist selectorï¼Œä¾èµ–äºåŸæœ‰çš„listdata atomå’Œfilter atom const filteredListState = selector({ key: \"filteredListState\", get: ({ get }) =\u003e { const filter = get(filterState); const list = get(listDataState); switch (filter) { case 'all': return list case 'undos': return list.filter((item) =\u003e !item.isDone); default: return list; } }, }) mapçš„listdataæ›¿æ¢ä¸ºfilteredListState å†æ¥çœ‹çœ‹hox æºç  ç›®å½•ç»“æ„ Modelä¸­å­˜æ”¾hoxå®šä¹‰çš„state manager model hox-todolist-codetree\" hox-todolist-codetree useTodoModelä¸­ï¼Œå°†æ‰€æœ‰å’Œtodolistæœ‰å…³åŠŸèƒ½é€»è¾‘å…¨éƒ¨æ”¾åœ¨ä¸€å— import { useState } from 'react' import { createModel } from \"hox\"; import md5 from 'blueimp-md5' function useTodo() { const defaultTodos = [ { id: 1, label: \"learn react and recoil\",isDone: false }, { id: 2, label: \"play GTA5\",isDone: true }, { id: 3, label: \"listen to music\",isDone: false }, { id: 4, label: \"hangout with gf\",isDone: true } ] const [todos, setTodos] = useState(defaultTodos); const [filter, setFilter] = useState('all'); function addTodo(content) { setTodos([...todos, { id: md5(new Date().toTimeString()), label: content, isDone: false }]) } function delTodo(id) { setTodos(todos.filter(item =\u003e item.id !== id)) } function toggleTodo(id) { setTodos(todos.map(item =\u003e { if (item.id === id) { return { ...item, isDone: !item.isDone } } else { return item; } })) } function filteredTodo() { return todos.filter(item =\u003e { if(filter==='undos') { return !item.isDone; } if(filter==='completed') { return item.isDone; } return item; }) } return { todos: filteredTodo(), setTodos, addTodo, delTodo, toggleTodo, setFilter, filter } } export default createModel(useTodo); æ¥ä¸‹æ¥å…·ä½“ç¯å¢ƒä¸­å°±åªæ˜¯useTodoModelçš„æ¥å£è°ƒç”¨ï¼Œä¸äºˆä»¥èµ˜è¿°äº†â€¦ ","date":"2020-05-31","objectID":"/myblog/recoil-vs-hox/:0:3","tags":["hooks"],"title":"Recoil vs Hox","uri":"/myblog/recoil-vs-hox/"},{"categories":["Web"],"content":"æ€è€ƒ recoil èµ°çš„æ˜¯å­¦é™¢æ´¾çš„è·¯çº¿ï¼š å°†stateåˆ‡åˆ†æœ€å°åŒ–atomï¼Œå®šä¹‰selectoræ„å»ºåª²ç¾è®¡ç®—å±æ€§çš„ä¾èµ–å…³ç³»ï¼›è¿™æ ·ä¸€æ¥å¯ä»¥è½»æ¾åˆ‡å‰²åº”ç”¨å†…åŠŸèƒ½æ¨¡å—ï¼Œç”šè‡³å¯ä»¥åœ¨æ¨¡å—å†…ç»§ç»­åˆ‡å‰²ï¼Œä½†æ˜¯æ³¨æ„ä¸åˆ©äºæŠ½ç¦»ä¸šåŠ¡æ•°æ®é€»è¾‘ ä¸»åˆ›äººå‘˜æ˜¾ç„¶èµ°çš„æ˜¯çº¯å‡½æ•°çš„æ€è€ƒæ¨¡å¼ï¼Œåœ¨å¤„ç†å‰¯ä½œç”¨è¿™ä¸€å—ä½¿ç”¨èµ·æ¥ä¸å¤ªæ–¹ä¾¿ï¼Œæœ‰ä¸€å®šç¼ºé™·ï¼Œä½†æ˜¯æ ¹æ®æŠ€æœ¯è®ºå›æ¶ˆæ¯æœ‰æœ›åœ¨ä¸‹ä¸€å¤§ç‰ˆæœ¬è¿­ä»£ä¸­æ›´æ–° åŒå‘è¡ç”Ÿæ•°æ®ï¼Œæ˜æ™°çš„æ•°æ®æµåŠ¨å›¾ï¼Œå¯è¿½æº¯çš„æ—¶å…‰æœºå™¨ä»¥åŠæ‰‹åŠ¨å®šä¹‰keyçš„æ–¹ä¾¿æ•°æ®æŒä¹…åŒ–ç­‰ç­‰åŠŸèƒ½ï¼Œå­¦é™¢æ´¾æ— ç–‘ï¼Œä½†æ˜¯åœ¨ä¸šåŠ¡ä¸­æ²¡æœ‰å¾ˆå¤§çš„ç”¨å¤„ï¼Œè€Œä¸”ä¸€äº›ä¸ºäº†åŠŸèƒ½pureåšå‡ºçš„å¦¥åå¢åŠ äº†å¼€å‘çš„å·¥ä½œé‡ï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰å¸Œæœ›çœ‹åˆ°recoiläºŒæ¬¡å°è£…åº“è§£å†³è¿™äº›é—®é¢˜ hoxèµ°çš„æ˜¯ç¬¦åˆç”¨æˆ·ä¹ æƒ¯çš„è·¯çº¿ï¼š å®ç°æ–¹å¼é‡‡ç”¨åŸç”Ÿreact hookï¼Œä½¿ç”¨èµ·æ¥åªéœ€ä¸€ä¸ªAPIï¼ˆéƒ¨åˆ†ä¾èµ–åˆ™éœ€è¦ä¸¤ä¸ªAPIï¼‰æå…¶ç²¾ç®€ hoxåŒæ ·æ”¯æŒç»†ç²’åº¦åˆ‡åˆ†stateï¼ˆè™½ç„¶ä¸å»ºè®®åˆ‡åˆ†æˆatomè¿™ä¹ˆç»†ç²’åº¦ï¼‰ï¼Œæ”¯æŒstateä¾èµ–ï¼Œæ”¯æŒå½’ç±»ä¸šåŠ¡æ•°æ®é€»è¾‘å¹¶æŠ½ç¦»å‡ºæ¥ï¼ˆåƒæ˜¯è‡ªå®šä¹‰äº†ä¸€ä¸ªhookï¼‰ æ”¯æŒrecoilè¿˜ä¸æ”¯æŒçš„tså’ŒclassçŠ¶æ€ç®¡ç†ï¼ˆrecoilå¾—ä¸‹ä¸‹å¤§ç‰ˆæœ¬äº†å§ï¼‰ ä¹Ÿæ”¯æŒæ•°æ®æŒä¹…åŒ–ï¼Œä½†æ˜¯æ²¡æœ‰recoilæ‰‹åŠ¨æ¨¡å¼è¿™ä¹ˆå®šåˆ¶åŒ–ï¼Œå¯æ‰©å±•çš„ä¼˜åŒ–æ€§æ²¡æœ‰é‚£ä¹ˆé«˜ æ€»çš„æ¥è¯´hoxç›®å‰è¿˜æ˜¯ä¼˜äºrecoilï¼ŒAPIæ›´å‹å¥½ï¼Œç±»umiçš„æ¨¡å¼ä¹Ÿååˆ†æœ‰åŠ©äºé¡¹ç›®è¿ç§»ã€‚ä½†æ˜¯å­¦é™¢æ´¾recoilæ˜¯å€¼å¾—å°è¯•çš„é“è·¯ï¼Œæˆ‘ä»¬å¯ä»¥æœŸå¾…åœ¨recoilä¸ŠäºŒæ¬¡å°è£…é€‚åº”ä¸šåŠ¡å¼€å‘è¡¨ç°ã€‚ ","date":"2020-05-31","objectID":"/myblog/recoil-vs-hox/:0:4","tags":["hooks"],"title":"Recoil vs Hox","uri":"/myblog/recoil-vs-hox/"},{"categories":["web"],"content":"å°è¯•äº†æœ€è¿‘æ‹¥æŠ±hooksçš„reactå®˜æ–¹çŠ¶æ€ç®¡ç†å·¥å…·Recoil todolist demoä»£ç ä»“åº“ ","date":"2020-05-25","objectID":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/:0:0","tags":["react","recoil"],"title":"recoiljs å¿«é€Ÿä¸Šæ‰‹æŒ‡å—","uri":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/"},{"categories":["web"],"content":"recoiljs å¿«é€Ÿä¸Šæ‰‹æŒ‡å— reactå®˜æ–¹çš„å®éªŒæ€§çŠ¶æ€ç®¡ç†åº“ï¼Œæ‹¥æŠ±hooks ","date":"2020-05-25","objectID":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/:1:0","tags":["react","recoil"],"title":"recoiljs å¿«é€Ÿä¸Šæ‰‹æŒ‡å—","uri":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/"},{"categories":["web"],"content":"Problem ä¸reactæœ¬èº«stateç®¡ç†ç›¸æ¯”â€¦ share stateçš„é—®é¢˜ï¼Œéœ€è¦ä¼ åˆ°å…¬å…±èŠ‚ç‚¹ï¼Œä»¥è‡´äºéœ€è¦ç»´æŠ¤ä¸€ä¸ªhuge node treeï¼Œä¸€ä¸ªæ˜¯éº»çƒ¦å¤æ‚ï¼Œä¸€ä¸ªæ˜¯å¯¹äºçŠ¶æ€æ”¹å˜çš„é‡æ¸²æŸ“ä¸å‹å¥½ ä¸€ä¸ªcontextåªèƒ½è§£å†³ä¸€ä¸ªsingle valueçš„ç”Ÿäº§æ¶ˆè´¹é—®é¢˜ è¿™ä¸¤ä¸ªé—®é¢˜å¯¼è‡´ä»£ç ä¸èƒ½ç»†ç²’åº¦æ‹†åˆ† ","date":"2020-05-25","objectID":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/:1:1","tags":["react","recoil"],"title":"recoiljs å¿«é€Ÿä¸Šæ‰‹æŒ‡å—","uri":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/"},{"categories":["web"],"content":"Issue å®šä¹‰äº†æœ‰å‘å›¾ï¼ˆdata-flow graphï¼‰æ¥å‚¨å­˜çŠ¶æ€ä»¥åŠçŠ¶æ€çš„ä¾èµ–å…³ç³»â€¦ï¼ˆå¸¸è§„æ€è·¯â€¦ï¼‰æ³¨æ„ä¸ç”¨æ ‘æ˜¯å› ä¸ºéœ€è¦è§£å†³stateçš„äº¤å‰ä¾èµ–å…³ç³» ","date":"2020-05-25","objectID":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/:1:2","tags":["react","recoil"],"title":"recoiljs å¿«é€Ÿä¸Šæ‰‹æŒ‡å—","uri":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/"},{"categories":["web"],"content":"Pros ç¬¦åˆreact hookè¯­æ³•ï¼Œ boilerplate-free API æ”¯æŒæ–°å‡ºçš„Concurrent Mode çŠ¶æ€éå¸¸ç»†ç²’åº¦ï¼Œæ–¹ä¾¿ä»£ç åˆ‡åˆ† åŒæ­¥/å¼‚æ­¥æ•°æ®æ¥æºçš„ state ä¸å½±å“ä½¿ç”¨çš„ç»„ä»¶çš„ä»£ç  stateæ•°æ®å®¹æ˜“åšæŒä¹…åŒ– å¼€å§‹ä¸€äº›æ¦‚å¿µâ€¦ ","date":"2020-05-25","objectID":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/:1:3","tags":["react","recoil"],"title":"recoiljs å¿«é€Ÿä¸Šæ‰‹æŒ‡å—","uri":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/"},{"categories":["web"],"content":"atom and selector atomï¼Œæ„å³åŸå­ï¼ˆåŠªåŠ›æŠŠstateæ‹†åˆ†ä¸ºæœ€å°ç²’åº¦ï¼‰ const fontSizeState = atom({ key: 'fontSizeState', default: 14, }) ä¸€æ—¦atomä¸­çš„stateå‘ç”Ÿæ”¹å˜ï¼Œä½¿ç”¨atomçš„æ‰€æœ‰reactç»„ä»¶éƒ½ä¼šè¢«é‡æ–°æ¸²æŸ“ æ¯”èµ·useStateï¼Œkeyæ˜¯ç”¨æ¥è°ƒè¯•ã€æ•°æ®æŒä¹…åŒ–ã€æŸ¥çœ‹atomæ ‘çš„å…¨å±€å”¯ä¸€å€¼ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸ç”±recoilè‡ªå·±æ¥ç”Ÿæˆâ€¦ ä½¿ç”¨atomç”¨useRecoilStateï¼Œç”¨æ³•å’ŒuseStateä¸€è‡´ï¼Œæ¯•ç«Ÿæ˜¯å®˜æ–¹åº“ function FontButton() { const [fontSize, setFontSize] = useRecoilState(fontSizeState); return ( \u003cbutton onClick={() =\u003e setFontSize((size) =\u003e size + 1)} style={{fontSize}}\u003e Click to Enlarge \u003c/button\u003e ); } selectorï¼Œè¾“å…¥atomæˆ–è€…å…¶ä»–selectorï¼Œé€šè¿‡pure functionæ˜ å°„æ•°æ®ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„selector å…¶å®atomå°±æ˜¯ç‰¹æ®Šçš„selectorï¼Œåªæ˜¯å®ƒæ˜¯æºæ•°æ®èŠ‚ç‚¹ æ‰€æœ‰è®¢é˜…äº†selectorçš„ç»„ä»¶å½“selectoræ•°æ®å‘ç”Ÿå˜åŠ¨çš„æ—¶å€™åŒæ ·ä¼šé‡æ–°æ¸²æŸ“ // data stream: // fontSizeState(atom) --\u003e fontSizeLabelState(selector) --\u003e react function component const fontSizeLabelState = selector({ key: 'fontSizeLabelState', get: ({get}) =\u003e { const fontSize = get(fontSizeState); const unit = 'px'; return `${fontSize}${unit}`; }, }); ç”±äºselectoræ˜¯ä¸å¯å†™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨useRecoilValue() function FontButton() { const [fontSize, setFontSize] = useRecoilState(fontSizeState); const fontSizeLabel = useRecoilValue(fontSizeLabelState); return ( \u003c\u003e \u003cdiv\u003eCurrent font size: ${fontSizeLabel}\u003c/div\u003e \u003cbutton onClick={() =\u003e setFontSize(fontSize + 1)} style={{fontSize}}\u003e Click to Enlarge \u003c/button\u003e \u003c/\u003e ); } è¯´åˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸‹ï¼Œå…¶å®å¦‚æœå•å•è°ˆè®ºstateä¾èµ–å…³ç³»å’Œæ•°æ®æµåŠ¨ï¼Œatomå’Œselectoræ˜¯å¯ä»¥åˆå¹¶çš„ selectoræ—¨åœ¨åšçš„æ˜¯è§£å†³å¼‚æ­¥æ•°æ®æ¥æºï¼Œå°±åƒredux-promise, redux-sagaåœ¨reduxä¸­åšçš„äº‹æƒ… ä½†æ˜¯ä»çº¯å‡½æ•°çš„è§’åº¦æ¥è€ƒè™‘ï¼Œå¼‚æ­¥æ•°æ®ä¸åº”è¯¥åµŒå¥—åœ¨çº¯å‡½æ•°æ˜ å°„çš„data flowä¸­ï¼Œå®˜æ–¹è¿™æ ·çš„è§£å†³æ–¹æ¡ˆè®©äººå­˜ç–‘â€¦ ","date":"2020-05-25","objectID":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/:1:4","tags":["react","recoil"],"title":"recoiljs å¿«é€Ÿä¸Šæ‰‹æŒ‡å—","uri":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/"},{"categories":["web"],"content":"demo code å†™äº†ä¸€ä¸ªç®€å•çš„TodoListåº”ç”¨æ¥çœ‹çœ‹æ€ä¹ˆä½¿ç”¨Recoil å®Œæ•´ä»£ç é“¾æ¥ RecoilRoot éœ€è¦ä½¿ç”¨Recoilè¿›è¡ŒçŠ¶æ€ç®¡ç†çš„Componentï¼Œé¦–å…ˆç”¨RecoilRootåŒ…è£¹ã€‚ æ³¨æ„ï¼šRecoilæ”¯æŒå¤šä¸ªæ ¹ä¾‹ï¼Œä¼šæœç´¢æœ€è¿‘çš„root function App() { return ( \u003cdiv className=\"App\" style={{textAlign:\"center\"}}\u003e \u003ch3\u003eThe TodoList based on React \u0026\u0026 Recoil\u003c/h3\u003e \u003cRecoilRoot\u003e \u003cTodoList\u003e\u003c/TodoList\u003e \u003c/RecoilRoot\u003e \u003c/div\u003e ); } atomå®šä¹‰å’Œä½¿ç”¨ é¦–å…ˆå®šä¹‰listdataçš„atomï¼Œæ”¾åœ¨storeæ–‡ä»¶å¤¹ä¸‹ï¼ˆå½“ç„¶æƒ³æ”¾å“ªé‡Œéƒ½å¯ä»¥ï¼Œç»Ÿä¸€æ”¾åœ¨storeä¸­æ–¹ä¾¿ç®¡ç†ï¼‰ const listDataState = atom({ key: \"listDataState\", default: [ { id: 1, label: \"learn react and recoil\", visible: true, isDone: false }, { id: 2, label: \"play GTA5\", visible: true, isDone: true }, { id: 3, label: \"listen to music\", visible: true, isDone: false }, { id: 4, label: \"hangout with gf\", visible: true, isDone: true } ] }) export {listDataState} é€šè¿‡useRecoilStateå¼€å§‹ç®¡ç†è¯¥atomï¼Œç„¶åmapä¸€ä¸‹list function todoList() { const [listData, setListData] = useRecoilState(listDataState); return ( \u003cdiv className=\"list\"\u003e \u003cul\u003e {listData.map((item, index) =\u003e { return ( \u003cli key={index + md5(item.label)}\u003e\u003cTodoItem itemdata={item} /\u003e\u003c/li\u003e ) })} \u003c/ul\u003e {/* other code */} \u003c/div\u003e ) } ä¿®æ”¹state ç„¶åæˆ‘ä»¬ç°åœ¨æƒ³å®ç°todolistçš„æ ‡è®°å®Œæˆã€æ·»åŠ ã€åˆ é™¤çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯å¯¹stateè¿›è¡Œä¿®æ”¹ æ·»åŠ  // åœ¨todoListä¸­ \u003cspan\u003e \u003cinput value={inputData} onChange={(value) =\u003e setInputData(value.target.value)} placeholder=\"todo...\"\u003e \u003c/input\u003e \u003cbutton onClick={() =\u003e { const newListData = [...listData, cstrTodoItem(md5(inputData), inputData)]; setListData(newListData); setInputData(\"\"); }}\u003eAdd\u003c/button\u003e \u003c/span\u003e åˆ é™¤ã€æ ‡è®°å®Œæˆã€æ ‡è®°æœªå®Œæˆ // åœ¨todoItemä¸­ function getNewListData(id, listData) { const list = List(listData); return list.update( list.findIndex((value,_)=\u003evalue.id===id), (item)=\u003e{ return {...item, isDone: !item.isDone} } ); } function delFromListData(id, listData) { return listData.filter(item =\u003e item.id !== id); } function TodoBtn(id, isDone) { const listData = useRecoilValue(listDataState); const setListDataState = useSetRecoilState(listDataState); const type = !isDone ? \"done\" : \"redo\" return ( \u003cspan style={{ marginLeft: 30 }}\u003e \u003cbutton onClick={() =\u003e { setListDataState(getNewListData(id, listData)) }}\u003e{type}\u003c/button\u003e \u003cbutton onClick={() =\u003e { setListDataState(delFromListData(id, listData)) }}\u003edel\u003c/button\u003e \u003c/span\u003e ) } function TodoItem(props) { const { id, label, visible, isDone } = props.itemdata; return ( \u003cdiv className=\"item\"\u003e \u003cdiv\u003e {!isDone ? label : \u003cs\u003e{label}\u003c/s\u003e} \u003c/div\u003e \u003cdiv\u003e {TodoBtn(id, isDone)} \u003c/div\u003e \u003c/div\u003e ) } æ¥ä¸‹æ¥ï¼Œå°è¯•ä¸€ä¸‹selectorä¾èµ–atom åšä¸€ä¸ªç­›é€‰todo itemçš„åŠŸèƒ½ å®šä¹‰ä¸¤ä¸ªæ–°çš„stateï¼Œåˆ†åˆ«æ˜¯ç­›é€‰åçš„åˆ—è¡¨æ•°æ®ã€ç­›é€‰å€¼ï¼Œæ”¾åœ¨storeä¸­ const filterState = atom({ key: \"filterState\", default: \"all\" }) const filteredListState = selector({ key: \"filteredListState\", get: ({ get }) =\u003e { const filter = get(filterState); const list = get(listDataState); switch (filter) { case 'all': return list case 'undos': return list.filter((item) =\u003e !item.isDone); default: return list; } }, }) ç„¶ååœ¨todoListä¸­map listç”¨filteredListStateæ›¿ä»£åŸæ¥çš„listï¼Œå†å¢åŠ ä¿®æ”¹è¿‡æ»¤å€¼çš„é€»è¾‘å³å¯ function todoList(){ const [filter, setFilter] = useRecoilState(filterState); const filteredListData = useRecoilValue(filteredListState); {/* other code */} return ( \u003cdiv className=\"list\"\u003e {/* other code */} \u003cul\u003e {filteredListData.map((item, index) =\u003e { return ( \u003cli key={index + md5(item.label)}\u003e\u003cTodoItem itemdata={item} /\u003e\u003c/li\u003e ) })} \u003c/ul\u003e \u003cselect value={filter} onChange={({ target: { value } }) =\u003e setFilter(value)}\u003e \u003coption value=\"all\"\u003eAll\u003c/option\u003e \u003coption value=\"completed\"\u003eCompleted\u003c/option\u003e \u003coption value=\"undos\"\u003eUncompleted\u003c/option\u003e \u003c/select\u003e \u003c/div\u003e ) } æ¥ä¸‹æ¥å†å°è¯•ä¸€ä¸‹selectorè·å–å¼‚æ­¥æ•°æ®çš„èƒ½åŠ› æŠŠé»˜è®¤å€¼æ”¾åœ¨mockä¸­ // mocker/index.js const proxy = { 'GET /remotelistdata': {data: [ { id: 1, label: \"from remote planet\", visible: true, isDone: false }, { id: 2, label: \"sing from moon\", visible: true, isDone: false }, ]} } module.exports = proxy; å¢åŠ å¼‚æ­¥è·å–æ•°æ®çš„selector const queryListDataState = selector({ key: \"queryListDataState\", get: async () =\u003e { const res = await axios.get('/remotelistdata'); console.log(res); return res.data.data; } }) åˆ¤æ–­åŠ è½½å®Œæˆåï¼Œè®¾ç½®è¿œç¨‹æ•°æ®æ›¿æ¢æ‰æœ¬åœ°é»˜è®¤æ•°æ® const queryListData = useRecoilValueLoadable(queryListDataState); if(queryListData.state === \"hasValue\") { setListData(queryListD","date":"2020-05-25","objectID":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/:1:5","tags":["react","recoil"],"title":"recoiljs å¿«é€Ÿä¸Šæ‰‹æŒ‡å—","uri":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/"},{"categories":["web"],"content":"è¯„ä»· pros selectorè¿™ç§Derived Stateçš„è®¾è®¡ï¼Œé€‚åˆå¤„ç†ä¾èµ–æ€§é€»è¾‘ï¼Œæ–¹ä¾¿å¿«é€Ÿå¼€å‘ å°†stateæ‹†åˆ†ä¸ºæœ€å°çŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥éšæ„åˆ†æ•£ç®¡ç†ï¼Œåº”ç”¨çš„æ¨¡å—åˆ†å‰²å¯ä»¥è¿›è¡Œå¾—æ›´åŠ å½»åº• éå¸¸é€‚åˆå–ä»£stateå±‚çº§å¾ˆæ·±çš„reduxç®¡ç†æ¨¡å—ï¼Œç”±äºçŠ¶æ€ç»†ç²’åº¦ï¼Œæ€§èƒ½å¯ä»¥å¾—åˆ°å¾ˆå¥½çš„ä¼˜åŒ–ï¼Œå¯ä»¥åœ¨åº”ç”¨å†…å°èŒƒå›´ä½¿ç”¨ä¸reduxå…¼å®¹ æ”¯æŒreact concurrentæ¨¡å¼ cons APIå¤ªå¤šäº†ï¼Œä¸æƒ³ä¸Šæ‰‹ ä½¿ç”¨stateéœ€è¦å¼•å…¥å®šä¹‰çš„atom/selectorä»¥åŠuseâ€¦ APIï¼Œå¤æ‚ï¼Œä¸æƒ³ä¸Šæ‰‹ ç°åœ¨ä¸æ”¯æŒts btw recoilçš„å®ç°åŸç†æ˜¯å‘å¸ƒè®¢é˜…çš„æ–¹å¼ï¼Œè®¸å¤šæ¦‚å¿µåƒä¸åƒrxjsï¼Ÿatomã€selectorï¼Œè¿˜æœ‰å®˜æ–¹ç»™çš„waitAllï¼ŒwaitAnyç­‰ç­‰API æ¥ä¸‹æ¥å’Œreto/mobxå¯¹æ¯”ä¸€ä¸‹â€¦ è¿˜æƒ³æµ‹è¯•ä¸€ä¸‹recoilçš„æ€§èƒ½â€¦ ç„¶åè®¨è®ºä¸€ä¸‹recoilçš„å®ç°åŸç†â€¦ ","date":"2020-05-25","objectID":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/:1:6","tags":["react","recoil"],"title":"recoiljs å¿«é€Ÿä¸Šæ‰‹æŒ‡å—","uri":"/myblog/recoiljs%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/"},{"categories":["åç«¯"],"content":"have fun with nsq ğŸš€ ","date":"2020-04-06","objectID":"/myblog/nsq%E5%88%9D%E6%8E%A2/:0:0","tags":["nsq","MQ"],"title":"nsqåˆæ¢","uri":"/myblog/nsq%E5%88%9D%E6%8E%A2/"},{"categories":["åç«¯"],"content":"ä»€ä¹ˆæ˜¯nsq æ¨èçœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼Œå¼€å‘nsqçš„é¡¹ç›®ç»„å¯¹nsqçš„æƒ³æ³• æˆ‘ä»¬æ˜¯å¦‚ä½•ä½¿ç”¨NSQå¤„ç†7500äº¿æ¶ˆæ¯çš„ ","date":"2020-04-06","objectID":"/myblog/nsq%E5%88%9D%E6%8E%A2/:1:0","tags":["nsq","MQ"],"title":"nsqåˆæ¢","uri":"/myblog/nsq%E5%88%9D%E6%8E%A2/"},{"categories":["åç«¯"],"content":"æ¶ˆæ¯é˜Ÿåˆ— nsqæ˜¯ä¸€ç§MQï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼Œå¸¸è§çš„MQè¿˜æœ‰æ¯”å¦‚RabbitMQã€Kafkaç­‰ç­‰ é‚£ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—å‘¢ï¼Ÿ æ¶ˆæ¯é˜Ÿåˆ—å…¶å®å°±æ˜¯å°†æ•°æ®/è¯·æ±‚å­˜æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œç”Ÿäº§è€…åœ¨é˜Ÿåˆ—ä¸€å¤´æä¾›æ•°æ®/è¯·æ±‚ï¼Œæ¶ˆè´¹è€…åœ¨é˜Ÿåˆ—å¦ä¸€å¤´æ¶ˆè´¹æ•°æ®/è¯·æ±‚ æ¶ˆæ¯é˜Ÿåˆ—åŸå‹\" æ¶ˆæ¯é˜Ÿåˆ—åŸå‹ ä¸ºä»€ä¹ˆè¦ç”¨æ¶ˆæ¯é˜Ÿåˆ—å‘¢ï¼Ÿ æˆ‘ä»¬å°†å¥½å¤„æ¦‚æ‹¬ä¸ºè§£è€¦ã€å¼‚æ­¥å’Œå‡æµ è§£è€¦ å¤šä¸ªç³»ç»Ÿä¹‹é—´æ•°æ®å¾€å¾€æœ‰äº¤äº’ï¼Œè¿™å°±å¯¼è‡´äº†ä¸€ä¸ªç³»ç»Ÿçš„å´©æºƒä¼šå½±å“åˆ°å…¶ä»–ç³»ç»Ÿï¼Œç³»ç»Ÿéœ€æ±‚å˜æ›´åˆä¼šå¯¼è‡´å½¼æ­¤æ¥å£çš„å˜æ›´ï¼Œå¯è§ç³»ç»Ÿçš„ç‹¬ç«‹æ€§å¤§å¤§ä¸‹é™ï¼›å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸€å¤§å¥½å¤„æ˜¯è§£è€¦äº†å¤šç³»ç»Ÿï¼Œå¢åŠ äº†å¯é æ€§ ç³»ç»Ÿè§£è€¦çš„ä¾‹å­\" ç³»ç»Ÿè§£è€¦çš„ä¾‹å­ å¼‚æ­¥ å¼‚æ­¥å®é™…æ˜¯å°†åç»­æ“ä½œå»¶ç¼“äº†ï¼Œå› ä¸ºå°†æ•°æ®æ”¾åˆ°äº†MQä¸­ï¼Œä¸å¿…ç­‰å¾…å…¶ä»–ç³»ç»Ÿçš„å“åº”å°±ç›´æ¥è¿”å›ï¼›è¿™æ ·å¢åŠ äº†ç³»ç»Ÿçš„å“åº”é€Ÿåº¦ï¼Œä½†æ˜¯å¯¼è‡´äº†è¿”å›ç»“æœçš„ä¸å¯é æ€§ï¼ˆå› ä¸ºåç»­å¯èƒ½ä¼šå¯¼è‡´æ“ä½œå¤±è´¥å‘€ï¼‰ï¼›æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„åº”ç”¨å¼‚æ­¥æœ‰ä¸€å®šçš„é€‚ç”¨åœºæ™¯ å¼‚æ­¥å¿«é€Ÿå“åº”\" å¼‚æ­¥å¿«é€Ÿå“åº” å‡æµ ç³»ç»Ÿæ•°æ®é‡åœ¨æ—¶é—´ä¸Šåˆ†å¸ƒä¸€èˆ¬æ˜¯ä¸å‡åŒ€çš„ï¼Œæ¯”å¦‚å¯èƒ½åœ¨ç™½å¤©ä¸‹åˆæ—¶æ®µæœ‰æ´ªæ°´æœŸï¼Œè€Œåœ¨å…¶ä»–æ—¶æ®µæ•°æ®æµæå°ï¼›é€šè¿‡åº”ç”¨MQå¯ä»¥å®ç°è´Ÿè½½çš„å‡è¡¡ è´Ÿè½½å‡è¡¡\" è´Ÿè½½å‡è¡¡ ","date":"2020-04-06","objectID":"/myblog/nsq%E5%88%9D%E6%8E%A2/:1:1","tags":["nsq","MQ"],"title":"nsqåˆæ¢","uri":"/myblog/nsq%E5%88%9D%E6%8E%A2/"},{"categories":["åç«¯"],"content":"nsqç»„æˆæ¨¡å— NSQç”±3ä¸ªè¿›ç¨‹ç»„æˆï¼š nsqd: æ¥æ”¶ï¼Œç»´æŠ¤é˜Ÿåˆ—å’Œåˆ†å‘æ¶ˆæ¯ç»™å®¢æˆ·ç«¯çš„daemonè¿›ç¨‹ nsqlookupd: ç®¡ç†æ‹“æ‰‘ä¿¡æ¯å¹¶æä¾›æœ€ç»ˆä¸€è‡´æ€§çš„å‘ç°æœåŠ¡ nsqadmin: ç”¨äºå®æ—¶ç›‘æ§é›†ç¾¤è¿è¡Œå¹¶æä¾›ç®¡ç†å‘½ä»¤çš„ç®¡ç†ç½‘ç«™å¹³å°ã€‚ ","date":"2020-04-06","objectID":"/myblog/nsq%E5%88%9D%E6%8E%A2/:1:2","tags":["nsq","MQ"],"title":"nsqåˆæ¢","uri":"/myblog/nsq%E5%88%9D%E6%8E%A2/"},{"categories":["åç«¯"],"content":"nsq dockeréƒ¨ç½² docker pull nsqio/nsq docker run -d --name lookupd -p 4160:4160 -p 4161:4161 nsqio/nsq /nsqlookupd docker run -d --name nsqd -p 4150:4150 -p 4151:4151 nsqio/nsq /nsqd --broadcast-address=149.28.73.98 --lookupd-tcp-address=149.28.73.98:4160 docker run -d --name nsqadmin -p 4171:4171 nsqio/nsq /nsqadmin --lookupd-http-address=149.28.73.98:4161 éƒ¨ç½²å®Œæˆåå¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®nsqadmin nsq nodesç®¡ç†é¡µé¢\" nsq nodesç®¡ç†é¡µé¢ ","date":"2020-04-06","objectID":"/myblog/nsq%E5%88%9D%E6%8E%A2/:1:3","tags":["nsq","MQ"],"title":"nsqåˆæ¢","uri":"/myblog/nsq%E5%88%9D%E6%8E%A2/"},{"categories":["web"],"content":"è®°å½•Reactæºç é˜…è¯»çš„ä¸€äº›æ”¶è· always updatingâ€¦ ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:0:0","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"Flow and Rollup ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:1:0","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"flow flowæ˜¯è¾…åŠ©JavaScriptçš„é™æ€ç±»å‹æ£€æŸ¥å·¥å…·ï¼Œç›¸å¯¹äºTypeScriptæ¥è¯´ï¼Œä¸éœ€è¦æ”¹å†™å…¨éƒ¨çš„åŠŸèƒ½æ¨¡å— è€Œä¸”ä½¿ç”¨Flowåªéœ€è¦ä¾èµ–äºBabelçš„æ’ä»¶ï¼Œå…·æœ‰æå¤§çš„çµæ´»æ€§ æ€ä¹ˆç”¨ï¼Ÿ # å®‰è£…flow npm install --save-dev flow-bin # package.jsonæ·»åŠ å¯¹åº”çš„script # init npm run flow init # babelå®‰è£…ä¾èµ–æ’ä»¶ npm install --save-dev babel-preset-flow # .babelrcæ·»åŠ flowçš„preset é…ç½®å¥½äº†Flowï¼Œåªè¦åœ¨è¦ä½¿ç”¨çš„æ¨¡å—é‡Œ@flowæ³¨è§£ï¼Œç„¶åå¢åŠ æƒ³è¦çš„ç±»å‹æ£€æŸ¥ /* @flow */ function add(x: number, y: number): number { return x + y } add(22, 11) æ³¨æ„ï¼šFlowæ‹¥æœ‰ä¸Šä¸‹æ–‡æ¨æ–­ç±»å‹çš„èƒ½åŠ› ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:1:1","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"rollup æ‰“åŒ…å·¥å…· å¼€å‘åº“ç”¨rollup å¼€å‘é¡¹ç›®ç”¨webpack rollupä¸»è¦ä¼˜ç‚¹æ˜¯ä½“ç§¯å° ä½†æ˜¯ä¸æ”¯æŒçƒ­åŠ è½½ ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:1:2","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"Reactæºç ç›®å½•ç»“æ„ â”œâ”€â”€ build ------------------------------- æ„å»ºåçš„è¾“å‡ºç›®å½• â”œâ”€â”€ fixtures ---------------------------- React å¼€å‘çš„æµ‹è¯•ç”¨ä¾‹ â”œâ”€â”€ packages ---------------------------- æºç ç›®å½• â”‚ â”œâ”€â”€ create-subscription ------------- åœ¨ç»„ä»¶é‡Œè®¢é˜…é¢å¤–æ•°æ®çš„å·¥å…· â”‚ â”œâ”€â”€ events -------------------------- äº‹ä»¶å¤„ç† â”‚ â”œâ”€â”€ interaction-tracking ------------ è·Ÿè¸ªäº¤äº’äº‹ä»¶ â”‚ â”œâ”€â”€ react --------------------------- æ ¸å¿ƒä»£ç  â”‚ â”œâ”€â”€ react-art ----------------------- çŸ¢é‡å›¾å½¢åº“ â”‚ â”œâ”€â”€ react-dom ----------------------- DOM æ¸²æŸ“ç›¸å…³ â”‚ â”œâ”€â”€ react-is ------------------------ React å…ƒç´ ç±»å‹ç›¸å…³ â”‚ â”œâ”€â”€ react-native-renderer ----------- react-native æ¸²æŸ“ç›¸å…³ â”‚ â”œâ”€â”€ react-noop-renderer ------------- Fiber æµ‹è¯•ç›¸å…³ â”‚ â”œâ”€â”€ react-reconciler ---------------- React è°ƒåˆ¶å™¨ â”‚ â”œâ”€â”€ react-scheduler ----------------- è§„åˆ’ React åˆå§‹åŒ–ï¼Œæ›´æ–°ç­‰ç­‰ â”‚ â”œâ”€â”€ react-test-renderer ------------- å®éªŒæ€§çš„ React æ¸²æŸ“å™¨ â”‚ â”œâ”€â”€ shared -------------------------- é€šç”¨ä»£ç  â”‚ â”œâ”€â”€ simple-cache-provider ----------- ä¸º React åº”ç”¨æä¾›ç¼“å­˜ â”‚ â”œâ”€â”€ server -------------------------- æœåŠ¡ç«¯æ¸²æŸ“ â”‚ â”œâ”€â”€ sfc ----------------------------- .vue æ–‡ä»¶è§£æ â”‚ â”œâ”€â”€ shared -------------------------- æ•´ä¸ªé¡¹ç›®é€šç”¨ä»£ç  â”œâ”€â”€ scripts ----------------------------- å…¬å…±çš„lintï¼Œbuildï¼Œtestå’Œreleaseç­‰ç›¸å…³çš„æ–‡ä»¶ â”‚ â”œâ”€â”€ eslint -------------------------- è¯­æ³•è§„åˆ™å’Œä»£ç é£æ ¼ â”‚ â”œâ”€â”€ flow ---------------------------- Flow ç±»å‹å£°æ˜ â”‚ â”œâ”€â”€ git ----------------------------- gité’©å­çš„ç›®å½• â”‚ â”œâ”€â”€ jest ---------------------------- JavaScript æµ‹è¯•ç›®å½• â”‚ â”œâ”€â”€ release ------------------------- è‡ªåŠ¨å‘å¸ƒæ–°ç‰ˆæœ¬è„šæœ¬ â”‚ â”œâ”€â”€ rollup -------------------------- rollup æ„å»ºç›®å½• â”œâ”€â”€ .babelrc ---------------------------- babel é…ç½®æ–‡ä»¶ â”œâ”€â”€ .editorconfig ----------------------- ç¼–è¾‘å™¨è¯­æ³•è§„èŒƒé…ç½® â”œâ”€â”€ .eslintignore ----------------------- eslint å¿½ç•¥é…ç½® â”œâ”€â”€ .eslintrc --------------------------- eslint é…ç½®æ–‡ä»¶ â”œâ”€â”€ .gitattributes ---------------------- ç»™ attributes è·¯å¾„åçš„ç®€å•æ–‡æœ¬æ–‡ä»¶ â”œâ”€â”€ .gitignore -------------------------- git å¿½ç•¥é…ç½® â”œâ”€â”€ .mailmap ---------------------------- é‚®ä»¶åˆ—è¡¨æ¡£æ¡ˆ â”œâ”€â”€ .nvmrc ------------------------------ nvm é…ç½®æ–‡ä»¶ â”œâ”€â”€ .prettierrc.js ---------------------- prettierrc é…ç½®æ–‡ä»¶ â”œâ”€â”€ .watchmanconfig --------------------- watchman é…ç½®æ–‡ä»¶ â”œâ”€â”€ appveyor.yml ------------------------ GitHub æ‰˜ç®¡é¡¹ç›®çš„è‡ªåŠ¨åŒ–é›†æˆ â”œâ”€â”€ AUTHORS ----------------------------- å¼€å‘è€…åˆ—è¡¨æ¡£æ¡ˆ â”œâ”€â”€ CHANGELOG.md ------------------------ æ›´æ–°æ—¥å¿— â”œâ”€â”€ CODE_OF_CONDUCT.md ------------------ Code of Conduct â”œâ”€â”€ CONTRIBUTING.md --------------------- Contributing to React â”œâ”€â”€ dangerfile.js ----------------------- æé«˜ Code Review ä½“éªŒ â”œâ”€â”€ netlify.toml ------------------------ æŒç»­é›†æˆé™æ€ç½‘ç«™ â”œâ”€â”€ package-lock.json ------------------- npm åŠ é”æ–‡ä»¶ â”œâ”€â”€ package.json ------------------------ é¡¹ç›®ç®¡ç†æ–‡ä»¶ â”œâ”€â”€ README.md --------------------------- é¡¹ç›®æ–‡æ¡£ â”œâ”€â”€ yarn.lock --------------------------- yarn åŠ é”æ–‡ä»¶ ç”±äºå°†react-domå•ç‹¬æå–å‡ºæ¥äº†ï¼Œæ‰€ä»¥reactæœ¬èº«çš„æ ¸å¿ƒä»£ç åªæœ‰å‡ åƒè¡Œï¼Œå…ˆæ¥çœ‹çœ‹å’¯ ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:2:0","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"reactæ ¸å¿ƒä»£ç  ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:3:0","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"å¯¹å¤–æš´éœ²çš„API reactå¯¹å¤–æ˜¯ä¸€ä¸ªJavascriptå¯¹è±¡ï¼Œæš´éœ²äº†å®ƒçš„APIï¼Œä½ç½®åœ¨packages/react/src/index.js export { Children, //å¤„ç†props.childrençš„æ–¹æ³• createRef, //æ–°çš„refç”¨æ³• Component, //ç»„ä»¶åŸºç±» PureComponent, //ç»„ä»¶åŸºç±» createContext, //æ–°çš„contextç”¨æ³• forwardRef, //refä¼ é€’ lazy, memo, useCallback, useContext, useEffect, useImperativeHandle, useDebugValue, useLayoutEffect, useMemo, useReducer, useRef, useState, useMutableSource, createMutableSource, Fragment, Profiler, StrictMode, Suspense, createElement, //åˆ›å»ºelement cloneElement, //å…‹éš†element isValidElement, //éªŒè¯æ˜¯å¦æ˜¯react element version, __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED, createFactory, //åˆ›å»ºæŸä¸€ç±»element useTransition, useDeferredValue, SuspenseList, unstable_withSuspenseConfig, block, DEPRECATED_useResponder, DEPRECATED_createResponder, unstable_createFundamental, unstable_createScope, } from './src/React'; å¯ä»¥çœ‹åˆ°è®¸å¤šç”±äºæœ€è¿‘åŠ äº†hookså¤šäº†ä¸å°‘useå¼€å¤´çš„API ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:3:1","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"Componentå’ŒPureComponent function Component(props, context, updater) { this.props = props; this.context = context; this.refs = emptyObject; this.updater = updater || ReactNoopUpdateQueue; } Component.prototype.isReactComponent = {}; // setState Component.prototype.setState = function(partialState, callback) { // partialState:äº§ç”Ÿä¸‹ä¸€ä¸ªstateçš„éƒ¨åˆ†state // callback:update stateä»¥åçš„å›è°ƒå‡½æ•° invariant( typeof partialState === 'object' || typeof partialState === 'function' || partialState == null, 'setState(...): takes an object of state variables to update or a ' + 'function which returns an object of state variables.', ); this.updater.enqueueSetState(this, partialState, callback, 'setState'); }; // forceUpdate Component.prototype.forceUpdate = function(callback) { this.updater.enqueueForceUpdate(this, callback, 'forceUpdate'); }; pureComponentç»§æ‰¿äº†componentçš„prototypeï¼Œä¸­é—´é€ äº†ä¸ªdummyComponentï¼ˆä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨ï¼‰ function PureComponent(props, context, updater) { this.props = props; this.context = context; this.refs = emptyObject; this.updater = updater || ReactNoopUpdateQueue; } const pureComponentPrototype = (PureComponent.prototype = new ComponentDummy()); pureComponentPrototype.constructor = PureComponent; Object.assign(pureComponentPrototype, Component.prototype); pureComponentPrototype.isPureReactComponent = true; ä¸¤è€…ä½¿ç”¨ä¸Šæœ‰ä»€ä¹ˆå·®åˆ« å¯ä»¥çœ‹åˆ°æºç çš„å®šä¹‰æ˜¯å‡ ä¹å®Œå…¨ä¸€æ ·ï¼Œä½†æ˜¯æ ¹æ®æ¸²æŸ“çš„ä»£ç å¯ä»¥çŸ¥é“pureComponentåœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥æå‡æ€§èƒ½ é€šè¿‡æµ…æ¯”è¾ƒï¼ˆreactå®šä¹‰çš„shallowEqualï¼‰ if (ctor.prototype \u0026\u0026 ctor.prototype.isPureReactComponent) { return ( !shallowEqual(oldProps, newProps) || !shallowEqual(oldState, newState) ); } æ‰€è°“æµ…æ¯”è¾ƒå°±æ˜¯å¼•ç”¨å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ä¼šåˆ¤å®šä¸åŒï¼Œå¦åˆ™ç›¸åŒ å¯ä»¥å‚è€ƒä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ğŸ‘‡ class BasicType extends React.PureComponent{ constructor() { super(); this.state = { isShow: false }; console.log('constructor BasicType'); } changeState = () =\u003e { this.setState({ isShow: true }) }; render() { // render will not be output after first render console.log('render'); return ( \u003cdiv\u003e \u003cbutton onClick={this.changeState}\u003eç‚¹å‡»\u003c/button\u003e \u003cdiv\u003e{this.state.isShow.toString()}\u003c/div\u003e \u003c/div\u003e ); } } class ArrayType extends React.PureComponent{ constructor() { super(); this.state = { arr: [1,2,3] }; console.log('constructor ArrayType'); } changeState = () =\u003e { const tarr = this.state.arr; tarr.push(1); this.setState({ arr: tarr }) console.log(\"this.state:\",this.state.arr) }; render() { console.log('render'); return ( \u003cdiv\u003e \u003cbutton onClick={this.changeState}\u003eç‚¹å‡»\u003c/button\u003e \u003cdiv\u003e{this.state.arr.toString()}\u003c/div\u003e \u003c/div\u003e ); } } const R = () =\u003e { return ( \u003cdiv\u003e \u003cBasicType /\u003e \u003cArrayType /\u003e \u003c/div\u003e ) } ReactDOM.render( \u003cR/\u003e, document.getElementById('root') ); æ‰€ä»¥PureComponenté€‚ç”¨åœºæ™¯æ˜¯å±•ç¤ºç»„ä»¶æˆ–è€…å¼•ç”¨æ•°æ®ä¸å‘ç”Ÿæ”¹å˜çš„åœ°æ–¹ æ¯”å¦‚æ³¨æ„ä¸‹é¢è¿™ä¸ªä¾‹å­ğŸ‘‡ æˆ‘ä»¬ä¸å¸Œæœ›æ¯ç§’é’Ÿå­ç»„ä»¶Childä¹Ÿè·Ÿç€æ¸²æŸ“ class ABC extends React.Component { constructor(props){ super(props); this.state = { date : new Date() } } componentDidMount(){ setInterval(()=\u003e{ this.setState({ date:new Date() }) },1000) } render(){ return ( \u003cdiv\u003e \u003cChild seconds={1}/\u003e \u003cdiv\u003e{this.state.date.toString()}\u003c/div\u003e \u003c/div\u003e ) } } ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:3:2","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"memo å–çš„åå­—æœ‰ç‚¹æ„æ€â€”â€”å¤‡å¿˜å½•ï¼Œå¯èƒ½å°±æ˜¯ä»£è¡¨è§„æ¨¡å°çš„æ•°æ®å±•ç¤ºç»„ä»¶å§ reactæ ¸å¿ƒä»£ç é‡Œåªå†™äº†å®šä¹‰ export function memo\u003cProps\u003e( type: React$ElementType, compare?: (oldProps: Props, newProps: Props) =\u003e boolean, ) { if (__DEV__) { if (!isValidElementType(type)) { console.error( 'memo: The first argument must be a component. Instead ' + 'received: %s', type === null ? 'null' : typeof type, ); } } return { $$typeof: REACT_MEMO_TYPE, type, compare: compare === undefined ? null : compare, }; } æ‰€ä»¥å°±æ˜¯ä¼ å…¥ä¸€ä¸ªreact elementå’Œä¸€ä¸ªpropsè‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ ä½¿ç”¨èµ·æ¥å°±æ˜¯è¿™æ ·ğŸ‘‡ function Child({seconds}){ console.log('I am rendering'); return ( \u003cdiv\u003eI am update every {seconds} seconds\u003c/div\u003e ) }; function areEqual(prevProps, nextProps) { if(prevProps.seconds===nextProps.seconds){ return true }else { return false } } export default React.memo(Child,areEqual) çœ‹ä¸Šå»å°±æ˜¯ä¸€ä¸ªé’ˆå¯¹å‡½æ•°ç»„ä»¶çš„PureComponentå‘¢ ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:3:3","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"createElement ä¼ å…¥typeã€configå’Œchildrenï¼Œreturnä¸€ä¸ªReactElement function createElement(type, config, children) { // è¿™é‡Œæ˜¯å¯¹configå’Œchildrençš„ä¸€äº›å¤„ç† return ReactElement( type, key, ref, self, source, ReactCurrentOwner.current, props, ); } å¯ä»¥çœ‹åˆ°ä¼ å…¥configä¸­çš„keyå’Œrefè¢«ä¿ç•™äº†ä¸‹æ¥ æˆ‘ä»¬çœ‹çœ‹ReactElementæ˜¯ä»€ä¹ˆï¼Ÿ ReactElement const ReactElement = function(type, key, ref, self, source, owner, props) { const element = { // This tag allows us to uniquely identify this as a React Element $$typeof: REACT_ELEMENT_TYPE, // Built-in properties that belong on the element type: type, key: key, ref: ref, props: props, // Record the component responsible for creating this element. _owner: owner, }; return element; }; typeç±»å‹ï¼Œç”¨äºåˆ¤æ–­å¦‚ä½•åˆ›å»ºèŠ‚ç‚¹ keyå’Œrefè¿™äº›ç‰¹æ®Šä¿¡æ¯ propsæ–°çš„å±æ€§å†…å®¹ $$typeofç”¨äºç¡®å®šæ˜¯å¦å±äºReactElement ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:3:4","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"Children å‰é¢è¯´åˆ°è¿™é‡Œæä¾›äº†å‡ ä¸ªå¤„ç†childrençš„API const Children = { map, forEach, count, toArray, only, }; å…ˆçœ‹ä¸‹æ¯”å¦‚mapçš„ä½¿ç”¨ var NotesList = React.createClass({ render: function() { return ( \u003col\u003e { React.Children.map(this.props.children, function (child) { return \u003cli\u003e{child}\u003c/li\u003e; }) } \u003c/ol\u003e ); } }); React.render( \u003cNotesList\u003e \u003cspan\u003ehello\u003c/span\u003e \u003cspan\u003ehello\u003c/span\u003e \u003c/NotesList\u003e, document.body ); ","date":"2020-04-05","objectID":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:3:5","tags":["react"],"title":"Reactæºç é˜…è¯»ç¬”è®°","uri":"/myblog/react%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["golang"],"content":"GroupCacheæºç é˜…è¯»çš„ä¸€äº›ç¬”è®° åŒæ­¥åˆ°äº†repo ","date":"2020-04-04","objectID":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:0:0","tags":["cache","ä¸€è‡´æ€§å“ˆå¸Œ","singleflight"],"title":"Groupcacheæºç é˜…è¯»ç¬”è®°","uri":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["golang"],"content":"lru æ€»ä½“è€Œè¨€å®ç°æ–¹å¼ä¸ºåŒå‘é“¾è¡¨+map ä¸»è¦é€»è¾‘å¦‚ä¸‹ï¼š æ·»åŠ ä¸€ä¸ªæ–°key/æˆ–è€…æ›´æ–°å·²æœ‰keyï¼Œå°†keyå¯¹åº”çš„elementæ‰§è¡ŒPushFront/MoveToFrontæ“ä½œï¼Œä¹Ÿå°±æ˜¯æ”¾åˆ°é“¾è¡¨æœ€å‰ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦è¶…è¿‡äº†æœ€å¤§å®¹é‡ï¼Œè¶…è¿‡å°±åˆ é™¤é“¾è¡¨æœ€æœ«element æŸ¥è¯¢ä¸€ä¸ªkeyï¼ŒåŒæ ·æ‰§è¡ŒMoveToFrontæ“ä½œ æ­¤å¤–å½“key-elementè¢«åˆ é™¤çš„æ—¶å€™ï¼Œæºç æ˜¾ç¤ºå¯ä»¥æ‰§è¡ŒOnEvictedæ“ä½œï¼Œä½†æ˜¯ä¼¼ä¹åœ¨lru cacheæ³¨å†Œé˜¶æ®µæ²¡æœ‰å†™å¯¹è¿™ä¸ªå›è°ƒå‡½æ•°çš„æ³¨å…¥ï¼ˆ???ï¼‰ ç¼ºç‚¹çš„è¯ï¼šä¸»è¦å°±æ˜¯ä¾èµ–çš„container/listæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸æ”¯æŒå¹¶è¡Œï¼Œæ•ˆç‡æœ‰ç‚¹ä½ï¼Œå¤–éƒ¨éœ€è¦ç»´æŠ¤ä¸€ä¸‹åŒæ­¥çš„é—®é¢˜ ","date":"2020-04-04","objectID":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:1:0","tags":["cache","ä¸€è‡´æ€§å“ˆå¸Œ","singleflight"],"title":"Groupcacheæºç é˜…è¯»ç¬”è®°","uri":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["golang"],"content":"consistenthash ä¸€è‡´æ€§å“ˆå¸Œ å®ç°æ–¹å¼å°±æ˜¯æ ¹æ®ç†è®ºæ¥ ä¸»è¦é€»è¾‘å¦‚ä¸‹ï¼š ä¸ºäº†hash ringä¸ŠèŠ‚ç‚¹èƒ½å°½å¯èƒ½å¹³å‡åˆ†å¸ƒï¼Œå› æ­¤å…è®¸è™šæ‹ŸèŠ‚ç‚¹ï¼Œä¸ºæ­¤ä¼ å…¥replicasè¡¨ç¤ºæ€»èŠ‚ç‚¹æ•°=å®èŠ‚ç‚¹*replicas hashå‡½æ•°å…è®¸è‡ªå®šä¹‰ï¼Œé»˜è®¤çš„hashå‡½æ•°ä¸ºcrc32ï¼Œcrcæ˜¯ä¸€ç§è¿½æ±‚é€Ÿåº¦ä¸è¿½æ±‚ä½ç¢°æ’ç‡çš„hashç®—æ³•ï¼Œå…·ä½“å¯ä»¥çœ‹wiki å¯¹è™šæ‹ŸèŠ‚ç‚¹çš„å¤„ç†é€šè¿‡åŠ å‰ç½®indexå†hash for i := 0; i \u003c m.replicas; i++ { hash := int(m.hash([]byte(strconv.Itoa(i) + key))) m.keys = append(m.keys, hash) m.hashMap[hash] = key } æ”¾è¿›å»çš„keysä¸ºäº†æ¥ä¸‹æ¥åœ¨getçš„æ—¶å€™æ‰¾åˆ°æœ€è¿‘ï¼Œéœ€è¦è¿›è¡Œæ’åºï¼Œæºç ç›´æ¥æ ¹æ®hashçš„å­—æ¯åºæ’åº getæŸä¸ªkeyçš„æ—¶å€™å°±æ˜¯å¯»æ‰¾keyå¯¹åº”çš„hashåœ¨hash ringä¸Šè·ç¦»æœ€è¿‘çš„èŠ‚ç‚¹ï¼Œæºç ç”¨çš„æ˜¯sort.Searchï¼Œä¸€ä¸ªsortä¾èµ–æ¨¡å—çš„äºŒåˆ†æŸ¥æ‰¾æ–¹æ³• æºç æ²¡æœ‰å†™å¯¹keyçš„removeæ“ä½œï¼Œéš¾é“è¦clearæ‰é‡æ–°addå— ","date":"2020-04-04","objectID":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:2:0","tags":["cache","ä¸€è‡´æ€§å“ˆå¸Œ","singleflight"],"title":"Groupcacheæºç é˜…è¯»ç¬”è®°","uri":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["golang"],"content":"singleflight è¿™ä¸ªæ¨¡å—å®ç°çš„åŠŸèƒ½å¯ä»¥è¯´æ˜¯groupcacheçš„ä¸€å¤§äº®ç‚¹ï¼Œè€Œä¸”ä»£ç é‡æå° å½“getè¯·æ±‚çš„keyæ‰¾ä¸åˆ°çš„æ—¶å€™ï¼Œå¹¶å‘çš„ç›¸åŒçš„getè¯·æ±‚å¯èƒ½ä¼šå‡»ç©¿ç¼“å­˜ é€šè¿‡singleflightå¯¹å¹¶å‘ç›¸åŒkeyçš„getè¯·æ±‚è¿›è¡Œæ‹¦æˆªï¼Œé‚£ä¹ˆçœŸæ­£åªä¼šå»getä¸€ä¸ªï¼ˆæ— è®ºæ˜¯å»peerè¿˜æ˜¯æ€æ ·ï¼‰ï¼Œå…¶ä»–å°±å¯ä»¥ç›´æ¥è¿”å› ç»“åˆä»£ç çœ‹ä¸€ä¸‹ï¼š type call struct { wg sync.WaitGroup val interface{} err error } type Group struct { mu sync.Mutex m map[string]*call } func (g *Group) Do(key string, fn func() (interface{}, error)) (interface{}, error) { g.mu.Lock() if g.m == nil { g.m = make(map[string]*call) } if c, ok := g.m[key]; ok { g.mu.Unlock() c.wg.Wait() return c.val, c.err } c := new(call) c.wg.Add(1) g.m[key] = c g.mu.Unlock() c.val, c.err = fn() c.wg.Done() g.mu.Lock() delete(g.m, key) g.mu.Unlock() return c.val, c.err } å¯¹Groupçš„æ“ä½œé€šè¿‡mutexé”ä¿æŠ¤èµ·æ¥ æ¯ä¸€ä¸ªkeyéƒ½æœ‰ä¸€ä¸ªcallï¼Œå†…éƒ¨æœ‰wgé”æ¥é˜»å¡ å½“å‘½ä¸­keyçš„æ—¶å€™ï¼Œwg waitï¼Œä¹Ÿå°±æ˜¯è¢«é˜»å¡ä½ç›´åˆ°æ‰§è¡Œé˜»å¡çš„ç¬¬ä¸€æ¬¡getè¿”å›äº†å€¼ å¦‚æœæ²¡æœ‰å‘½ä¸­keyï¼Œé‚£å°±æ˜¯ç¬¬ä¸€æ¬¡getè¿™ä¸ªkeyï¼Œæ‰€ä»¥æ–°å»ºä¸€ä¸ªcallï¼Œç„¶åwg add 1ï¼Œç„¶åæ‰§è¡Œfnå‡½æ•°å»å–å¾—å€¼ï¼Œæœ€åwg doneé‡Šæ”¾é˜»å¡ è®°å¾—ç”¨å®Œè¦æŠŠè¿™ä¸ªkeyåˆ æ‰å“¦ ä¸ç„¶ä¸‹æ¬¡è¿›æ¥ç›´æ¥å‘½ä¸­keyè€Œä¸”æ— é˜»å¡è¿”å›valäº†ï¼Œå¯¼è‡´é”™è¯¯ ä»£ç çŸ­å°ç²¾æ‚ï¼Œå¯¹å¹¶å‘çš„æ§åˆ¶å´æ˜¯ç²¾å¦™ç»ä¼¦ï¼ ","date":"2020-04-04","objectID":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:3:0","tags":["cache","ä¸€è‡´æ€§å“ˆå¸Œ","singleflight"],"title":"Groupcacheæºç é˜…è¯»ç¬”è®°","uri":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["golang"],"content":"groupcachepb pbå°±æ˜¯protobufçš„ç®€å†™ï¼Œæ‰€ä»¥è¿™å°±æ˜¯ä¸€ä¸ªæä¾›é€šä¿¡çš„æ¨¡å—ï¼Œåˆ©ç”¨protobufåšåºåˆ—åŒ–å’Œååºåˆ—åŒ– é‡Œé¢æœ‰groupcache.pb.goå’Œgroupcache.protoä¸¤ä¸ªæ–‡ä»¶ï¼Œå…¶å®å°±æ˜¯ç¼–å†™äº†protoæ–‡ä»¶ç„¶ååˆ©ç”¨protobufç”Ÿæˆgoæ–‡ä»¶ message GetRequest { required string group = 1; required string key = 2; // not actually required/guaranteed to be UTF-8 } message GetResponse { optional bytes value = 1; optional double minute_qps = 2; } service GroupCache { rpc Get(GetRequest) returns (GetResponse) { }; } å…·ä½“å»çœ‹protoæ–‡ä»¶ï¼Œå®šä¹‰äº†requestå’Œresponseçš„ä¸€äº›å­—æ®µï¼Œè¿˜å®šä¹‰äº†rpcé€šä¿¡æ¥å£ ","date":"2020-04-04","objectID":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:4:0","tags":["cache","ä¸€è‡´æ€§å“ˆå¸Œ","singleflight"],"title":"Groupcacheæºç é˜…è¯»ç¬”è®°","uri":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["golang"],"content":"byteview and sinks byteviewæ¨¡å—å°è£…äº†ä¸€ä¸ªstringä¸byte[] çš„ç»Ÿä¸€æ¥å£ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨byteviewæä¾›çš„æ¥å£ï¼Œå¯ä»¥å±è”½æ‰stringä¸byte[] çš„ä¸åŒï¼Œä½¿ç”¨æ—¶å¯ä»¥ä¸ç”¨è€ƒè™‘æ˜¯stringè¿˜æ˜¯byte[] ç„¶åsinksæ¨¡å—åœ¨å…¶åŸºç¡€ä¸Šå®ç°äº†å‡ ä¸ªsinks structï¼Œç›¸å½“äºåšäº†æ•°æ®çš„å‚¨å­˜ï¼Œå¯ä»¥setï¼›å¯ä»¥viewï¼›setprotoæ–¹æ³•æ˜¯ç”¨æ¥ä»protobufçš„messageä¸­æŠŠæ•°æ®sinkä¸‹æ¥ è¿™é‡Œæ¶‰åŠåˆ°çš„ä»£ç é‡å¤åº¦æ¯”è¾ƒé«˜ï¼Œå‡ ä¸ªstructé€»è¾‘éƒ½æ˜¯åŸºæœ¬ç›¸åŒçš„ï¼Œåœ¨æ­¤ä¸èµ˜è¿° ","date":"2020-04-04","objectID":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:5:0","tags":["cache","ä¸€è‡´æ€§å“ˆå¸Œ","singleflight"],"title":"Groupcacheæºç é˜…è¯»ç¬”è®°","uri":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["golang"],"content":"peers and http è¿™ä¸¤ä¸ªæ¨¡å—å°±å®Œæˆäº†peerçš„åˆ†å·¥å’Œåä½œ å…ˆçœ‹peeræ¨¡å—ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä¸ç®¡nopeersçš„éƒ¨åˆ†äº†ï¼ˆä¹Ÿæ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼‰ï¼Œç›´æ¥çœ‹peers type ProtoGetter interface { Get(ctx context.Context, in *pb.GetRequest, out *pb.GetResponse) error } type PeerPicker interface { PickPeer(key string) (peer ProtoGetter, ok bool) } å®šä¹‰äº†ä¸¤ä¸ªä¸ªæ¥å£ï¼Œå…³æ³¨ä¸€ä¸‹PeerPickeræ¥å£ï¼Œç”¨äºåœ¨ç»™å®škeyçš„æ—¶å€™è¿”å›å¤„ç†è¿™ä¸ªkeyçš„peerï¼Œç±»å‹æ˜¯protogetterï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªinterface é‚£ä¹ˆç›¸å¯¹åº”çš„pickpeeræ³¨å†Œå¦‚ä¸‹ï¼ˆå¯ä»¥çœ‹åˆ°åªèƒ½æ³¨å…¥ä¸€æ¬¡ï¼‰ var ( portPicker func(groupName string) PeerPicker ) func RegisterPeerPicker(fn func() PeerPicker) { if portPicker != nil { panic(\"RegisterPeerPicker called more than once\") } portPicker = func(_ string) PeerPicker { return fn() } } æ³¨å†Œå®Œå¦‚ä½•æ‰¾åˆ°keyå¯¹åº”peerçš„å‡½æ•°ï¼Œåœ¨groupcacheè°ƒç”¨getPeerså¦‚ä¸‹çš„æ—¶å€™å¯ä»¥æŸ¥æ‰¾åˆ°peer func getPeers(groupName string) PeerPicker { if portPicker == nil { return NoPeers{} } pk := portPicker(groupName) if pk == nil { pk = NoPeers{} } return pk } ç„¶åçœ‹ç›¸å¯¹æ¯”è¾ƒå¤æ‚çš„httpæ¨¡å— type HTTPPool struct { Context func(*http.Request) context.Context Transport func(context.Context) http.RoundTripper // this peer's base URL, e.g. \"https://example.net:8000\" self string // opts specifies the options. opts HTTPPoolOptions mu sync.Mutex // guards peers and httpGetters peers *consistenthash.Map httpGetters map[string]*httpGetter // keyed by e.g. \"http://10.0.0.2:8008\" } type HTTPPoolOptions struct { BasePath string Replicas int HashFn consistenthash.Hash } æœ‰ä¸Šè¿°çš„optionså‚ä¸å®šä¹‰httppoolï¼Œæ‰€ä»¥ç”¨åˆ°äº†consistent hashï¼Œä¹Ÿå°±æ˜¯å­˜æ”¾peers hashå¯¹åº”çš„æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥ä¼šå°†peersåŠ å…¥åˆ°consistent hashä¸­ type httpGetter struct { transport func(context.Context) http.RoundTripper baseURL string } // ... other code func (p *HTTPPool) Set(peers ...string) { p.mu.Lock() defer p.mu.Unlock() p.peers = consistenthash.New(p.opts.Replicas, p.opts.HashFn) p.peers.Add(peers...) p.httpGetters = make(map[string]*httpGetter, len(peers)) for _, peer := range peers { p.httpGetters[peer] = \u0026httpGetter{transport: p.Transport, baseURL: peer + p.opts.BasePath} } } æˆ‘ä»¬å…³æ³¨åˆ°httpGetteræ˜¯å®é™…å¤„ç†é€šä¿¡çš„ï¼Œæºç è¿™é‡Œçš„transportæ˜¯ä¸€ä¸ªå¯è‡ªå®šä¹‰çš„é€šä¿¡å‡½æ•°ï¼Œé»˜è®¤ä½¿ç”¨ http.DefaultTransport é‚£ä¹ˆhttpGetteræ˜¯æ€æ ·çš„å‘¢ï¼Ÿå…¶å®å°±æ˜¯é€šè¿‡protobufå‘é€getè¯·æ±‚ func (h *httpGetter) Get(ctx context.Context, in *pb.GetRequest, out *pb.GetResponse) error { u := fmt.Sprintf( \"%v%v/%v\", h.baseURL, url.QueryEscape(in.GetGroup()), url.QueryEscape(in.GetKey()), ) req, err := http.NewRequest(\"GET\", u, nil) if err != nil { return err } req = req.WithContext(ctx) tr := http.DefaultTransport if h.transport != nil { tr = h.transport(ctx) } res, err := tr.RoundTrip(req) if err != nil { return err } defer res.Body.Close() if res.StatusCode != http.StatusOK { return fmt.Errorf(\"server returned: %v\", res.Status) } b := bufferPool.Get().(*bytes.Buffer) b.Reset() defer bufferPool.Put(b) _, err = io.Copy(b, res.Body) if err != nil { return fmt.Errorf(\"reading response body: %v\", err) } err = proto.Unmarshal(b.Bytes(), out) if err != nil { return fmt.Errorf(\"decoding response body: %v\", err) } return nil } é‚£peerä½œä¸ºå®¢æˆ·ç«¯å‘é€getè¯·æ±‚ï¼Œä½œä¸ºæœåŠ¡ç«¯è¿˜è¦å“åº”getè¯·æ±‚å§ï¼Œæ‰€ä»¥åˆæœ‰å¦‚ä¸‹çš„handleå¤„ç† func (p *HTTPPool) ServeHTTP(w http.ResponseWriter, r *http.Request) { // Parse request. if !strings.HasPrefix(r.URL.Path, p.opts.BasePath) { panic(\"HTTPPool serving unexpected path: \" + r.URL.Path) } parts := strings.SplitN(r.URL.Path[len(p.opts.BasePath):], \"/\", 2) if len(parts) != 2 { http.Error(w, \"bad request\", http.StatusBadRequest) return } groupName := parts[0] key := parts[1] // Fetch the value for this group/key. group := GetGroup(groupName) if group == nil { http.Error(w, \"no such group: \"+groupName, http.StatusNotFound) return } var ctx context.Context if p.Context != nil { ctx = p.Context(r) } else { ctx = r.Context() } group.Stats.ServerRequests.Add(1) var value []byte err := group.Get(ctx, key, AllocatingByteSliceSink(\u0026value)) if err != nil { http.Error(w, err.Error(), http.StatusInternalServerError) return } // Write the value to the response body as a proto message. body, err := proto.Marshal(\u0026pb.GetResponse{Value: value}) if err != nil { http.Error(w, err.Error(), http.StatusInternalServerError) return } w.Header().Set(\"Content-Type\", \"application/x-protobuf\") w.Write(body) } ","date":"2020-04-04","objectID":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:6:0","tags":["cache","ä¸€è‡´æ€§å“ˆå¸Œ","singleflight"],"title":"Groupcacheæºç é˜…è¯»ç¬”è®°","uri":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["golang"],"content":"groupcache æ¥ä¸‹æ¥æ˜¯æ§åˆ¶ä¸­å¿ƒ groupcache.go æŠ›å¼€ä¸€åˆ‡æ¬¡è¦ä»£ç  å…ˆçœ‹ä¸€ä¸‹groupç»“æ„ type Group struct { name string getter Getter peersOnce sync.Once peers PeerPicker cacheBytes int64 mainCache cache hotCache cache loadGroup flightGroup _ int32 Stats Stats } æºç å…¶å®æ³¨è§£å¾—ç›¸å½“æ¸…æ¥šï¼š nameå¯¹åº”groupæ ‡è¯†ç¬¦ getteræ˜¯è·å–valçš„å¤„ç†å‡½æ•° peersæ˜¯peer groupsçš„é›†åˆï¼Œå®ç°äº†peerpickeræ¥å£ cacheBytes å†³å®šäº†cacheçš„å¤§å° mainCacheæ˜¯å½“å‰groupçš„ç¼“å­˜åŒº hotCacheæ˜¯ä»å…¶ä»–groupæŸ¥è¯¢åè¿ç§»è¿‡æ¥çš„ç¼“å­˜ loadGroupé¿å…ç¼“å†²å‡»ç©¿ Statsç»´æŠ¤äº†ç¼“å­˜çš„çŠ¶æ€æ•°æ®ï¼ŒåŒ…æ‹¬æŸ¥è¯¢çƒ­ç‚¹ç­‰ç­‰ ä¸»è¦é€»è¾‘æ˜¯é…±ï¼š åˆå§‹åŒ–peers å…ˆåœ¨æœ¬åœ°çš„mainCacheå’ŒhotCacheæŸ¥è¯¢ï¼Œæ‰¾åˆ°å°±è¿”å› æ‰¾ä¸åˆ°çš„è¯å»peersä¸­æŸ¥è¯¢ï¼Œç”¨å“ªä¸€ä¸ªpeeré€šè¿‡peerPickerï¼Œå†…éƒ¨ç”±consistenthashå®ç°ï¼Œç„¶åè¿ç§»åˆ°hotcache å¦‚æœpeersè¿˜æ²¡æœ‰ï¼Œé‚£å°±å»å†ä¸‹ä¸€å±‚çš„æ•°æ®åº“æˆ–è€…æ–‡ä»¶æŸ¥æ‰¾ï¼ˆæ•°æ®æºçš„å®šä¹‰å’Œæ“ä½œéƒ½æ˜¯è‡ªå®šä¹‰çš„ï¼‰ ä¸­é—´ä¸ºäº†é¿å…ç¼“å­˜å‡»ç©¿ï¼Œä½¿ç”¨äº†singleflight cacheæ¯æ¬¡æ“ä½œkeyåéƒ½ä¼šæ ¹æ®lruæ›´æ–° ","date":"2020-04-04","objectID":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/:7:0","tags":["cache","ä¸€è‡´æ€§å“ˆå¸Œ","singleflight"],"title":"Groupcacheæºç é˜…è¯»ç¬”è®°","uri":"/myblog/groupcache%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"},{"categories":["web"],"content":"è®°å½•è¿ç§»ä¸ªäººåšå®¢åˆ°Hugoçš„è¿‡ç¨‹ ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:0:0","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["web"],"content":"å†™åœ¨å‰é¢ åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘çš„æŠ€æœ¯åšå®¢ç»å†è¿‡wordpressã€hexoã€typecho ä¸ºä»€ä¹ˆé€‰æ‹©Hugo buildé€Ÿåº¦å¿« ç¬¦åˆä¸ªäººå†™ä½œä¹ æƒ¯ï¼ˆtypora locallyï¼‰ golangå¤§æ³•å¥½ å¼€å§‹çš„æƒ³æ³•æ˜¯å•çº¯éƒ¨ç½²åœ¨Github Pagesä¸Šï¼Œä½†æ˜¯githubå“åº”é€Ÿåº¦å¤ªæ…¢ äºæ˜¯å†³å®šé‡‡ç”¨githubä½œä¸ºä»“åº“ï¼Œå®é™…éƒ¨ç½²åœ¨è‡ªå·±çš„é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸Šï¼Œç”¨Docker+Webhooksçš„å½¢å¼å®ç°é«˜æ•ˆç®¡ç† ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:1:0","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["web"],"content":"Docker For Static ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:2:0","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["web"],"content":"docker dockeræ˜¯éš”ç¦»é¡¹ç›®å’Œå®¿ä¸»æœºçš„æœ€ä½³è§£å†³æ–¹æ¡ˆï¼Œé‡‡ç”¨dockerå¯ä»¥é¿å…å®¿ä¸»æœºç¯å¢ƒå’Œé¡¹ç›®ç¯å¢ƒçš„äº’ç›¸å½±å“ï¼ŒåŒæ ·æœ‰åŠ©äºé¡¹ç›®çš„ç‰ˆæœ¬è¿­ä»£ ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:2:1","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["web"],"content":"æ–¹æ¡ˆ hugo buildç”Ÿæˆé™æ€ç½‘é¡µæ–‡ä»¶ï¼Œå­˜æ”¾åœ¨publicæ–‡ä»¶å¤¹ä¸­ é€šè¿‡gitç‰ˆæœ¬ç®¡ç†ï¼Œçº¿ä¸Šä»“åº“ç”¨github é˜¿é‡Œäº‘æœåŠ¡å™¨æ„å»ºä¸€ä¸ªnginxçš„dockerï¼Œå°†usr/share/nginx/htmlæŒ‚è½½åˆ°å®¿ä¸»æœº ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:2:2","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["web"],"content":"bash code # æŸ¥æ‰¾nginx dockeræº docker search nginx # ä¸‹è½½æƒ³è¦çš„nginx docker install nginx:(tag) # å¯ä»¥é€šè¿‡docker imagesæŸ¥çœ‹æ˜¯å¦ä¸‹è½½å®Œæˆ docker images # è¿è¡Œdocker docker run -dt \\ --restart=always \\ --name hugoblog \\ -p 8010:80 \\ -v ~/hugoblog/html:/usr/share/nginx/html \\ -d nginx ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:2:3","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["web"],"content":"Webhooks ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:3:0","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["web"],"content":"webhooks githubè¢«å¾®è½¯æ”¶è´­ä»¥åæ¨å‡ºçš„å…è´¹åŠŸèƒ½ å½“ç”¨æˆ·æ³¨å†Œå¥½webhooksåï¼Œgithubä¼šåœ¨repoå‘ç”Ÿå˜åŠ¨åå‘ç”¨æˆ·æ³¨å†Œçš„URLå‘é€ä¸€ä¸ªpostè¯·æ±‚ send me everything çš„é€‰é¡¹å°†ä¼šæ¶‰åŠå‡ åç§äº‹ä»¶ï¼Œå¯å‚è§webhooksçš„æ–‡æ¡£ï¼Œè¿™é‡Œæˆ‘åªé€‰æ‹©äº†pushäº‹ä»¶éœ€è¦é€šçŸ¥ payload URL ä¸­éœ€è¦å¡«å†™å¯æ¥å—postè¯·æ±‚çš„ç½‘ç»œåœ°å€ Content type æ˜¯postè¯·æ±‚çš„bodyæ ¼å¼ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº†application/json Secret æ˜¯è‡ªè¡Œè®¾å®šçš„ä¸€ä¸ªå¯†é’¥ï¼Œæ”¶åˆ°postè¯·æ±‚ååœ¨æœåŠ¡å™¨ç«¯å¯ä»¥é€šè¿‡å¯†é’¥å¯¹packetè¿›è¡ŒéªŒè¯ ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:3:1","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["web"],"content":"server handler æ¥ä¸‹æ¥å°±æ˜¯æœåŠ¡ç«¯å¯¹postè¯·æ±‚å“åº”å¤„ç†çš„é€»è¾‘ æˆ‘ç”¨çš„æ˜¯Expressjsï¼Œæ˜¯ä¸€ä¸ªNodeæ¡†æ¶ï¼Œä¸»è¦ä¸šåŠ¡é€»è¾‘å¦‚ä¸‹ï¼ˆå·æ‡’æ²¡æœ‰å†™æ£€éªŒï¼‰ // hugoblog webhook // å·æ‡’ä¸å†™æ ¡éªŒäº† app.post('/hugoblog', (req, res) =\u003e { console.log(req.body); const eventName = req.get('X-GitHub-Event') const sign = req.get('X-Hub-Signature') const delivery = req.get('X-GitHub-Delivery') const refHead = req.body.ref console.log(\"Receive a event: \", eventName); console.log('sign:', sign) console.log('delivery:', delivery) console.log('refHead:', refHead, typeof(refHead),refHead === 'refs/heads/master') if(refHead === 'refs/heads/master') { const shell = 'app/bash/hugoblog.sh' setTimeout(() =\u003e { console.log('new thread execute shell', shell) exec(shell, (err,stdout,stderr) =\u003e { if (stdout) { console.log('stdout out \u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e') console.log(stdout) console.log('stdout over \u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e\u003e') } err \u0026\u0026 console.log('hasErr: ', err) stderr \u0026\u0026 console.log('stderr: ', stderr) }) }, 500) } res.send(\"ok\"); }) å½“æ¥æ”¶åˆ°postè¯·æ±‚åï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºmasteråˆ†æ”¯çš„è¯·æ±‚ï¼Œç„¶åæ‰§è¡Œå‡†å¤‡å¥½çš„bashè„šæœ¬ bashè„šæœ¬å†…å®¹å¦‚ä¸‹ WEB_PATH='/root/hugoblog/html' echo \"Start deployment\" cd $WEB_PATH echo \"pulling source code...\" git pull origin master echo \"restart docker...\" docker restart hugoblog echo \"Finished.\" æ³¨æ„ è®°å¾—è¦é‡å¯æ‰¿è½½é™æ€ç½‘é¡µæ–‡ä»¶çš„nginx dockerå“¦ ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:3:2","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["web"],"content":"è®©Blogæ›´æ–°åªéœ€è¦ä¸€è¡Œå‘½ä»¤ bashï¼Œè®©ä½ çš„ç”Ÿæ´»æ›´ç¾å¥½ğŸ˜„ # filename: fire.sh # path: hugoç«™ç‚¹æ ¹ç›®å½•ä¸‹ echo \"ready to fire...\" echo \"hugo build\" hugo echo \"cd public dir\" cd public echo \"git add\" git add . echo \"git commit\" git commit -m \"hugo modify - auto commit\" echo \"git push\" git push origin master echo \"fire finished\" å†™å¥½æ–‡ç« åªéœ€è¦ ./fire.sh å³å¯ ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:4:0","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["web"],"content":"Possible Error \u0026 Solution req.bodyæ²¡æœ‰data ä¸»è¦æ˜¯expressjs 4.0ä»¥åçš„ç‰ˆæœ¬å°†bodyparseræ¨¡å—åŠŸèƒ½ç‹¬ç«‹äº†å‡ºæ¥ï¼Œéœ€è¦è‡ªè¡Œæ·»åŠ ä¸­é—´ä»¶ // for json parser app.use(bodyParser.json()) // for x-www-form-urlencoded parser app.use(bodyParser.urlencoded({extended:true})); // æ ¹æ®éœ€è¦ä½¿ç”¨è¿™ä¸¤ä¸ªä¸­é—´ä»¶å³å¯ bashè„šæœ¬æ‰§è¡Œæ— æ•ˆ èµ·åˆæˆ‘å°†å“åº”webhookçš„expressjsåŒæ ·åšæˆäº†ä¸€ä¸ªdocker è¿™å°±å¯¼è‡´æ‰§è¡Œbashæ˜¯åœ¨å®¹å™¨å†…æ‰§è¡Œçš„ï¼Œå¯¹å®¿ä¸»æœºæ²¡æœ‰ä»»ä½•å½±å“ è§£å†³æ–¹æ¡ˆåŒ…æ‹¬æ‰§è¡Œsshè¿œç¨‹å‘½ä»¤ã€å°†å“åº”webhookçš„æ¡†æ¶ç›´æ¥æ¶è®¾åœ¨å®¿ä¸»æœºä¸­ã€dockerä¹‹é—´å»ºç«‹å…³è”ç­‰ç­‰ ","date":"2020-03-30","objectID":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/:5:0","tags":["Docker","Hugo","Webhooks"],"title":"Hugo+Docker+Webhooksæœ€ä½³å®è·µ","uri":"/myblog/hugo-docker-webhooks%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},{"categories":["ç®—æ³•","å¤§å­¦è¯¾ç¨‹"],"content":"é€‚ç”¨äºæ‰€æœ‰æƒ…å†µå®Œå…¨å·²çŸ¥çš„æ¸¸æˆï¼Œå¹¶ä¸”æ˜¯é›¶å’Œæ¸¸æˆã€‚ é›¶å’Œæ¸¸æˆï¼ˆZero-sum Gameï¼‰ï¼šæ„æ€å°±æ˜¯ä½ æ­»æˆ‘æ´»ï¼Œä¸€æ–¹çš„èƒœåˆ©ä»£è¡¨å¦ä¸€æ–¹çš„å¤±è´¥ï¼Œæ¯”å¦‚ï¼Œè±¡æ£‹ï¼Œäº”å­æ£‹ç­‰ã€‚ å®Œå…¨ä¿¡æ¯ï¼ˆPerfect Informationï¼‰ï¼šç©å®¶çŸ¥é“ä¹‹å‰æ‰€æœ‰çš„æ­¥éª¤ã€‚è±¡æ£‹å°±æ˜¯å®Œå…¨ä¿¡æ¯ï¼Œå› ä¸ºç©å®¶æ˜¯äº¤æ›¿ç€è½å­ï¼Œä¸”ä¹‹å‰çš„æ­¥éª¤éƒ½èƒ½åœ¨æ£‹ç›˜ä¸Šä½“ç°ï¼Œä½†æ˜¯çŸ³å¤´å‰ªå­å¸ƒå°±ä¸æ˜¯ã€‚ è¿™æ ·çš„æ¸¸æˆå¯ä»¥ç”¨æ ‘çŠ¶å›¾è¡¨ç¤ºï¼šMAXè¡¨ç¤ºè‡ªå·±ï¼ŒMINè¡¨ç¤ºå¯¹æ‰‹ï¼›Utilityæ˜¯å¯¹ç€ä¸€ç§æƒ…å†µç»™å‡ºçš„åˆ†æ•°ï¼ˆå¯¹è‡ªå·±è€Œè¨€è¶Šé«˜è¶Šå¥½ï¼‰ minmax\" minmax é‚£ä¹ˆè‡ªå·±å¸Œæœ›æœ€å¤§åŒ–è¿™ä¸€utilityï¼Œå¯¹æ‰‹å¸Œæœ›æœ€å°åŒ–è¿™ä¸€utilityï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ç»“æœåæ¨æŸä¸€æ­¥åº”è¯¥é‡‡å–çš„é€‰æ‹©ã€‚ step1\" step1 step2\" step2 step3\" step3 step4\" step4 ç”±äºæƒ…å†µæ•°å¤ªå¤šéœ€è¦é‡‡å–å‰ªæç®—æ³•ï¼ˆAlpha-Betaï¼‰æ¥å‡å°‘è¿ç®—é‡ï¼š æ¯ä¸ªMAXç»“ç‚¹è®¾ç½®ä¸€ä¸ªç›®å‰å·²çŸ¥ä¸‹ç•Œalphaï¼Œæ¯ä¸ªMINèŠ‚ç‚¹è®¾ç½®ä¸€ä¸ªç›®å‰å·²çŸ¥ä¸Šç•Œbetaã€‚å½“è®¡ç®—ä¸€ä¸ªMINç»“ç‚¹æ—¶ï¼Œå¦‚æœå®ƒçš„betaå€¼å°äºç­‰äºå…¶çˆ¶ç»“ç‚¹çš„alphaå€¼ï¼Œåˆ™å¯ä»¥ç«‹å³åœæ­¢æ­¤ç»“ç‚¹çš„è®¡ç®—ï¼ˆalphaå‰ªæï¼‰ï¼›å½“è®¡ç®—ä¸€ä¸ªMAXç»“ç‚¹æ—¶ï¼Œå¦‚æœå®ƒçš„alphaç»“ç‚¹å¤§äºç­‰äºå…¶çˆ¶ç»“ç‚¹çš„betaå€¼ï¼Œä¹Ÿå¯ä»¥ç«‹å³åœæ­¢æ­¤ç»“ç‚¹çš„è®¡ç®—ï¼ˆbetaå‰ªæï¼‰ ","date":"2020-03-10","objectID":"/myblog/min-max%E7%AE%97%E6%B3%95%E5%8F%8Aalpha-beta%E5%89%AA%E6%9E%9D/:0:0","tags":["min-max","alpha-beta"],"title":"Min-Maxç®—æ³•åŠAlpha-Betaå‰ªæ","uri":"/myblog/min-max%E7%AE%97%E6%B3%95%E5%8F%8Aalpha-beta%E5%89%AA%E6%9E%9D/"},{"categories":["ç®—æ³•"],"content":"è®°å½•ä¸€ä¸‹å¾ˆæ—©å°±å­¦è¿‡çš„å¹¶æŸ¥é›† æœ€ç®€æ´è€Œä¼˜é›…çš„æ•°æ®ç»“æ„ä¹‹ä¸€ ä¸»è¦ç”¨äºè§£å†³ä¸€äº›å…ƒç´ åˆ†ç»„çš„é—®é¢˜ ","date":"2020-02-07","objectID":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/:0:0","tags":["å¹¶æŸ¥é›†"],"title":"å¹¶æŸ¥é›†ç®—æ³•æ¦‚å¿µåŠå®ç°","uri":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"},{"categories":["ç®—æ³•"],"content":"æ ¸å¿ƒæ€æƒ³ é€šè¿‡ä¸€ç»´æ•°ç»„ï¼Œindexè¡¨ç¤ºå½“å‰å…ƒç´ ç¼–å·ï¼Œvalueè®°å½•å½“å‰å…ƒç´ çš„ä¸Šçº§å…ƒç´ ï¼Œé€šè¿‡é€’å½’æŸ¥æ‰¾åˆ°å…³ç³»ç½‘çš„æ ¹å…ƒç´  è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œä¸ºäº†é¿å…æŸ¥æ‰¾æ•ˆç‡ä½ä¸‹ï¼Œæ¯æ¬¡åœ¨æŸ¥æ‰¾æ ¹å…ƒç´ çš„æ—¶å€™è¿›è¡Œè·¯å¾„å‹ç¼©ï¼Œä¹Ÿå°±æ˜¯å°†è·¯å¾„ä¸Šçš„å…ƒç´ çš„ä¸Šçº§å…ƒç´ å…¨éƒ¨æ›´æ”¹ä¸ºæ ¹å…ƒç´ ï¼Œè¿™æ ·å‡å°‘äº†é€’å½’å±‚çº§ ","date":"2020-02-07","objectID":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/:1:0","tags":["å¹¶æŸ¥é›†"],"title":"å¹¶æŸ¥é›†ç®—æ³•æ¦‚å¿µåŠå®ç°","uri":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"},{"categories":["ç®—æ³•"],"content":"æ•°ç»„è®°å½•å…ƒç´ å…³ç³» å¼€å§‹çš„æ—¶å€™key=valueè¡¨ç¤ºæ¯ä¸ªå…ƒç´ çš„çˆ¸çˆ¸æ˜¯è‡ªå·±æœ¬èº« relationrelation \" relation ç„¶åæ¯”å¦‚2å’Œ3ä»å±äº1 é‚£ä¹ˆå°±ä¼šæœ‰å¦‚ä¸‹å…³ç³»arr[2] = 1ä»¥åŠarr[3] = 1 relation2relation2 \" relation2 ","date":"2020-02-07","objectID":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/:1:1","tags":["å¹¶æŸ¥é›†"],"title":"å¹¶æŸ¥é›†ç®—æ³•æ¦‚å¿µåŠå®ç°","uri":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"},{"categories":["ç®—æ³•"],"content":"è·¯å¾„å‹ç¼© å¹¶æŸ¥é›†çš„æ•°æ®å‚¨å­˜æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´ä»å±é“¾è¿‡é•¿ è€Œå¯¼è‡´æŸ¥è¯¢æ•ˆç‡ä½ä¸‹ routeroute \" route æ¯”å¦‚ä¸Šé¢çš„å›¾åœ¨æŸ¥è¯¢2çš„æ ¹èŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­ å®Œå…¨å¯ä»¥å°†è¿™æ¡è·¯å¾„ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ç›´æ¥æŒ‡å‘4 è¿™æ ·å°±ä¼˜åŒ–äº†æ•°æ®ç»“æ„ (æ¢ä¸ªè§’åº¦è®²å°±æ˜¯å‡å°‘äº†æ ‘çš„æ·±åº¦) ","date":"2020-02-07","objectID":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/:1:2","tags":["å¹¶æŸ¥é›†"],"title":"å¹¶æŸ¥é›†ç®—æ³•æ¦‚å¿µåŠå®ç°","uri":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"},{"categories":["ç®—æ³•"],"content":"å®ç°ä»£ç  å°†å¹¶æŸ¥é›†Disjoint Set Unionå†™æˆä¸€ä¸ªå•ç‹¬çš„classæ–¹ä¾¿è°ƒç”¨ class DSU { public int parent[]; public DSU(int n) { this.parent = new int[n]; for(int i=0;i\u003cn;i++) parent[i] = i; } public int find(int x) { if(x!=parent[x]) parent[x] = find(parent[x]); return parent[x]; } public void join(int x, int y) { parent[find(x)] = find(y); } public void print() { for(int i=0;i\u003cparent.length;i++) { System.out.println(i+\": \"+parent[i]); } } } è¿™é‡Œå¯¹int find(int x)ç®€å•åšä¸€ä¸‹è§£é‡Š xè¡¨ç¤ºå¾…æŸ¥æ‰¾çš„å…ƒç´  å‡å¦‚å®ƒå¹¶ä¸æ˜¯æ ¹å…ƒç´  åˆ™è°ƒç”¨find(parent[x])é€’å½’æ‰¾åˆ°æ ¹å…ƒç´  åŒæ—¶å°†æ ¹å…ƒç´ èµ‹å€¼ç»™parent[x](è¿™æ ·å°±å®ç°äº†è·¯å¾„çš„å‹ç¼©) è¿”å›çš„å½“ç„¶æ˜¯parent[x] å› ä¸ºåªæœ‰å®ƒæ˜¯åœ¨è¢«æ›´æ–°çš„ ","date":"2020-02-07","objectID":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/:2:0","tags":["å¹¶æŸ¥é›†"],"title":"å¹¶æŸ¥é›†ç®—æ³•æ¦‚å¿µåŠå®ç°","uri":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"},{"categories":["ç®—æ³•"],"content":"LeetCodeç»ƒä¹  ä¸Šæ‰‹ç»ƒå‡ é“é¢˜å·©å›ºçŸ¥è¯† ","date":"2020-02-07","objectID":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/:3:0","tags":["å¹¶æŸ¥é›†"],"title":"å¹¶æŸ¥é›†ç®—æ³•æ¦‚å¿µåŠå®ç°","uri":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"},{"categories":["ç®—æ³•"],"content":"#959 ç”±æ–œæ åˆ’åˆ†åŒºåŸŸ é¢˜ç›® åœ¨ç”± 1 x 1 æ–¹æ ¼ç»„æˆçš„ N x N ç½‘æ ¼ grid ä¸­ï¼Œæ¯ä¸ª 1 x 1 æ–¹å—ç”± /ã€\\ æˆ–ç©ºæ ¼æ„æˆã€‚è¿™äº›å­—ç¬¦ä¼šå°†æ–¹å—åˆ’åˆ†ä¸ºä¸€äº›å…±è¾¹çš„åŒºåŸŸã€‚ ï¼ˆè¯·æ³¨æ„ï¼Œåæ–œæ å­—ç¬¦æ˜¯è½¬ä¹‰çš„ï¼Œå› æ­¤ \\ ç”¨ â€œ\\â€ è¡¨ç¤ºã€‚ï¼‰ è¿”å›åŒºåŸŸçš„æ•°ç›®ã€‚ class Solution { public int regionsBySlashes(String[] grid) { int N = grid.length; DSU dsu = new DSU(4*N*N); for (int i=0;i\u003cN;i++) { for (int j=0;j\u003cN;j++) { char ch = grid[i].charAt(j); int base = (i*N + j)*4; // join in a cell if(ch == ' ') { dsu.join(base,base+1); dsu.join(base, base+2); dsu.join(base, base+3); } else if (ch == '/') { dsu.join(base,base+3); dsu.join(base+1,base+2); } else if (ch == '\\\\') { dsu.join(base,base+1); dsu.join(base+2,base+3); } else { System.out.println(\"input error!\"); return 0; } // join with other cells if(i \u003e 0) { dsu.join(base, base-4*N+2); } if(j \u003e 0) { dsu.join(base+3, base-4+1); } } } // get res int res = 0; for (int i = 0; i \u003c 4 * N * N; i++) { if (dsu.find(i) == i) res++; } return res; } } ","date":"2020-02-07","objectID":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/:3:1","tags":["å¹¶æŸ¥é›†"],"title":"å¹¶æŸ¥é›†ç®—æ³•æ¦‚å¿µåŠå®ç°","uri":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"},{"categories":["ç®—æ³•"],"content":"#990 ç­‰å¼æ–¹ç¨‹çš„å¯æ»¡è¶³æ€§ é¢˜ç›® ç»™å®šä¸€ä¸ªç”±è¡¨ç¤ºå˜é‡ä¹‹é—´å…³ç³»çš„å­—ç¬¦ä¸²æ–¹ç¨‹ç»„æˆçš„æ•°ç»„ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²æ–¹ç¨‹ equations[i] çš„é•¿åº¦ä¸º 4ï¼Œå¹¶é‡‡ç”¨ä¸¤ç§ä¸åŒçš„å½¢å¼ä¹‹ä¸€ï¼šâ€œa==bâ€ æˆ– â€œa!=bâ€ã€‚åœ¨è¿™é‡Œï¼Œa å’Œ b æ˜¯å°å†™å­—æ¯ï¼ˆä¸ä¸€å®šä¸åŒï¼‰ï¼Œè¡¨ç¤ºå•å­—æ¯å˜é‡åã€‚ åªæœ‰å½“å¯ä»¥å°†æ•´æ•°åˆ†é…ç»™å˜é‡åï¼Œä»¥ä¾¿æ»¡è¶³æ‰€æœ‰ç»™å®šçš„æ–¹ç¨‹æ—¶æ‰è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ ç¤ºä¾‹ 1 è¾“å…¥ï¼š[â€œa==bâ€,â€œb!=aâ€] è¾“å‡ºï¼šfalse è§£é‡Šï¼šå¦‚æœæˆ‘ä»¬æŒ‡å®šï¼Œa = 1 ä¸” b = 1ï¼Œé‚£ä¹ˆå¯ä»¥æ»¡è¶³ç¬¬ä¸€ä¸ªæ–¹ç¨‹ï¼Œä½†æ— æ³•æ»¡è¶³ç¬¬äºŒä¸ªæ–¹ç¨‹ã€‚æ²¡æœ‰åŠæ³•åˆ†é…å˜é‡åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ–¹ç¨‹ã€‚ ç¤ºä¾‹ 2 è¾“å‡ºï¼š[â€œb==aâ€,â€œa==bâ€] è¾“å…¥ï¼štrue è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æŒ‡å®š a = 1 ä¸” b = 1 ä»¥æ»¡è¶³æ»¡è¶³è¿™ä¸¤ä¸ªæ–¹ç¨‹ã€‚ ç¤ºä¾‹ 3 è¾“å…¥ï¼š[â€œa==bâ€,â€œb==câ€,â€œa==câ€] è¾“å‡ºï¼štrue ç¤ºä¾‹ 4 è¾“å…¥ï¼š[â€œa==bâ€,â€œb!=câ€,â€œc==aâ€] è¾“å‡ºï¼šfalse ç¤ºä¾‹ 5 è¾“å…¥ï¼š[â€œc==câ€,â€œb==dâ€,â€œx!=zâ€] è¾“å‡ºï¼štrue æç¤º 1 \u003c= equations.length \u003c= 500 equations[i].length == 4 equations[i][0] å’Œ equations[i][3] æ˜¯å°å†™å­—æ¯ equations[i][1] è¦ä¹ˆæ˜¯ =ï¼Œè¦ä¹ˆæ˜¯ ! equations[i][2] æ˜¯ = class Solution { public boolean equationsPossible(String[] equations) { DSU dsu = new DSU(26); for (String equation : equations) { if(equation.charAt(1) == '=') { int x = equation.charAt(0) - 'a'; int y = equation.charAt(3) - 'a'; dsu.join(x, y); } } for (String equation : equations) { if(equation.charAt(1) == '!') { int x = equation.charAt(0) - 'a'; int y = equation.charAt(3) - 'a'; if(dsu.find(x) == dsu.find(y)) return false; } } return true; } } ","date":"2020-02-07","objectID":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/:3:2","tags":["å¹¶æŸ¥é›†"],"title":"å¹¶æŸ¥é›†ç®—æ³•æ¦‚å¿µåŠå®ç°","uri":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"},{"categories":["ç®—æ³•"],"content":"#1202 äº¤æ¢å­—ç¬¦ä¸²ä¸­çš„å…ƒç´  é¢˜ç›® ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œä»¥åŠè¯¥å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›ã€Œç´¢å¼•å¯¹ã€æ•°ç»„ pairsï¼Œå…¶ä¸­ pairs[i] = [a, b] è¡¨ç¤ºå­—ç¬¦ä¸²ä¸­çš„ä¸¤ä¸ªç´¢å¼•ï¼ˆç¼–å·ä» 0 å¼€å§‹ï¼‰ ä½ å¯ä»¥ä»»æ„å¤šæ¬¡äº¤æ¢åœ¨ pairs ä¸­ä»»æ„ä¸€å¯¹ç´¢å¼•å¤„çš„å­—ç¬¦ã€‚ è¿”å›åœ¨ç»è¿‡è‹¥å¹²æ¬¡äº¤æ¢åï¼Œs å¯ä»¥å˜æˆçš„æŒ‰å­—å…¸åºæœ€å°çš„å­—ç¬¦ä¸²ã€‚ ç¤ºä¾‹ 1 è¾“å…¥ï¼šs = â€œdcabâ€, pairs = [[0,3],[1,2]] è¾“å‡ºï¼šâ€œbacdâ€ è§£é‡Šï¼š äº¤æ¢ s[0] å’Œ s[3], s = â€œbcadâ€ äº¤æ¢ s[1] å’Œ s[2], s = â€œbacdâ€ ç¤ºä¾‹ 2 è¾“å…¥ï¼šs = â€œdcabâ€, pairs = [[0,3],[1,2],[0,2]] è¾“å‡ºï¼šâ€œabcdâ€ è§£é‡Šï¼š äº¤æ¢ s[0] å’Œ s[3], s = â€œbcadâ€ äº¤æ¢ s[0] å’Œ s[2], s = â€œacbdâ€ äº¤æ¢ s[1] å’Œ s[2], s = â€œabcdâ€ ç¤ºä¾‹ 3 è¾“å…¥ï¼šs = â€œcbaâ€, pairs = [[0,1],[1,2]] è¾“å‡ºï¼šâ€œabcâ€ è§£é‡Šï¼š äº¤æ¢ s[0] å’Œ s[1], s = â€œbcaâ€ äº¤æ¢ s[1] å’Œ s[2], s = â€œbacâ€ äº¤æ¢ s[0] å’Œ s[1], s = â€œabcâ€ æç¤º 1 \u003c= s.length \u003c= 10^5 0 \u003c= pairs.length \u003c= 10^5 0 \u003c= pairs[i][0], pairs[i][1] \u003c s.length s ä¸­åªå«æœ‰å°å†™è‹±æ–‡å­—æ¯ import java.util.*; public class SwapString { public static void main(String[] args) { Scanner in = new Scanner(System.in); SwapString a = new SwapString(); String s = in.nextLine(); int n = in.nextInt(); List\u003cList\u003cInteger\u003e\u003e pairs = new ArrayList\u003c\u003e(); for (int i = 0; i \u003c n; i++) { ArrayList\u003cInteger\u003e pair = new ArrayList\u003c\u003e(); pair.add(in.nextInt()); pair.add(in.nextInt()); pairs.add(pair); } String res = a.smallestStringWithSwaps(s, pairs); System.out.println(\"res: \" + res); } public String smallestStringWithSwaps(String s, List\u003cList\u003cInteger\u003e\u003e pairs) { int len = s.length(); DSU dsu = new DSU(len); for (List\u003cInteger\u003e pair : pairs) { int x = pair.get(0); int y = pair.get(1); dsu.join(x, y); } // System.out.println(dsu); // force union int temp; HashSet\u003cInteger\u003e hs = new HashSet\u003c\u003e(); for (int i = 0; i \u003c len; i++) { temp = dsu.find(i); hs.add(temp); } StringBuilder strb = new StringBuilder(s); for (Integer item : hs) { System.out.println(\"sort item: \" + item); // collect item List\u003cCharacter\u003e ls = new ArrayList\u003c\u003e(); List\u003cInteger\u003e pos = new ArrayList\u003c\u003e(); for (int i = 0; i \u003c len; i++) { if (dsu.parent[i] == item) { ls.add(s.charAt(i)); pos.add(i); } } // sort Collections.sort(ls, Comparator.comparingInt(Character::charValue)); System.out.println(ls); for (int i=0;i\u003cls.size();i++) { strb.setCharAt(pos.get(i), ls.get(i)); } } return strb.toString(); } } ","date":"2020-02-07","objectID":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/:3:3","tags":["å¹¶æŸ¥é›†"],"title":"å¹¶æŸ¥é›†ç®—æ³•æ¦‚å¿µåŠå®ç°","uri":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"},{"categories":["ç®—æ³•"],"content":"#1319 è¿é€šç½‘ç»œçš„æ“ä½œæ¬¡æ•° é¢˜ç›® ç”¨ä»¥å¤ªç½‘çº¿ç¼†å°† n å°è®¡ç®—æœºè¿æ¥æˆä¸€ä¸ªç½‘ç»œï¼Œè®¡ç®—æœºçš„ç¼–å·ä» 0 åˆ° n-1ã€‚çº¿ç¼†ç”¨ connections è¡¨ç¤ºï¼Œå…¶ä¸­ connections[i] = [a, b] è¿æ¥äº†è®¡ç®—æœº a å’Œ b ç½‘ç»œä¸­çš„ä»»ä½•ä¸€å°è®¡ç®—æœºéƒ½å¯ä»¥é€šè¿‡ç½‘ç»œç›´æ¥æˆ–è€…é—´æ¥è®¿é—®åŒä¸€ä¸ªç½‘ç»œä¸­å…¶ä»–ä»»æ„ä¸€å°è®¡ç®—æœº ç»™ä½ è¿™ä¸ªè®¡ç®—æœºç½‘ç»œçš„åˆå§‹å¸ƒçº¿ connectionsï¼Œä½ å¯ä»¥æ‹”å¼€ä»»æ„ä¸¤å°ç›´è¿è®¡ç®—æœºä¹‹é—´çš„çº¿ç¼†ï¼Œå¹¶ç”¨å®ƒè¿æ¥ä¸€å¯¹æœªç›´è¿çš„è®¡ç®—æœºã€‚è¯·ä½ è®¡ç®—å¹¶è¿”å›ä½¿æ‰€æœ‰è®¡ç®—æœºéƒ½è¿é€šæ‰€éœ€çš„æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚å¦‚æœä¸å¯èƒ½ï¼Œåˆ™è¿”å› -1 ç¤ºä¾‹ 1 è¾“å…¥ï¼šn = 4, connections = [[0,1],[0,2],[1,2]] è¾“å‡ºï¼š1 è§£é‡Šï¼šæ‹”ä¸‹è®¡ç®—æœº 1 å’Œ 2 ä¹‹é—´çš„çº¿ç¼†ï¼Œå¹¶å°†å®ƒæ’åˆ°è®¡ç®—æœº 1 å’Œ 3 ä¸Šã€‚ ç¤ºä¾‹ 2 è¾“å…¥ï¼šn = 6, connections = [[0,1],[0,2],[0,3],[1,2],[1,3]] è¾“å‡ºï¼š2 ç¤ºä¾‹ 3 è¾“å…¥ï¼šn = 6, connections = [[0,1],[0,2],[0,3],[1,2]] è¾“å‡ºï¼š-1 è§£é‡Šï¼šçº¿ç¼†æ•°é‡ä¸è¶³ã€‚ ç¤ºä¾‹ 4 è¾“å…¥ï¼šn = 5, connections = [[0,1],[0,2],[3,4],[2,3]] è¾“å‡ºï¼š0 æç¤º 1 \u003c= n \u003c= 10^5 1 \u003c= connections.length \u003c= min(n*(n-1)/2, 10^5) connections[i].length == 2 0 \u003c= connections[i][0], connections[i][1] \u003c n connections[i][0] != connections[i][1] æ²¡æœ‰é‡å¤çš„è¿æ¥ã€‚ ä¸¤å°è®¡ç®—æœºä¸ä¼šé€šè¿‡å¤šæ¡çº¿ç¼†è¿æ¥ã€‚ class Solution { public int makeConnected(int n, int[][] connections) { int len = connections.length; if(len+1 \u003c n) return -1; DSU dsu = new DSU(n); for(int i=0;i\u003clen;i++) { dsu.join(connections[i][0], connections[i][1]); } // dsu.print(); int ans = 0; for(int i=0;i\u003cn;i++) { if(i == dsu.find(i)) ans++; } // System.out.println(\"ans: \"+ans); return ans-1; } } ","date":"2020-02-07","objectID":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/:3:4","tags":["å¹¶æŸ¥é›†"],"title":"å¹¶æŸ¥é›†ç®—æ³•æ¦‚å¿µåŠå®ç°","uri":"/myblog/%E5%B9%B6%E6%9F%A5%E9%9B%86%E7%AE%97%E6%B3%95%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%9E%E7%8E%B0/"},{"categories":["web"],"content":"è®°å½•ä¸‰å°æ—¶æ­å»ºownCloudäº‘ç›˜å…¨è¿‡ç¨‹ğŸ†’ è¯ä¸å¤šè¯´, å…ˆæ”¾ä¸€å¼ æˆåŠŸçš„ç™»å½•ç•Œé¢å›¾ğŸ‘Œ ","date":"2020-01-29","objectID":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/:0:0","tags":["owncloud","äº‘ç›˜"],"title":"ownCloud+mysql+dockeræ­å»ºä¸ªäººäº‘ç›˜","uri":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/"},{"categories":["web"],"content":"step 1: é€‰æ‹©ä¸€ä¸ªé€‚åˆçš„å¼€æºäº‘ç›˜ è¿™é‡Œæœ‰å¾ˆå¤šé€‰æ‹© æ¯”å¦‚è€ç‰ŒåŠ²æ—…ownCloud, åˆ†è£‚ç»§ä»»è€…nextCloudæˆ–è€…æ˜¯å›½äº§æ‹›ç‰ŒseaFile, éƒ½åœ¨å¼€æºäº‘ç›˜å¸‚åœºä¸Šå æœ‰ä¸€å¸­ä¹‹åœ° è¿™é‡Œæˆ‘ä¸»è¦å‚è€ƒäº†v2exè¿˜æœ‰çŸ¥ä¹ç½‘å‹çš„ä¸€äº›è¯„è®º, ç»“åˆæˆ‘è‡ªèº«çš„è®¾å¤‡æƒ…å†µå’Œç»´æŠ¤ä»£ä»·é€‰æ‹©äº†ownCloud ä¸¤ä¸ªå­—â€”â€”çœå¿ƒ! ","date":"2020-01-29","objectID":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/:1:0","tags":["owncloud","äº‘ç›˜"],"title":"ownCloud+mysql+dockeræ­å»ºä¸ªäººäº‘ç›˜","uri":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/"},{"categories":["web"],"content":"step 2: é€‰æ‹©å®‰è£…æ–¹å¼ é¦–å…ˆå»çœ‹ä¸€ä¸‹ownCloudçš„å®˜æ–¹æ–‡æ¡£, ä¸»è¦æ˜¯æä¾›äº†ä»¥ä¸‹å‡ ç§å®‰è£…æ–¹å¼: Installation with docker Manual Installation Manual Installationçš„è¯å…¶å®å°±æ˜¯å®Œæ•´èµ°ä¸€éæµç¨‹: Install ownCloudã€Configure WebServerã€Set Relationshipâ€¦ååˆ†éº»çƒ¦ æˆ‘ä¸ªäººä¸€ç›´æ¨å´‡ä½¿ç”¨dockerè¿›è¡Œé¡¹ç›®çš„ç®¡ç†, ä¸€æ–¹é¢dockerä¸­çš„é…ç½®ä¸ä¼šå½±å“åˆ°å®¿ä¸»æœºçš„ç¯å¢ƒé…ç½®, å¦ä¸€æ–¹é¢dockerä¸­è¿è¡Œä¾¿äºç»´æŠ¤ç®¡ç†, è€Œä¸”å› ä¸ºdockerç›¸å½“äºæ¢³ç†äº†ä¸€éæµç¨‹æ‰€ä»¥å¯ä»¥é‡å¤ä½¿ç”¨(å› æ­¤å°±å¯ä»¥ç›´æ¥æ‹¿åˆ«äººçš„dockeré…ç½®å•ç”¨å•¦ğŸ†’) è¿™é‡Œéœ€è¦å¼ºè°ƒçš„ä¸€ç‚¹æ˜¯, ownCloudå®˜æ–¹æä¾›äº†dockeråŒ…å«äº†serverå’Œapache+php, æ‰€ä»¥æˆ‘å°±ä¸èˆè¿‘æ±‚è¿œäº†ç›´æ¥ç”¨å®˜æ–¹çš„docker image (å¦‚æœæœ‰å…¶ä»–éœ€è¦å¯ä»¥å»docker hubæœç´¢å…¶ä»–docker image) ownCloud dockerå…è®¸ä½¿ç”¨å†…éƒ¨è‡ªå¸¦çš„sqlite, ä½†æ˜¯æ¯•ç«Ÿé’ˆå¯¹å°æ–‡ä»¶è¿˜é©¬é©¬è™è™, å¤§æ–‡ä»¶å°±å®ŒçŠŠå­ æ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯éœ€è¦ä¸€ä¸ªmysql/mariadb(å½“ç„¶ç”¨postgresqlä¹Ÿå¯ä»¥), æ—¢ç„¶éœ€è¦ä¸¤ä¸ªdockerè€Œä¸”æœåŠ¡äºåŒä¸€ç›®æ ‡â€”â€”æˆ‘ä»¬çš„ä¸ªäººäº‘ç›˜, æ‰€ä»¥æˆ‘ç›´æ¥é‡‡ç”¨docker-composeçš„æ–¹å¼ version:'2'services:owncloud:image:owncloudlinks:- mysql:mysqlvolumes:- \"/data/db/owncloud:/var/www/html/data\"ports:- \u003cwebport\u003e:80mysql:image:mysqlvolumes:- \"/data/db/mysql:/var/lib/mysql\"ports:- \u003cport\u003e:3306environment:MYSQL_ROOT_PASSWORD:\"\u003cpassword\u003e\"MYSQL_DATABASE:ownCloud ","date":"2020-01-29","objectID":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/:2:0","tags":["owncloud","äº‘ç›˜"],"title":"ownCloud+mysql+dockeræ­å»ºä¸ªäººäº‘ç›˜","uri":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/"},{"categories":["web"],"content":"step 3: é…ç½®Nginx æˆ‘çš„é˜¿é‡Œäº‘æœºå™¨æ‰€æœ‰é¡¹ç›®éƒ½è·‘åœ¨å„è‡ªçš„dockerä¸Š, ç„¶åå¯¹å¤–ç«¯å£æœ‰å®¿ä¸»æœºçš„NginxåŒä¸€æ˜ å°„ç®¡ç†, æ‰€ä»¥æˆ‘åœ¨/etc/nginx/conf.dç›®å½•ä¸‹æ–°å»ºäº†ä¸€ä¸ªé’ˆå¯¹ownCloudçš„ä»£ç†è½¬å‘conf: server { listen 80; server_name cloud.joyinn.top; proxy_set_header X-Forwarded-For $remote_addr; location / { proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; add_header Cache-Control \"no-cache\"; proxy_pass http://127.0.0.1:8001; limit_rate 256m; client_max_body_size 0; } } è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸¤ç‚¹, ä¸€ä¸ªæ˜¯äºŒçº§åŸŸåè®°å¾—å»åŸŸåè§£æé‚£é‡Œé…ç½®å¥½, å¦ä¸€ä¸ªæ˜¯æ³¨æ„è¦å–æ¶ˆNginxçš„å¸¦å®½å¤§å°é™åˆ¶, å¦åˆ™ownCloudç¨å¾®å¤§ä¸€ç‚¹çš„æ–‡ä»¶å°±æ²¡æœ‰åŠæ³•ä¸Šä¼ æˆåŠŸäº† ","date":"2020-01-29","objectID":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/:3:0","tags":["owncloud","äº‘ç›˜"],"title":"ownCloud+mysql+dockeræ­å»ºä¸ªäººäº‘ç›˜","uri":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/"},{"categories":["web"],"content":"step 4: é…ç½®ownCloud è¿›å…¥é…ç½®å¥½çš„webServerç½‘å€, ç¬¬ä¸€æ¬¡è®¿é—®ä¼šéœ€è¦å¡«å†™ownCloudçš„åŸºæœ¬é…ç½®, åŒ…æ‹¬ç®¡ç†å‘˜è´¦æˆ·åå’Œå¯†ç , ä»¥åŠæ•°æ®åº“çš„ç›¸å…³é…ç½® è¿™é‡Œåªéœ€è¦å¯¹ç…§åœ¨docker-compose.ymlæ–‡ä»¶é‡Œé…ç½®çš„ä¿¡æ¯å¡«å†™å³å¯, localhostè¿™ä¸€é¡¹åº”è¯¥å¡«å†™mysql ","date":"2020-01-29","objectID":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/:4:0","tags":["owncloud","äº‘ç›˜"],"title":"ownCloud+mysql+dockeræ­å»ºä¸ªäººäº‘ç›˜","uri":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/"},{"categories":["web"],"content":"step 5: phpç‰ˆæœ¬è¿‡ä½ ä¸ mysql8 çš„å…¼å®¹æ€§é—®é¢˜ è¿™é‡Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªå¤§å‘, èŠ±äº†å¾ˆå¤šæ—¶é—´æ‰è§£å†³: â€œError while trying to create admin user: Failed to connect to the database: An exception occured in driver: SQLSTATE[HY000] [2054] The server requested authentication method unknown to the client \" æœç´¢äº†è°·æ­Œ, çœ‹äº†è®¸å¤šå¸–å­æœ‰äº†ç‚¹å¤´ç»ª é‡åˆ°çš„é—®é¢˜å°±æ˜¯ownCloud dockerä¸­çš„webç›®å‰ä½¿ç”¨çš„phpç‰ˆæœ¬æ¯”è¾ƒä½, è¿˜æ²¡æœ‰å…¼å®¹mysql8.0ä»¥ä¸Šçš„å…¨éƒ¨ç‰¹æ€§, æ¯”å¦‚mysql8.0ä»¥ä¸Šä½¿ç”¨çš„ç”¨æˆ·å¯†ç æœºåˆ¶ä¸åŒäºåŸæ¥, å› æ­¤å¯¼è‡´è¿™é‡Œè®¿é—®çš„é”™è¯¯ æ‘¸ç´¢äº†ä»¥ä¸‹, å¾—åˆ°ä»¥ä¸‹çš„è§£å†³æ–¹æ¡ˆ: è¿›å…¥åˆ°mysqlçš„containerä¸­, å¢åŠ  my.cnf ä¸­ä¸€å¥é…ç½®: default_authentication_plugin=mysql_native_password è¿›å…¥mysql, æ‰§è¡Œä»¥ä¸‹å‘½ä»¤: ALTER USER â€˜rootâ€™@'%' IDENTIFIED WITH mysql_native_password BY â€˜passwordâ€™; é‡å¯mysqlçš„container ","date":"2020-01-29","objectID":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/:5:0","tags":["owncloud","äº‘ç›˜"],"title":"ownCloud+mysql+dockeræ­å»ºä¸ªäººäº‘ç›˜","uri":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/"},{"categories":["web"],"content":"step 6: æ„‰å¿«çš„ç©è€ownCloudå§ ","date":"2020-01-29","objectID":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/:6:0","tags":["owncloud","äº‘ç›˜"],"title":"ownCloud+mysql+dockeræ­å»ºä¸ªäººäº‘ç›˜","uri":"/myblog/owncloud-mysql-docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E4%BA%91%E7%9B%98/"},{"categories":["ç®—æ³•"],"content":"actoræ¦‚å¿µ Actoræ¨¡å‹æ˜¯å¤„ç†å¹¶è¡Œè®¡ç®—çš„æ¦‚å¿µæ¨¡å‹ã€‚æ¨¡å‹ä¸­ä¸€ä¸ªActoræ˜¯ä¸€ä¸ªåŸºæœ¬çš„è®¡ç®—å•å…ƒã€‚å®ƒæ¥å—æ¶ˆæ¯ç„¶ååŸºäºæ¥åˆ°çš„æ¶ˆæ¯åšä¸€äº›è®¡ç®—ã€‚å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹æœ‰äº›ç±»ä¼¼ï¼Œä¸€ä¸ªå¯¹è±¡è¢«è°ƒç”¨ï¼ˆæ¥æ”¶åˆ°ä¸€ä¸ªæ¶ˆæ¯ï¼‰ï¼ŒåŸºäºè°ƒç”¨æ–¹æ³•ï¼ˆæ¥å—åˆ°çš„ä¸€ä¸ªæ¶ˆæ¯ï¼‰åšå¤„ç†ã€‚åŒºåˆ«æ˜¯actorä¹‹é—´æ˜¯å®Œå…¨éš”ç¦»çš„ï¼Œä¸å…±ç”¨å†…å­˜åŒºåŸŸã€‚actorçš„ç§æœ‰çŠ¶æ€ä¸ä¼šè¢«å¦å¤–ä¸€ä¸ªactorç›´æ¥æ”¹å˜ã€‚ åœ¨actoræ¨¡å‹ä¸­ï¼Œactoræ˜¯å”¯ä¸€ç»„æˆéƒ¨åˆ†ï¼Œactorå¸¦æœ‰åœ°å€ä»¥ä¾¿äº’ç›¸å‘é€æ¶ˆæ¯ã€‚ actoræŒ‰æ¬¡åºå¤„ç†æ¶ˆæ¯ï¼Œæ¯”å¦‚ä½ å‘é€ä¸‰ä¸ªæ¶ˆæ¯ç»™ä¸€ä¸ªactorï¼Œå®ƒä»¬ä¸ä¼šè¢«å¹¶å‘å¤„ç†ã€‚å¦‚æœä½ æƒ³è®©è¿™ä¸‰ä¸ªæ¶ˆæ¯å¾—åˆ°å¹¶å‘å¤„ç†ï¼Œä½ éœ€è¦åˆ›å»º3ä¸ªactorï¼Œç„¶ååˆ†åˆ«å‘é€ç»™å®ƒä»¬ã€‚æ¥å—åˆ°çš„å¼‚æ­¥æ¶ˆæ¯å­˜åœ¨äºactorå†…éƒ¨çš„ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒå½¢è±¡åŒ–çš„å«åšé‚®ç®±ã€‚ ç®€å•æ¥è¯´ï¼ŒActoré€šè¿‡æ¶ˆæ¯ä¼ é€’çš„æ–¹å¼ä¸å¤–ç•Œé€šä¿¡ï¼Œè€Œä¸”æ¶ˆæ¯ä¼ é€’æ˜¯å¼‚æ­¥çš„ã€‚æ¯ä¸ªActoréƒ½æœ‰ä¸€ä¸ªé‚®ç®±ï¼Œé‚®ç®±æ¥æ”¶å¹¶ç¼“å­˜å…¶ä»–Actorå‘è¿‡æ¥çš„æ¶ˆæ¯ï¼Œé€šè¿‡é‚®ç®±é˜Ÿåˆ—mail queueæ¥å¤„ç†æ¶ˆæ¯ã€‚Actorä¸€æ¬¡åªèƒ½åŒæ­¥å¤„ç†ä¸€ä¸ªæ¶ˆæ¯ï¼Œå¤„ç†æ¶ˆæ¯è¿‡ç¨‹ä¸­ï¼Œé™¤äº†å¯ä»¥æ¥æ”¶æ¶ˆæ¯å¤–ä¸èƒ½åšä»»ä½•å…¶ä»–æ“ä½œã€‚ æ¯ä¸ªActoræ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œä»–ä»¬çš„æ“ä½œã€‚æ¯ä¸ªActoræ˜¯ä¸€ä¸ªè®¡ç®—å®ä½“ï¼Œæ˜ å°„æ¥æ”¶åˆ°çš„æ¶ˆæ¯å¹¶æ‰§è¡Œä»¥ä¸‹åŠ¨ä½œï¼š å‘é€æœ‰é™ä¸ªæ¶ˆæ¯ç»™å…¶ä»–Actor åˆ›å»ºæœ‰é™ä¸ªæ–°çš„Actor ä¸ºä¸‹ä¸€ä¸ªæ¥æ”¶çš„æ¶ˆæ¯æŒ‡å®šè¡Œä¸º è¿™ä¸‰ä¸ªåŠ¨ä½œæ²¡æœ‰å›ºå®šçš„é¡ºåºï¼Œå¯ä»¥å¹¶å‘åœ°æ‰§è¡Œï¼ŒActorä¼šæ ¹æ®æ¥æ”¶åˆ°çš„æ¶ˆæ¯è¿›è¡Œä¸åŒçš„å¤„ç†ã€‚ ","date":"2019-12-22","objectID":"/myblog/actor%E6%A8%A1%E5%9E%8B/:1:0","tags":["actor","å¹¶è¡Œ"],"title":"Actoræ¨¡å‹","uri":"/myblog/actor%E6%A8%A1%E5%9E%8B/"},{"categories":["ç®—æ³•"],"content":"è¿›ç¨‹é—´é€šä¿¡ æŠŠé€šä¿¡çš„çº¿ç¨‹å¯ä»¥æƒ³è±¡æˆä¸¤ä¸ªæ— æ³•ç›´æ¥è¯´è¯è€Œå¿…é¡»é€šè¿‡é‚®ä»¶äº¤æµçš„äººï¼ŒåŒæ–¹è¦äº¤æµå°±è¦å‘é€é‚®ä»¶ã€‚å‘é€æ–¹é‚®ä»¶ä¸€æ—¦å‘å‡ºå°±ä¸èƒ½ä¿®æ”¹ä»»ä½•å†…å®¹ï¼Œè€Œä¸”æ˜¯æ²¡æœ‰åŠæ³•æ”¶å›ä¿®æ”¹åå†å‘çš„ï¼Œè¿™ä¹Ÿå°±æ˜¯æ¶ˆæ¯ä¸€æ—¦å‘å‡ºå°±ä¸å¯æ”¹å˜ã€‚å¯¹äºæ¥æ”¶æ–¹è€Œè¨€ï¼Œæƒ³ä»€ä¹ˆæ—¶å€™çœ‹é‚®ä»¶å°±ä»€ä¹ˆæ—¶å€™çœ‹ï¼Œè€Œä¸”ä¸éœ€è¦ç›‘å¬ï¼Œè¿™å°±å«å¼‚æ­¥ã€‚æ¥æ”¶æ–¹çœ‹äº†å‘é€æ–¹çš„é‚®ä»¶å¯ä»¥å›å¤ä¹Ÿå¯ä»¥æ’’éƒ½ä¸åšã€‚åªæ˜¯å›å¤é‚®ä»¶ä¸€æ—¦å‘å‡ºä¹ŸåŒæ ·æ˜¯ä¸èƒ½æ”¶å›ä¿®æ”¹çš„ï¼Œä¹Ÿå°±æ˜¯ä¸å¯å˜æ€§ä¸¤ç«¯éƒ½æ˜¯ä¸€æ ·çš„ã€‚åŒæ ·ï¼Œå‘é€æ–¹é’ˆå¯¹å›å¤é‚®ä»¶ï¼Œä¹Ÿæ˜¯æƒ³ä»€ä¹ˆæ—¶å€™çœ‹å°±ä»€ä¹ˆæ—¶å€™çœ‹ã€‚ä¸¤ç«¯åŒæ ·éƒ½æ˜¯å¼‚æ­¥çš„ã€‚è¿™ç§é€šä¿¡æ¨¡å‹å°±æ˜¯Actoræƒ³è¦çš„æ¨¡å‹ï¼Œå¯ä»¥å‘ç°è¿™ç§é€šä¿¡æ–¹å¼å…¶å®ä¾èµ–ä¸€å¥—é‚®ä»¶ç³»ç»Ÿæˆ–å«åšæ¶ˆæ¯ç®¡ç†ç³»ç»Ÿã€‚è¿›ç¨‹å†…éƒ¨è¦æœ‰ä¸€å¥—è¿™æ ·çš„ç³»ç»Ÿï¼Œç»™æ¯ä¸ªçº¿ç¨‹ä¸€ä¸ªç‹¬ç«‹çš„æ”¶å‘æ¶ˆæ¯çš„ç®¡é“ï¼Œå¹¶ä¸”éƒ½æ˜¯å¼‚æ­¥çš„ã€‚ ","date":"2019-12-22","objectID":"/myblog/actor%E6%A8%A1%E5%9E%8B/:2:0","tags":["actor","å¹¶è¡Œ"],"title":"Actoræ¨¡å‹","uri":"/myblog/actor%E6%A8%A1%E5%9E%8B/"},{"categories":["ç®—æ³•"],"content":"å¹¶å‘æ€§ å¹¶å‘å¯¼è‡´æœ€å¤§çš„é—®é¢˜æ˜¯å¯¹å…±äº«æ•°æ®çš„æ“ä½œï¼Œé¢å¯¹å¹¶å‘é—®é¢˜æ—¶å¤šé‡‡ç”¨é”å»ä¿è¯å…±äº«æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä½†åŒæ ·ä¹Ÿä¼šå¸¦æ¥ä¸€ç³»åˆ—çš„å‰¯ä½œç”¨ï¼Œæ¯”å¦‚è¦å»è€ƒè™‘é”çš„ç²’åº¦ï¼ˆå¯¹æ–¹æ³•ã€ç¨‹åºå—ç­‰ï¼‰ã€é”çš„å½¢å¼ï¼ˆè¯»é”ã€å†™é”ç­‰ï¼‰ç­‰é—®é¢˜ã€‚ ä¼ ç»Ÿçš„å¹¶å‘ç¼–ç¨‹çš„æ–¹å¼å¤§å¤šä½¿ç”¨é”æœºåˆ¶ï¼Œç›¸ä¿¡å¤§å¤šæ•°éƒ½æ˜¯æ‚²è§‚é”ï¼Œè¿™å‡ ä¹å¯ä»¥æ–­å®šä¼šå‡ºç°ä¸¤ä¸ªéå¸¸æ˜æ˜¾çš„é—®é¢˜ï¼šéšç€é¡¹ç›®ä½“é‡å¢å¤§ï¼Œä¸šåŠ¡æ„ˆåŠ å¤æ‚ï¼Œä¸å¯é¿å…åœ°ä¼šå¤§é‡çš„ä½¿ç”¨é”ï¼Œç„¶è€Œé”çš„æœºåˆ¶å…¶å®æ˜¯å¾ˆä½æ•ˆçš„ã€‚å³ä½¿å¤§é‡ä¾èµ–é”è§£å†³äº†é¡¹ç›®ä¸­èµ„æºç«äº‰çš„æƒ…å†µï¼Œä½†ç”±äºæ²¡æœ‰ä¸€ä¸ªè§„èŒƒçš„ç¼–ç¨‹æ¨¡å¼ï¼Œæœ€åç³»ç»Ÿçš„ç¨³å®šæ€§è‚¯å®šä¼šå‡ºé—®é¢˜ï¼Œæœ€æ ¹æœ¬çš„åŸå› æ˜¯æ²¡æœ‰æŠŠç³»ç»Ÿçš„ä»»åŠ¡è°ƒåº¦æŠ½è±¡å‡ºæ¥ï¼Œç”±äºä»»åŠ¡è°ƒåº¦å’Œä¸šåŠ¡é€»è¾‘è€¦åˆåœ¨ä¸€èµ·ï¼Œå¾ˆéš¾åšä¸€ä¸ªå¾ˆé«˜å±‚çš„æŠ½è±¡ä»¥ä¿è¯ä»»åŠ¡è°ƒåº¦æœ‰åºæ€§ã€‚ Actoræ¨¡å‹ä¸ºå¹¶å‘è€Œç”Ÿï¼Œæ˜¯ä¸ºè§£å†³é«˜å¹¶å‘çš„ä¸€ç§ç¼–ç¨‹æ€è·¯ã€‚ä½¿ç”¨å¹¶å‘ç¼–ç¨‹æ—¶éœ€è¦ç‰¹åˆ«å…³æ³¨é”ä¸å†…å­˜åŸå­æ€§ç­‰ä¸€ç³»åˆ—çš„çº¿ç¨‹é—®é¢˜ï¼ŒActoræ¨¡å‹å†…éƒ¨çš„çŠ¶æ€ç”±è‡ªèº«ç»´æŠ¤ï¼Œä¹Ÿå°±æ˜¯è¯´Actorå†…éƒ¨æ•°æ®åªèƒ½ç”±å®ƒè‡ªå·±é€šè¿‡æ¶ˆæ¯ä¼ é€’æ¥è¿›è¡ŒçŠ¶æ€ä¿®æ”¹ï¼Œæ‰€ä»¥ä½¿ç”¨Actoræ¨¡å‹å¯ä»¥å¾ˆå¥½åœ°é¿å…è¿™äº›é—®é¢˜ã€‚ ","date":"2019-12-22","objectID":"/myblog/actor%E6%A8%A1%E5%9E%8B/:3:0","tags":["actor","å¹¶è¡Œ"],"title":"Actoræ¨¡å‹","uri":"/myblog/actor%E6%A8%A1%E5%9E%8B/"},{"categories":["ç®—æ³•"],"content":"å®ä¾‹-ä¹°ç¥¨åœºæ™¯ å°†è®¡æ•°å™¨åœºæ™¯ä¸­åŸºäºçº¿ç¨‹çš„å®ç°æ›¿æ¢ä¸ºActorï¼Œå½“ç„¶Actorä¹Ÿè¦åœ¨çº¿ç¨‹ä¸­è¿è¡Œï¼Œä½†Actoråªåœ¨æœ‰äº‹æƒ…å¯åšï¼ˆæ²¡æœ‰æ¶ˆæ¯è¦å¤„ç†ï¼‰çš„æ—¶å€™æ‰ä¼šä½¿ç”¨çº¿ç¨‹ã€‚ åœ¨è®¡æ•°å™¨åœºæ™¯ä¸­ï¼Œè¯·æ±‚è€…ä»£è¡¨CutomerActorï¼Œè®¡æ•°å™¨æ•°é‡ç”±TicketsActoræ¥ç»´æŠ¤å¹¶æŒæœ‰å½“å‰è®¡æ•°å™¨çš„çŠ¶æ€ã€‚CustomerActorå’ŒTicketsActoråœ¨ç©ºé—²idleæˆ–æ²¡æœ‰äº‹æƒ…åšçš„æ—¶å€™éƒ½ä¸ä¼šæŒæœ‰çº¿ç¨‹ã€‚ åœ¨åˆå§‹è´­ä¹°æ“ä½œæ—¶CustomerActoréœ€è¦å‘é€ä¸€ä¸ªæ¶ˆæ¯ç»™TicketsActorï¼Œæ¶ˆæ¯ä¸­åŒ…å«äº†è¦è´­ä¹°çš„æ•°é‡ã€‚å½“TicketsActoræ¥æ”¶åˆ°æ¶ˆæ¯æ—¶ä¼šæ ¡éªŒè´­ä¹°æ•°é‡æ˜¯å¦è¶…è¿‡åº“å­˜æ•°é‡ï¼Œè‹¥åˆæ³•åˆ™é€’å‡æ•°é‡ã€‚æ­¤æ—¶TicketsActorä¼šå‘é€ä¸€æ¡æ¶ˆæ¯ç»™CutomerActorè¡¨æ˜è®¢å•è¢«æˆåŠŸæ¥å—ã€‚è‹¥è´­ä¹°æ•°é‡è¶…è¿‡åº“å­˜æ•°é‡TicketsActorä¹Ÿä¼šå‘é€ç»™CustomerActorä¸€æ¡æ¶ˆæ¯ï¼Œè¡¨æ˜è®¢å•è¢«æ‹’ç»ã€‚ å¯åˆ’åˆ†ä¸¤ä¸ªé˜¶æ®µçš„è¡Œä¸ºæ£€æŸ¥å’Œé€’å‡æ“ä½œï¼Œä¹Ÿå¯ä»¥é€šè¿‡åŒæ­¥æ“ä½œåºåˆ—æ¥å®Œæˆã€‚ä½†æ˜¯åŸºäºActorçš„å®ç°ä¸ä»…åœ¨æ¯ä¸ªActorä¸­æä¾›äº†è‡ªç„¶çš„æ“ä½œåŒæ­¥ï¼Œè¿˜èƒ½é¿å…å¤§é‡çš„çº¿ç¨‹ç§¯å‹ï¼Œé˜²æ­¢çº¿ç¨‹ç­‰å¾…è½®åˆ°å®ƒä»¬æ‰§è¡ŒåŒæ­¥ä»£ç åŒºåŸŸã€‚æ˜æ˜¾ä¼šé™ä½ç³»ç»Ÿèµ„æºçš„å ç”¨ã€‚ Actoræ¨¡å‹æœ¬èº«ç¡®ä¿å¤„ç†æ˜¯æŒ‰ç…§åŒæ­¥çš„æ–¹å¼æ‰§è¡Œçš„ã€‚TicketsActorä¼šå¤„ç†å…¶æ”¶ä»¶ç®±ä¸­çš„æ¯æ¡æ¶ˆæ¯ï¼Œæ³¨æ„è¿™é‡Œæ²¡æœ‰å¤æ‚çš„çº¿ç¨‹æˆ–é”ï¼Œåªæ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹çš„å¤„ç†è¿‡ç¨‹ï¼Œä½†Actorç³»ç»Ÿä¼šç®¡ç†çº¿ç¨‹çš„ä½¿ç”¨å’Œåˆ†é…ã€‚ ","date":"2019-12-22","objectID":"/myblog/actor%E6%A8%A1%E5%9E%8B/:4:0","tags":["actor","å¹¶è¡Œ"],"title":"Actoræ¨¡å‹","uri":"/myblog/actor%E6%A8%A1%E5%9E%8B/"},{"categories":["ç®—æ³•"],"content":"å®ä¾‹-å¯»æ‰¾ç´ æ•° ","date":"2019-12-22","objectID":"/myblog/actor%E6%A8%A1%E5%9E%8B/:5:0","tags":["actor","å¹¶è¡Œ"],"title":"Actoræ¨¡å‹","uri":"/myblog/actor%E6%A8%A1%E5%9E%8B/"},{"categories":["ç®—æ³•"],"content":"ä¼ ç»Ÿé”æ–¹å¼ ","date":"2019-12-22","objectID":"/myblog/actor%E6%A8%A1%E5%9E%8B/:5:1","tags":["actor","å¹¶è¡Œ"],"title":"Actoræ¨¡å‹","uri":"/myblog/actor%E6%A8%A1%E5%9E%8B/"},{"categories":["ç®—æ³•"],"content":"Actoræ–¹å¼ ","date":"2019-12-22","objectID":"/myblog/actor%E6%A8%A1%E5%9E%8B/:5:2","tags":["actor","å¹¶è¡Œ"],"title":"Actoræ¨¡å‹","uri":"/myblog/actor%E6%A8%A1%E5%9E%8B/"},{"categories":["ç®—æ³•"],"content":"å¦å¤– é‚®ç®±ä¸­çš„æ¶ˆæ¯æ ¹æ®åˆ†ç±»å¯ä»¥è®¾ç½®å¤„ç†çš„ä¼˜å…ˆçº§ ","date":"2019-12-22","objectID":"/myblog/actor%E6%A8%A1%E5%9E%8B/:6:0","tags":["actor","å¹¶è¡Œ"],"title":"Actoræ¨¡å‹","uri":"/myblog/actor%E6%A8%A1%E5%9E%8B/"},{"categories":["web"],"content":"jwtç®¡ç†ç”¨æˆ·ç™»å½•æ€ â€”â€” ä»¥expressjså’Œvuejsçš„å‰åç«¯åˆ†ç¦»è®ºå›é¡¹ç›®ä½œä¸ºå®ä¾‹ ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:0:0","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"session å¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼ŒWebåŸºæœ¬ä¸Šå°±æ˜¯æ–‡æ¡£çš„æµè§ˆè€Œå·² æ—¢ç„¶æ˜¯æµè§ˆï¼Œä½œä¸ºæœåŠ¡å™¨ï¼Œä¸éœ€è¦è®°å½•è°åœ¨æŸä¸€æ®µæ—¶é—´é‡Œéƒ½æµè§ˆäº†ä»€ä¹ˆæ–‡æ¡£ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½æ˜¯ä¸€ä¸ªæ–°çš„HTTPåè®®ï¼Œå°±æ˜¯è¯·æ±‚åŠ å“åº” å°¤å…¶æ˜¯æˆ‘ä¸ç”¨è®°ä½æ˜¯è°åˆšåˆšå‘äº†HTTPè¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚å¯¹æˆ‘æ¥è¯´éƒ½æ˜¯å…¨æ–°çš„ã€‚è¿™æ®µæ—¶é—´å¾ˆå—¨çš® ä½†æ˜¯éšç€äº¤äº’å¼Webåº”ç”¨çš„å…´èµ·ï¼Œåƒåœ¨çº¿è´­ç‰©ç½‘ç«™ï¼Œéœ€è¦ç™»å½•çš„ç½‘ç«™ç­‰ç­‰ï¼Œé©¬ä¸Šå°±é¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯è¦ç®¡ç†ä¼šè¯ï¼Œå¿…é¡»è®°ä½å“ªäº›äººç™»å½•ç³»ç»Ÿï¼Œå“ªäº›äººå¾€è‡ªå·±çš„è´­ç‰©è½¦ä¸­æ”¾å•†å“ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘å¿…é¡»æŠŠæ¯ä¸ªäººåŒºåˆ†å¼€ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªä¸å°çš„æŒ‘æˆ˜ï¼Œ å› ä¸ºHTTPè¯·æ±‚æ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€ä»¥æƒ³å‡ºçš„åŠæ³•å°±æ˜¯ç»™å¤§å®¶å‘ä¸€ä¸ªä¼šè¯æ ‡è¯†(session id)ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªéšæœºçš„å­—ä¸²ï¼Œæ¯ä¸ªäººæ”¶åˆ°çš„éƒ½ä¸ä¸€æ ·ï¼Œæ¯æ¬¡å¤§å®¶å‘æˆ‘å‘èµ·HTTPè¯·æ±‚çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸ªå­—ç¬¦ä¸²ç»™ä¸€å¹¶æè¿‡æ¥ï¼Œè¿™æ ·æˆ‘å°±èƒ½åŒºåˆ†å¼€è°æ˜¯è°äº† æµç¨‹ ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€ç”¨æˆ·åå’Œå¯†ç ã€‚ æœåŠ¡å™¨éªŒè¯é€šè¿‡åï¼Œåœ¨å½“å‰å¯¹è¯ï¼ˆsessionï¼‰é‡Œé¢ä¿å­˜ç›¸å…³æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·è§’è‰²ç™»å½•æ—¶é—´ç­‰ç­‰ã€‚ æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›ä¸€ä¸ªsession_idï¼Œå†™å…¥ç”¨æˆ·çš„Cookieã€‚ ç”¨æˆ·éšåçš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½ä¼šé€šè¿‡ Cookieï¼Œå°†session_idä¼ å›æœåŠ¡å™¨ã€‚ æœåŠ¡å™¨æ”¶åˆ°session_idï¼Œæ‰¾åˆ°å‰æœŸä¿å­˜çš„æ•°æ®ï¼Œç”±æ­¤å¾—çŸ¥ç”¨æˆ·çš„èº«ä»½ã€‚ è¿™æ ·å¤§å®¶å¾ˆå—¨çš®äº†ï¼Œå¯æ˜¯æœåŠ¡å™¨å°±ä¸å—¨çš®äº†ï¼Œæ¯ä¸ªäººåªéœ€è¦ä¿å­˜è‡ªå·±çš„session idï¼Œè€ŒæœåŠ¡å™¨è¦ä¿å­˜æ‰€æœ‰äººçš„session idï¼å¦‚æœè®¿é—®æœåŠ¡å™¨å¤šäº†ï¼Œå°±å¾—ç”±æˆåƒä¸Šä¸‡ï¼Œç”šè‡³å‡ åä¸‡ä¸ªã€‚ è¿™å¯¹æœåŠ¡å™¨è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„å¼€é”€ï¼Œä¸¥é‡çš„é™åˆ¶äº†æœåŠ¡å™¨æ‰©å±•èƒ½åŠ›ï¼Œæ¯”å¦‚è¯´æˆ‘ç”¨ä¸¤ä¸ªæœºå™¨ç»„æˆäº†ä¸€ä¸ªé›†ç¾¤ï¼Œå°Fé€šè¿‡æœºå™¨Aç™»å½•äº†ç³»ç»Ÿï¼Œé‚£session idä¼šä¿å­˜åœ¨æœºå™¨Aä¸Šï¼Œå‡è®¾å°Fçš„ä¸‹ä¸€æ¬¡è¯·æ±‚è¢«è½¬å‘åˆ°æœºå™¨Bæ€ä¹ˆåŠï¼Ÿ æœºå™¨Bå¯æ²¡æœ‰å°Fçš„session idå•Šã€‚ æœ‰æ—¶å€™ä¼šé‡‡ç”¨ä¸€ç‚¹å°ä¼ä¿©ï¼šsession stickyï¼Œå°±æ˜¯è®©å°Fçš„è¯·æ±‚ä¸€ç›´ç²˜è¿åœ¨æœºå™¨Aä¸Šï¼Œä½†æ˜¯è¿™ä¹Ÿä¸ç®¡ç”¨ï¼Œè¦æ˜¯æœºå™¨AæŒ‚æ‰äº†ï¼Œè¿˜å¾—è½¬åˆ°æœºå™¨Bå»ã€‚ é‚£åªå¥½åšsessionçš„å¤åˆ¶äº†ï¼ŒæŠŠsession idåœ¨ä¸¤ä¸ªæœºå™¨ä¹‹é—´æ¬æ¥æ¬å»ï¼Œå¿«ç´¯æ­»äº†ã€‚ åæ¥æœ‰ä¸ªå«Memcachedçš„æ”¯äº†æ‹›ï¼š æŠŠsession idé›†ä¸­å­˜å‚¨åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œæ‰€æœ‰çš„æœºå™¨éƒ½æ¥è®¿é—®è¿™ä¸ªåœ°æ–¹çš„æ•°æ®ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå°±ä¸ç”¨å¤åˆ¶äº†ï¼Œä½†æ˜¯å¢åŠ äº†å•ç‚¹å¤±è´¥çš„å¯èƒ½æ€§ï¼Œè¦æ˜¯é‚£ä¸ªè´Ÿè´£session çš„æœºå™¨æŒ‚äº†ï¼Œæ‰€æœ‰äººéƒ½å¾—é‡æ–°ç™»å½•ä¸€éï¼Œä¼°è®¡å¾—è¢«äººéª‚æ­» ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:1:0","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"token äºæ˜¯æœ‰äººå°±ä¸€ç›´åœ¨æ€è€ƒï¼Œæˆ‘ä¸ºä»€ä¹ˆè¦ä¿å­˜è¿™å¯æ¶çš„sessionå‘¢ï¼Œåªè®©æ¯ä¸ªå®¢æˆ·ç«¯å»ä¿å­˜è¯¥å¤šå¥½ï¼Ÿ å¯æ˜¯å¦‚æœä¸ä¿å­˜è¿™äº›session idï¼Œæ€ä¹ˆéªŒè¯å®¢æˆ·ç«¯å‘ç»™æˆ‘çš„session idçš„ç¡®æ˜¯æˆ‘ç”Ÿæˆçš„å‘¢ï¼Ÿå¦‚æœä¸å»éªŒè¯ï¼Œæˆ‘ä»¬éƒ½ä¸çŸ¥é“ä»–ä»¬æ˜¯ä¸æ˜¯åˆæ³•ç™»å½•çš„ç”¨æˆ·ï¼Œé‚£äº›ä¸æ€€å¥½æ„çš„å®¶ä¼™ä»¬å°±å¯ä»¥ä¼ªé€ session idï¼Œä¸ºæ‰€æ¬²ä¸ºäº†ã€‚ å—¯ï¼Œå¯¹äº†ï¼Œå…³é”®ç‚¹å°±æ˜¯éªŒè¯ ï¼ æ¯”å¦‚è¯´ï¼Œå°Få·²ç»ç™»å½•äº†ç³»ç»Ÿï¼Œæˆ‘ç»™ä»–å‘ä¸€ä¸ªä»¤ç‰Œ(token)ï¼Œé‡Œè¾¹åŒ…å«äº†å°Fçš„user idï¼Œä¸‹ä¸€æ¬¡å°Få†æ¬¡é€šè¿‡Httpè¯·æ±‚è®¿é—®æˆ‘çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸ªtokené€šè¿‡Http headerå¸¦è¿‡æ¥ä¸å°±å¯ä»¥äº†ã€‚ ä¸è¿‡è¿™å’Œsession idæ²¡æœ‰æœ¬è´¨åŒºåˆ«å•Šï¼Œä»»ä½•äººéƒ½å¯ä»¥å¯ä»¥ä¼ªé€ ï¼Œæ‰€ä»¥æˆ‘å¾—æƒ³ç‚¹å„¿åŠæ³•ï¼Œè®©åˆ«äººä¼ªé€ ä¸äº†ã€‚ é‚£å°±å¯¹æ•°æ®åšä¸€ä¸ªç­¾åå§ï¼Œæ¯”å¦‚è¯´æˆ‘ç”¨SHA256ç®—æ³•ï¼ŒåŠ ä¸Šä¸€ä¸ªåªæœ‰æˆ‘æ‰çŸ¥é“çš„å¯†é’¥ï¼Œå¯¹æ•°æ®åšä¸€ä¸ªç­¾åï¼ŒæŠŠè¿™ä¸ªç­¾åå’Œæ•°æ®ä¸€èµ·ä½œä¸ºtokenï¼Œç”±äºå¯†é’¥åˆ«äººä¸çŸ¥é“ï¼Œå°±æ— æ³•ä¼ªé€ tokenäº†ã€‚ è¿™ä¸ªtoken æˆ‘ä¸ä¿å­˜ï¼Œå½“å°FæŠŠè¿™ä¸ªtoken ç»™æˆ‘å‘è¿‡æ¥çš„æ—¶å€™ï¼Œæˆ‘å†ç”¨åŒæ ·çš„HMAC-SHA256 ç®—æ³•å’ŒåŒæ ·çš„å¯†é’¥ï¼Œå¯¹æ•°æ®å†è®¡ç®—ä¸€æ¬¡ç­¾åï¼Œå’Œtoken ä¸­çš„ç­¾ååšä¸ªæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒï¼Œæˆ‘å°±çŸ¥é“å°Få·²ç»ç™»å½•è¿‡äº†ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥å–åˆ°å°Fçš„user idï¼Œå¦‚æœä¸ç›¸åŒï¼Œæ•°æ®éƒ¨åˆ†è‚¯å®šè¢«äººç¯¡æ”¹è¿‡ï¼Œæˆ‘å°±å‘Šè¯‰å‘é€è€…ï¼šå¯¹ä¸èµ·ï¼Œæ²¡æœ‰è®¤è¯ã€‚ Token ä¸­çš„æ•°æ®æ˜¯æ˜æ–‡ä¿å­˜çš„ï¼ˆè™½ç„¶æˆ‘ä¼šç”¨Base64åšä¸‹ç¼–ç ï¼Œä½†é‚£ä¸æ˜¯åŠ å¯†ï¼‰ï¼Œè¿˜æ˜¯å¯ä»¥è¢«åˆ«äººçœ‹åˆ°çš„ï¼Œæ‰€ä»¥æˆ‘ä¸èƒ½åœ¨å…¶ä¸­ä¿å­˜åƒå¯†ç è¿™æ ·çš„æ•æ„Ÿä¿¡æ¯ã€‚ å½“ç„¶ï¼Œå¦‚æœä¸€ä¸ªäººçš„tokenè¢«åˆ«äººå·èµ°äº†ï¼Œé‚£æˆ‘ä¹Ÿæ²¡åŠæ³•ï¼Œæˆ‘ä¹Ÿä¼šè®¤ä¸ºå°å·å°±æ˜¯åˆæ³•ç”¨æˆ·ï¼Œè¿™å…¶å®å’Œä¸€ä¸ªäººçš„session idè¢«åˆ«äººå·èµ°æ˜¯ä¸€æ ·çš„ã€‚ è¿™æ ·ä¸€æ¥ï¼Œæˆ‘å°±ä¸ä¿å­˜session idäº†ï¼Œæˆ‘åªæ˜¯ç”Ÿæˆtokenï¼Œç„¶åéªŒè¯tokenï¼Œæˆ‘ç”¨æˆ‘çš„CPUè®¡ç®—æ—¶é—´è·å–äº†æˆ‘çš„sessionå­˜å‚¨ç©ºé—´ ï¼ ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:2:0","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"cookie cookie æ˜¯ä¸€ä¸ªéå¸¸å…·ä½“çš„ä¸œè¥¿ï¼ŒæŒ‡çš„å°±æ˜¯æµè§ˆå™¨é‡Œé¢èƒ½æ°¸ä¹…å­˜å‚¨çš„ä¸€ç§æ•°æ®ï¼Œä»…ä»…æ˜¯æµè§ˆå™¨å®ç°çš„ä¸€ç§æ•°æ®å­˜å‚¨åŠŸèƒ½ã€‚ cookieç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œå‘é€ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æŠŠcookieä»¥kvå½¢å¼ä¿å­˜åˆ°æŸä¸ªç›®å½•ä¸‹çš„æ–‡æœ¬æ–‡ä»¶å†…ï¼Œä¸‹ä¸€æ¬¡è¯·æ±‚åŒä¸€ç½‘ç«™æ—¶ä¼šæŠŠè¯¥cookieå‘é€ç»™æœåŠ¡å™¨ã€‚ ç”±äºcookieæ˜¯å­˜åœ¨å®¢æˆ·ç«¯ä¸Šçš„ï¼Œæ‰€ä»¥æµè§ˆå™¨åŠ å…¥äº†ä¸€äº›é™åˆ¶ç¡®ä¿cookieä¸ä¼šè¢«æ¶æ„ä½¿ç”¨ï¼ŒåŒæ—¶ä¸ä¼šå æ®å¤ªå¤šç£ç›˜ç©ºé—´ï¼Œæ‰€ä»¥æ¯ä¸ªåŸŸçš„cookieæ•°é‡æ˜¯æœ‰é™çš„ã€‚ ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:3:0","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"Tokençš„èº«ä»½éªŒè¯ æµç¨‹ ç”¨æˆ·é€šè¿‡ç”¨æˆ·åå’Œå¯†ç å‘é€è¯·æ±‚ã€‚ ç¨‹åºéªŒè¯ã€‚ ç¨‹åºè¿”å›ä¸€ä¸ªç­¾åçš„token ç»™å®¢æˆ·ç«¯ã€‚ å®¢æˆ·ç«¯å‚¨å­˜tokenï¼Œå¹¶ä¸”æ¯æ¬¡ç”¨äºæ¯æ¬¡å‘é€è¯·æ±‚ã€‚ æœåŠ¡ç«¯éªŒè¯tokenå¹¶è¿”å›æ•°æ®ã€‚ ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:4:0","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"JWT JSON Web Tokenï¼ˆç¼©å†™ JWTï¼‰æ˜¯ç›®å‰æœ€æµè¡Œçš„è·¨åŸŸè®¤è¯è§£å†³æ–¹æ¡ˆã€‚ ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:5:0","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"JWTçš„åŸç† JWT çš„åŸç†æ˜¯ï¼ŒæœåŠ¡å™¨è®¤è¯ä»¥åï¼Œç”Ÿæˆä¸€ä¸ª JSON å¯¹è±¡ï¼Œå‘å›ç»™ç”¨æˆ·ã€‚ä»¥åï¼Œç”¨æˆ·ä¸æœåŠ¡ç«¯é€šä¿¡çš„æ—¶å€™ï¼Œéƒ½è¦å‘å›è¿™ä¸ª JSON å¯¹è±¡ã€‚æœåŠ¡å™¨å®Œå…¨åªé è¿™ä¸ªå¯¹è±¡è®¤å®šç”¨æˆ·èº«ä»½ã€‚ä¸ºäº†é˜²æ­¢ç”¨æˆ·ç¯¡æ”¹æ•°æ®ï¼ŒæœåŠ¡å™¨åœ¨ç”Ÿæˆè¿™ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä¼šåŠ ä¸Šç­¾åã€‚ JWT çš„æ•°æ®ç»“æ„ å®ƒæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œä¸­é—´ç”¨ç‚¹ï¼ˆ.ï¼‰åˆ†éš”æˆä¸‰ä¸ªéƒ¨åˆ†ã€‚ JWT çš„ä¸‰ä¸ªéƒ¨åˆ†ä¾æ¬¡å¦‚ä¸‹ã€‚ Header éƒ¨åˆ†æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œæè¿° JWT çš„å…ƒæ•°æ®ï¼Œ Payload éƒ¨åˆ†ä¹Ÿæ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œç”¨æ¥å­˜æ”¾å®é™…éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚JWT è§„å®šäº†7ä¸ªå®˜æ–¹å­—æ®µä¾›é€‰ç”¨ã€‚ Signature éƒ¨åˆ†æ˜¯å¯¹å‰ä¸¤éƒ¨åˆ†çš„ç­¾åï¼Œé˜²æ­¢æ•°æ®ç¯¡æ”¹ã€‚ ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:5:1","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"é¡¹ç›®å®ä¾‹ æˆ‘ä»¬ç°åœ¨çœ‹ä¸‹é¡¹ç›®ä¸­çš„åº”ç”¨å®ä¾‹ ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:6:0","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"ç”Ÿæˆtoken å…ˆæ¥çœ‹çœ‹åç«¯æ˜¯å¦‚ä½•ç”Ÿæˆä¸€ä¸ªtokençš„ router.post(\"/login\", async function(req, res, next) { const { username, password } = req.body; const userinfo_pw = await query(my_user_info_with_password, [username]); const md5_pw = md5(password); if (userinfo_pw.length === 0) { res.json({ code: 4001, msg: \"no such user\" }); } else if (md5_pw === userinfo_pw[0].password) { const token = jwt.sign( { iss: \"joyinn\", aud: username, uid: userinfo_pw[0].uid }, myconfig.jwtSecret, { // æˆæƒæ—¶æ•ˆ1day expiresIn: 60 * 60 * 24 } ); // update last login time await query(update_logintime, [userinfo_pw[0].uid]); // get userinfo const userinfo = await query(my_user_info, [username]); res.json({ code: 0, msg: \"login ok\", token, user: userinfo[0] }); } else { res.json({ code: 4002, msg: \"wrong password\" }); } }); å½“å“åº”login handlerï¼Œæ¯”å¯¹å¯†ç æ­£ç¡®åï¼Œè°ƒç”¨jsonwebtokenä¾èµ–åº“ç”Ÿæˆtoken const jwt = require(\"jsonwebtoken\"); const token = jwt.sign( { iss: \"joyinn\", aud: username, uid: userinfo_pw[0].uid }, myconfig.jwtSecret, { // æˆæƒæ—¶æ•ˆ1day expiresIn: 60 * 60 * 24 } ); è¿™é‡Œjwt.sign(payload, secretOrPrivateKey, [options, callback])ï¼Œå…·ä½“æ–‡æ¡£å¯ä»¥å‚è€ƒjsonwebtoken ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:6:1","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"åˆ¤æ–­tokenæ­£ç¡®æ€§ ä¾æ—§æ˜¯åç«¯ï¼Œæˆ‘ä»¬æ€ä¹ˆåˆ¤æ–­ç”¨æˆ·çš„è¯·æ±‚æºå¸¦çš„ç™»å½•æ€ä¿¡æ¯æ˜¯æ­£ç¡®çš„ æ ¹æ®ä¸Šé¢é™ˆè¿°çš„tokenåŸç†ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨secretå¯¹JWTçš„å‰ä¸¤æ®µåŠ å¯†å¾—åˆ°ç­¾åï¼Œæ¯”å¯¹JWTç»™å‡ºçš„ç­¾åå³å¯ å…·ä½“å®ç°æˆ‘ä»¬å¯ä»¥é‡‡ç”¨express-jwtä¾èµ–åº“ï¼Œä¼šå¯¹headersä¸­çš„Authorizationå­—æ®µçš„tokenè¿›è¡Œæ£€éªŒ // filename: app.js const expressJWT = require(\"express-jwt\"); // ... other code // è®¾ç½®å…è®¸è·¨åŸŸè®¿é—®è¯¥æœåŠ¡. app.use(function(req, res, next) { res.header(\"Access-Control-Allow-Origin\", \"*\"); res.header(\"Access-Control-Allow-Methods\", \"GET,HEAD,OPTIONS,POST,PUT\"); res.header( \"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept, Authorization\" ); next(); }); // jwt auth app.use( expressJWT({ secret: myconfig.jwtSecret }).unless({ path: [ \"/user/login\", \"/user/register\", \"/user/mailtozju\", \"/user/checkvalidcode\" ] //é™¤äº†è¿™ä¸ªåœ°å€ï¼Œå…¶ä»–çš„URLéƒ½éœ€è¦éªŒè¯ }) ); æˆ‘ä»¬è¿™é‡Œå°†jwtéªŒè¯ä¸­é—´ä»¶æ”¾åœ¨urlå“åº”å‡½æ•°ä¹‹å‰ï¼ŒåŒæ—¶é€šè¿‡unlesså‚æ•°è®¾ç½®ä¸éœ€è¦jwtæ£€éªŒçš„apiï¼Œå®ç°äº†ä¸€ä¸ªæ‹¦æˆªå±‚ä¸­é—´ä»¶ ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:6:2","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"è®¿é—®jwtå†…éƒ¨payload ä¸­é—´ä»¶ä¼šå°†éªŒè¯è§£æå¥½çš„æ•°æ®æ”¾åœ¨requesté‡Œé¢ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨handleré‡Œé¢å¯ä»¥é€šè¿‡req.userè®¿é—®åˆ°tokençš„æ‰€æœ‰ä¿¡æ¯ // post one say router.post(\"/\", async (req, res) =\u003e { const { photo, say_text } = req.body; const uid = req.user.uid; console.log(req.user); const photoNum = JSON.parse(photo).length; console.log(\"photoNum\", photoNum); let type; if (photoNum === 0) type = 0; else if (say_text === \"\") type = 1; else type = 2; const insertResult = await query(post_say, [type, say_text, photo, uid, 1]); res.json({ code: 0, msg: \"insert success\", insertId: insertResult.insertId }); }); ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:6:3","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"å‰ç«¯httpé€šä¿¡çš„è®¾ç½® è¿™é‡Œæˆ‘çš„å®ä¾‹é¡¹ç›®æ˜¯vuejsï¼Œhttpé€šä¿¡é‡‡ç”¨äº†axiosï¼Œä½œä¸ºä¸€ä¸ªpluginè¢«è°ƒç”¨ æˆ‘ä»¬ä¸ºäº†å®ç°jwtåŠ è½½ï¼Œéœ€è¦åœ¨å‘é€æ•°æ®åŒ…å’Œæ¥æ”¶æ•°æ®åŒ…çš„æ—¶å€™å‡å¯¹axiosæ¨¡å—æ·»åŠ ä¸€äº›é€»è¾‘ // åœ¨å‘é€ä¹‹å‰æ£€æŸ¥localstorageé‡Œé¢æœ‰æ— tokenå­—æ®µï¼Œå¦‚æœæœ‰å°±å†™å…¥Authorizationå­—æ®µ _axios.interceptors.request.use( function(config) { const my_token = window.localStorage.getItem(\"token\"); if (my_token) { config.headers[\"Authorization\"] = `Bearer ${my_token}`; } return config; }, function(error) { return Promise.reject(error); } ); // åœ¨æ”¶åˆ°ä»¥åæ£€æŸ¥responseä¸­æœ‰æ— tokenå­—æ®µï¼Œå¦‚æœæœ‰å°±å°†tokenå†™å…¥åˆ°localstorageä¸­ // å¦‚æœå“åº”å‘ç”Ÿäº†é”™è¯¯ï¼ˆä¸€èˆ¬æ˜¯ç”±äºåœ¨æœªç™»å½•çŠ¶æ€ä¸‹è®¿é—®apiã€æˆ–è€…tokenæœ‰è¯¯å¯¼è‡´è¢«express-jwtæ‹¦æˆªï¼‰ // é‚£ä¹ˆå°±ç§»é™¤tokenå¹¶ä¸”è·³è½¬åˆ°ç™»å½•é¡µé¢ _axios.interceptors.response.use( function(response) { if (response.data.token) { window.localStorage.setItem(\"token\", response.data.token); } return response; }, function(error) { const errRes = error.response; if (errRes.status === 401) { window.localStorage.removeItem(\"token\"); router.push(\"/login\"); } return Promise.reject(error); } ); æˆ‘å¯¹vueé»˜è®¤çš„axios pluginåšäº†äºŒæ¬¡å°è£…ï¼Œæ·»åŠ äº†ä¼ å…¥è‡ªå®šä¹‰configä»¥åŠtokenæ”¯æŒï¼Œè¯¦ç»†ä»£ç å¯è§gist ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:6:4","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"bonus: è·¯ç”±å®ˆå« æˆ‘ä»¬æœ‰äº†ç”¨æˆ·ç™»å½•æ€ï¼Œå¯¹vueè·¯ç”±å®ˆå«å®è·µèµ·æ¥è‡ªç„¶å°±å®¹æ˜“äº† Vue.use(Router); let router = new Router({ mode: \"history\", base: process.env.BASE_URL, routes: [ { path: \"/\", name: \"home\", component: Home, meta: { requireAuth: true } }, { path: \"/login\", name: \"login\", component: Login, meta: { requireAuth: false } }, // ... more routes ] }); router.beforeEach((to, from, next) =\u003e { const token = localStorage.getItem(\"token\") || null; if (to.matched.some(record =\u003e record.meta.requireAuth)) { if (!Auth.loggedIn(token)) { next(\"/login\"); } else { if (!store.state.user.isLogin) { axios.get(\"/user/getuserinfo\").then(res =\u003e { store.dispatch(\"setUser\", res.data.user); next(); }); } else next(); } } else if (to.path === \"/login\" \u0026\u0026 Auth.loggedIn(token)) { next(\"/\"); } else { next(); } }); export default router; æˆ‘ä»¬å¯¹è·¯ç”±çš„metaå¯¹è±¡åŠ å…¥requireAuthï¼Œè®¾ç½®å¸ƒå°”å€¼è¡¨ç¤ºæ˜¯å¦éœ€è¦è·¯ç”±å®ˆå« æ¥ä¸‹æ¥åœ¨router.beforeEachå‡½æ•°ä¸­å¯¹tokenè¿›è¡Œæ£€éªŒï¼Œå‰©ä½™å¯¹stateæ›´æ–°ä»¥åŠè·¯ç”±è·³è½¬ç­‰é€»è¾‘æˆ‘æƒ³ä¸éœ€è¦å†èµ˜è¿° ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:6:5","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"btw å¦‚æœå¯¹è¿™ä¸€å·¥ç¨‹å®ä¾‹æ„Ÿå…´è¶£çš„è¯å¯ä»¥æŸ¥çœ‹joyinn è¿™æ˜¯ä¸€ä¸ªè®ºå›çš„demoï¼Œé‡‡ç”¨expressjs+mysql+vueå…¨å®¶æ¡¶ï¼Œè¯´ä¸å®šä½ èƒ½æœ‰æ‰€å¯å‘å‘¢ï¼ ","date":"2019-04-13","objectID":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/:6:6","tags":["cookie","session","token"],"title":"åŸºäºJWTçš„ç”¨æˆ·ç™»å½•æ€ç®¡ç†","uri":"/myblog/%E5%9F%BA%E4%BA%8Ejwt%E7%9A%84%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%80%81%E7%AE%A1%E7%90%86/"},{"categories":["web"],"content":"è¿™æ¬¡çš„æ–‡ç« ä¸»é¢˜æ˜¯svgï¼Œé¢„å¤‡çŸ¥è¯†åŸºæœ¬æ˜¯æ²¡æœ‰çš„ æœ‰å‡ ä¸ªåº”ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„bugï¼Œpoå‡ºæ¥ä¾›å¤§å®¶å‚è€ƒé¿å…èµ°åŒæ ·çš„å¼¯è·¯ã€‚ æœ€è¿‘å†™äº†ä¸ªç¤¾å›¢çš„ç§‹çº³æŠ¥åè¡¨ï¼Œåˆšå¥½UIè®¾è®¡äººå‘˜ç»™çš„è®¾è®¡ç¨¿æœ‰svgåˆ‡å›¾ï¼Œä»¥å‰ä»æ¥æ²¡æœ‰æ¥è§¦è¿‡svgï¼Œè¿™æ¬¡æœ‰æ—¶é—´å°±å°è¯•äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰è¿˜ä¸é”™ï¼Œè™½ç„¶å¯¹ä½ç‰ˆæœ¬æµè§ˆå™¨çš„å…¼å®¹æ€§æ˜¯çœŸçš„å·® svgæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯çŸ¢é‡ï¼Œèµ„æºä½“ç§¯å¾ˆå°ï¼Œä½†æ˜¯æ˜¾ç¤ºæ•ˆæœéå¸¸æ£’ï¼Œå¯¹å„ç§å¤§å°å±å¹•çš„é€‚é…æ€§ä¹Ÿæ˜¯æå…¶okï¼Œè€—è´¹çš„ä¸»è¦æ˜¯å³æ—¶çš„è®¡ç®—å’Œæ¸²æŸ“ ç™¾åº¦æˆ–è€…googleä¸€ä¸‹ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°å…³äºsvgçš„æ–‡æ¡£ï¼Œä¹Ÿå¾ˆå®¹æ˜“æ‰¾åˆ°å…³äºsvgåµŒå…¥htmlçš„å‡ ç§æ–¹å¼çš„ä»‹ç» ç›®å‰å…¼å®¹æ€§æœ€å¥½çš„æ˜¯embedï¼Œä¸è¿‡è°ƒæ•´å¤§å°æˆ‘è§‰å¾—éº»çƒ¦ï¼Œæœ€åæˆ‘è¿˜æ˜¯ç›´æ¥ç”¨çš„svgæ ‡ç­¾å½¢å¼åµŒå…¥ç½‘é¡µã€‚ \u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" width=\"100%\" height=\"100%\" viewBox=\"0 0 2000 2300\" \u003e \u003c!-- background --\u003e \u003cimage x=\"0\" y=\"0\" width=\"100%\" xlink:href=\"./static/Rectangle.svg\"\u003e\u003c/image\u003e \u003c!-- moon --\u003e \u003cimage id=\"moon2\" x=\"95%\" y=\"24%\" width=\"11%\" xlink:href=\"./static/Oval Copy 3.svg\"\u003e\u003c/image\u003e \u003cimage id=\"moon1\" x=\"-10%\" y=\"10%\" width=\"16%\" xlink:href=\"./static/Group.svg\"\u003e\u003c/image\u003e \u003cimage id=\"moon3\" x=\"80%\" y=\"63%\" width=\"14%\" xlink:href=\"./static/Oval Copy 3.svg\"\u003e\u003c/image\u003e \u003c!-- cloud --\u003e \u003cimage id=\"cloud1\" x=\"-8%\" y=\"23%\" width=\"16%\" xlink:href=\"./static/cloud1.svg\"\u003e\u003c/image\u003e \u003cimage id=\"cloud2\" x=\"45%\" y=\"-13%\" width=\"45%\" xlink:href=\"./static/cloud2.svg\"\u003e\u003c/image\u003e \u003cimage id=\"cloud3\" x=\"60%\" y=\"-13%\" width=\"35%\" xlink:href=\"./static/cloud3.svg\"\u003e\u003c/image\u003e \u003cimage id=\"cloud4\" x=\"95%\" y=\"35%\" width=\"10%\" xlink:href=\"./static/cloud4.svg\"\u003e\u003c/image\u003e \u003cimage id=\"cloud5\" x=\"30%\" y=\"61%\" width=\"18%\" xlink:href=\"./static/cloud5.svg\"\u003e\u003c/image\u003e \u003c!-- line --\u003e \u003cimage id=\"line\" x=\"0%\" y=\"2%\" width=\"100%\" xlink:href=\"./static/line.svg\"\u003e\u003c/image\u003e \u003c!-- title --\u003e \u003cimage id=\"title\" x=\"30%\" y=\"37%\" width=\"40%\" xlink:href=\"./static/UIslices/PAPIC.png\"\u003e\u003c/image\u003e \u003c!-- word --\u003e \u003ctext id=\"svgtext\" opacity=\"0\" x=\"32.5%\" y=\"48%\" fill=\"white\"\u003eæµ™å¤§å‹¤åˆ›ç§‹å­£çº³æ–°\u003c/text\u003e \u003c!-- word-underline --\u003e \u003cline id=\"textline\" opacity=\"0\" x1=\"25%\" y1=\"41.5%\" x2=\"75%\" y2=\"41.5%\" stroke=\"white\" stroke-width=\"2\"/\u003e \u003c/svg\u003e phpä¸»ä½“é¡µé¢æ’å…¥svgä»¥åŠå…¶å­å…ƒç´ ï¼Œé“¾æ¥cssæ–‡ä»¶è·å–ç›¸åº”å…ƒç´ çš„åŠ¨ç”»ä»£ç  è¿™æ ·å†™åœ¨å½“ä»£å¤§å¤šæ•°æµè§ˆå™¨ä¸Šè¿è¡Œæµç•…ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜(ä¸åŒ…æ‹¬IEç³»åˆ—å’Œedge) ä½†æ˜¯åˆ°äº†å„ç§æœºå‹çš„å…¼å®¹æ€§æµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°ä¸ªåˆ«iosç‰ˆæœ¬çš„å¾®ä¿¡å’Œqqçš„å†…ç½®æµè§ˆå™¨æ— æ³•è¿è¡Œï¼Œæ˜¾ç¤ºä¸ºä¸€ç‰‡ç©ºç™½ å¼ºçƒˆåæ§½è…¾è®¯çš„x5å†…æ ¸çš„æµè§ˆå™¨ï¼ å¼€å§‹ä»¥ä¸ºæ˜¯æµè§ˆå™¨ç‰ˆæœ¬ä½ï¼Œä¸æ”¯æŒsvgã€‚ä¸æ”¯æŒå°±æ˜¾ç¤ºé™æ€å›¾ç‰‡å’¯ï¼ æ‰€ä»¥æˆ‘æ·»åŠ äº†jsä»£ç åœ¨ç½‘é¡µè¿è¡Œå¼€å§‹åˆ¤æ–­æ˜¯å¦æ”¯æŒsvgåŠŸèƒ½ã€‚å¦‚ä¸‹ï¼š \u003cscript type=\"text/javascript\"\u003e $(document).ready(function(){ if (typeof SVGRect !== \"undefined\") { /* If the browser does support SVG. */ console.log(\"support svg!\"); //$(\"embed\").hide(); } else { /* If the browser does not support SVG. */ alert(\"do not support svg!\"); } }); \u003c/script\u003e ä½†æ˜¯æ²¡ç”¨å•Šï¼Œæ‰€æœ‰çš„æœºå­éƒ½å‘Šè¯‰æˆ‘ä»–æ˜¯æ”¯æŒsvgçš„ï¼ŒçœŸæ˜¯æ‰“è‚¿è„¸å……èƒ–å­ã€‚æ°”æ­»ï¼ è¿™é‡Œç»è¿‡äº†æ¼«é•¿çš„æœç´¢ï¼Œbaiduã€bingã€yahooã€googleä¸€ä¸ªä¸ªæœè¿‡å»ï¼Œä¸­é—´å‘ç°äº†ä¸€ä¸ªæä¾›å„ç§æµè§ˆå™¨ç‰ˆæœ¬å¯¹äºå„ç§åŠŸèƒ½çš„å…¼å®¹æ€§çš„ä¿¡æ¯ç½‘ï¼Œæ”¶è—ï¼https://caniuse.com/ ç»è¿‡ä¸æ–­çš„å°è¯•ï¼Œå‘ç°æœ€å¤§çš„é—®é¢˜åœ¨äºsvgçˆ¸çˆ¸ä¸‹é¢çš„imageå­æ ‡ç­¾ï¼Œæ˜¾ç¤ºæœ‰é—®é¢˜ï¼›è€Œå…¶ä»–å»ºç«‹çš„lineã€textæ ‡ç­¾æ¯«æ— é—®é¢˜ï¼Œåªæ˜¯å› ä¸ºé¢œè‰²æ˜¯ç™½è‰²ï¼Œåœ¨èƒŒæ™¯ä¸æ˜¾ç¤ºçš„æƒ…å†µä¸‹çœ‹ä¸å‡ºæ¥ã€‚ æ€ä¹ˆåŠï¼Ÿ ç»§ç»­googleï¼Œä¸æ–­æ”¹æ¢å…³é”®å­—ï¼Œå„ç§å°è¯•ï¼Œæ— æœï¼Œæ”¾å¼ƒï¼Œç¡è§‰ï¼ æœ€ç»ˆè§£å†³è¿™ä¸ªé—®é¢˜çš„æ˜¯jså»åŠ¨æ€æ¸²æŸ“ï¼Œè¿™ä¸ªæ–¹æ³•æˆåŠŸè§£å†³äº†æµè§ˆå™¨çš„å…¼å®¹çš„é—®é¢˜ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¸ç®¡IE9ç‰ˆæœ¬ä»¥ä¸‹çš„ç ´çƒ‚äº†ã€‚ è¿™é‡Œæ¨èä¸¤ä¸ªsvgçš„jsæ¡†æ¶ã€‚åˆ†åˆ«æ˜¯ svg.js å’Œ snap.svgã€‚ æˆ‘æœ€åç”¨çš„æ˜¯svg.jsï¼Œå› ä¸ºæ ¹æ®åˆ«äººçš„åšå®¢å†™åˆ°ï¼ŒåŠŸèƒ½è™½å°‘äº›ï¼Œä½†æ˜¯å…¼å®¹æ€§æ›´åŠ å¥½ã€‚è‡ªç„¶é€‰ä»–äº†ã€‚ æ–‡æ¡£å†™çš„å¾ˆæ˜ç™½ï¼Œè¿™é‡Œå°±ä¸ä½œæ›´å¤šå…³äºè¿™ä¸ªæ¡†æ¶çš„ä»‹ç»äº†ã€‚ç¡®å®æ–¹ä¾¿ï¼Œcss3ä»£ç ä¸ç”¨å†™äº†ï¼Œç½‘é¡µdomæ ‘åªè¦å†™å¥½ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œæ‰€æœ‰çš„æ¸²æŸ“éƒ½é€šè¿‡jsç”Ÿæˆï¼Œæ©å¾ˆreactã€‚ ä¸‹é¢å±•ç¤ºä¸€ä¸‹æˆ‘çš„ç®€å•åŠ¨ç”»æ‰€éœ€çš„jsä»£ç  \u003cscript type=\"text/javascript\"\u003e $(document).ready(function() { var draw = SVG('mysvgbox').size('100%','100%'); var image = draw.image('static/Rectangle.png'); image.attr({x:0,y:0,id:'svgboxbgpic'}); image.size('100%'); $(\"#svgboxbgpic\").css('height','auto') var moon1 = draw.image('static/Group.svg'); moon1.attr({width:'16%',height:'16%',x:'-10%',y:'10%'}); moon1.animate({duration:1500}).move('20%','10%') .animate({duration:300}).move('22%','10%') .animate({duration:300}).move('20%','10%') .animate({duration:300}).move('22%','10%'); var moon2 = draw.image('static/Oval Copy 3.svg'); moon2.attr({width:'11%',height:'11%',x:'95%',y:'24%'}); moon2.animate({duration:3000}).move('65%','24%'); var moon3 = draw.image('static/Oval Copy 3.svg'); moon3.attr({width:'14%',height:'14%',x:'80%',y:'63%'}); var cloud1 = draw.image('static/cloud1.svg'); cloud1.attr({width:'18%',height:'30%',x:'-10%',y:'23%'}); cloud1.animate({duration:1500}).move('-2%','23%') .animate(300).move('-3%','23%') .animate(500).move('-1%','23%'); var cloud2 = draw.image('static/cloud2.svg'); cloud2.attr({width:'45%',height:'27%',x:'45%',y:'-13%'}); cloud2.animate(1500).move('45%','-2%') .animate(300).move('45%','-4%') .animate(500).move('45%','-2%'); var cloud3 = draw.image('static/clo","date":"2018-11-20","objectID":"/myblog/%E4%B8%8Esvg%E5%8A%A8%E7%94%BB%E7%BA%A0%E7%BC%A0%E4%B8%8D%E6%B8%85%E7%9A%84%E4%B8%A4%E5%A4%A9/:0:0","tags":["svg"],"title":"ä¸svgåŠ¨ç”»çº ç¼ ä¸æ¸…çš„ä¸¤å¤©","uri":"/myblog/%E4%B8%8Esvg%E5%8A%A8%E7%94%BB%E7%BA%A0%E7%BC%A0%E4%B8%8D%E6%B8%85%E7%9A%84%E4%B8%A4%E5%A4%A9/"}]