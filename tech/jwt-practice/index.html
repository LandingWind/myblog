<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>基于JWT的用户登录态管理 - Melon</title><meta name="Description" content=""><meta property="og:title" content="基于JWT的用户登录态管理" />
<meta property="og:description" content="jwt管理用户登录态 —— 以expressjs和vuejs的前后端分离论坛项目作为实例 session 很久很久以前，Web基本上就是文档的浏览而已 既然是浏览" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://landingwind.github.io/myblog/tech/jwt-practice/" /><meta property="article:section" content="tech" />
<meta property="article:published_time" content="2019-04-13T19:13:46&#43;08:00" />
<meta property="article:modified_time" content="2019-04-13T19:13:46&#43;08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="基于JWT的用户登录态管理"/>
<meta name="twitter:description" content="jwt管理用户登录态 —— 以expressjs和vuejs的前后端分离论坛项目作为实例 session 很久很久以前，Web基本上就是文档的浏览而已 既然是浏览"/>
<meta name="application-name" content="Melon">
<meta name="apple-mobile-web-app-title" content="Melon"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://landingwind.github.io/myblog/tech/jwt-practice/" /><link rel="prev" href="https://landingwind.github.io/myblog/tech/with-svg/" /><link rel="next" href="https://landingwind.github.io/myblog/tech/actor-model/" /><link rel="stylesheet" href="/myblog/lib/normalize/normalize.min.2e7125082ec8de83a87adc70253c9c23.css" integrity="md5-LnElCC7I3oOoetxwJTycIw=="><link rel="stylesheet" href="/myblog/css/style.min.ac0f5ed27fd6fe5c5b9c11daee3fd2ac.css" integrity="md5-rA9e0n/W/lxbnBHa7j/SrA=="><link rel="stylesheet" href="/myblog/lib/fontawesome-free/all.min.76cb46c10b6c0293433b371bae2414b2.css" integrity="md5-dstGwQtsApNDOzcbriQUsg=="><link rel="stylesheet" href="/myblog/lib/animate/animate.min.bc1a6a99c43f5ccc97d2d350bde13f74.css" integrity="md5-vBpqmcQ/XMyX0tNQveE/dA=="><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "基于JWT的用户登录态管理",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/landingwind.github.io\/myblog\/tech\/jwt-practice\/"
        },"genre": "tech","keywords": "cookie, session, token","wordcount":  3923 ,
        "url": "https:\/\/landingwind.github.io\/myblog\/tech\/jwt-practice\/","datePublished": "2019-04-13T19:13:46+08:00","dateModified": "2019-04-13T19:13:46+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "wkk"
            },"description": ""
    }
    </script></head>
    <body header-desktop="auto" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/myblog/" title="Melon">Melon</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/myblog/myblog/tech"> Tech </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/myblog/" title="Melon">Melon</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/myblog/myblog/tech" title="">Tech</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="page single special"><h1 class="single-title animated pulse faster">基于JWT的用户登录态管理</h1><div class="content" id="content"><p>jwt管理用户登录态 —— 以<code>expressjs</code>和<code>vuejs</code>的前后端分离论坛项目作为实例</p>
<h2 id="session">session</h2>
<p>很久很久以前，Web基本上就是文档的浏览而已</p>
<p>既然是浏览，作为服务器，不需要记录谁在某一段时间里都浏览了什么文档，每次请求都是一个新的HTTP协议，就是请求加响应</p>
<p>尤其是我不用记住是谁刚刚发了HTTP请求，每个请求对我来说都是全新的。这段时间很嗨皮</p>
<p>但是随着交互式Web应用的兴起，像在线购物网站，需要登录的网站等等，马上就面临一个问题，那就是要管理<strong>会话</strong>，必须记住哪些人登录系统，哪些人往自己的购物车中放商品，也就是说我必须把每个人区分开，这就是一个不小的挑战，</p>
<p>因为HTTP请求是无状态的，所以想出的办法就是给大家发一个会话标识(session id)，说白了就是一个随机的字串，每个人收到的都不一样，每次大家向我发起HTTP请求的时候，把这个字符串给一并捎过来，这样我就能区分开谁是谁了</p>
<div class="details admonition digest">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>流程<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ol>
<li>用户向服务器发送用户名和密码。</li>
<li>服务器验证通过后，在当前对话（session）里面保存相关数据，比如用户角色登录时间等等。</li>
<li>服务器向用户返回一个session_id，写入用户的Cookie。</li>
<li>用户随后的每一次请求，都会通过 Cookie，将session_id传回服务器。</li>
<li>服务器收到session_id，找到前期保存的数据，由此得知用户的身份。</li>
</ol>
</div>
        </div>
    </div>
<p>这样大家很嗨皮了，可是服务器就不嗨皮了，每个人只需要保存自己的session id，而服务器要保存所有人的session id！如果访问服务器多了，就得由成千上万，甚至几十万个。</p>
<p>这对服务器说是一个巨大的开销，严重的限制了服务器扩展能力，比如说我用两个机器组成了一个集群，小F通过机器A登录了系统，那session id会保存在机器A上，假设小F的下一次请求被转发到机器B怎么办？  机器B可没有小F的session id啊。</p>
<p>有时候会采用一点小伎俩：session sticky，就是让小F的请求一直粘连在机器A上，但是这也不管用，要是机器A挂掉了，还得转到机器B去。
那只好做session的复制了，把session id在两个机器之间搬来搬去，快累死了。</p>
<a class="lightgallery" href="https://i.loli.net/2020/12/26/hW3uHFvJznL4U1B.png" title="session sticky" data-thumbnail="https://i.loli.net/2020/12/26/hW3uHFvJznL4U1B.png">
        <img
            class="lazyload"
            src="/myblog/svg/loading.min.svg"
            data-src="https://i.loli.net/2020/12/26/hW3uHFvJznL4U1B.png"
            data-srcset="https://i.loli.net/2020/12/26/hW3uHFvJznL4U1B.png, https://i.loli.net/2020/12/26/hW3uHFvJznL4U1B.png 1.5x, https://i.loli.net/2020/12/26/hW3uHFvJznL4U1B.png 2x"
            data-sizes="auto"
            alt="https://i.loli.net/2020/12/26/hW3uHFvJznL4U1B.png" />
    </a>
<p>后来有个叫Memcached的支了招： 把session id集中存储到一个地方，所有的机器都来访问这个地方的数据，这样一来，就不用复制了，但是增加了单点失败的可能性，要是那个负责session 的机器挂了，所有人都得重新登录一遍，估计得被人骂死</p>
<a class="lightgallery" href="https://i.loli.net/2020/12/26/gD29HMsGZdXpBcx.png" title="session集中存放" data-thumbnail="https://i.loli.net/2020/12/26/gD29HMsGZdXpBcx.png">
        <img
            class="lazyload"
            src="/myblog/svg/loading.min.svg"
            data-src="https://i.loli.net/2020/12/26/gD29HMsGZdXpBcx.png"
            data-srcset="https://i.loli.net/2020/12/26/gD29HMsGZdXpBcx.png, https://i.loli.net/2020/12/26/gD29HMsGZdXpBcx.png 1.5x, https://i.loli.net/2020/12/26/gD29HMsGZdXpBcx.png 2x"
            data-sizes="auto"
            alt="https://i.loli.net/2020/12/26/gD29HMsGZdXpBcx.png" />
    </a>
<h2 id="token">token</h2>
<p>于是有人就一直在思考，我为什么要保存这可恶的session呢，只让每个客户端去保存该多好？
可是如果不保存这些session id，怎么验证客户端发给我的session id的确是我生成的呢？如果不去验证，我们都不知道他们是不是合法登录的用户，那些不怀好意的家伙们就可以伪造session id，为所欲为了。
嗯，对了，关键点就是验证 ！</p>
<p>比如说，小F已经登录了系统，我给他发一个令牌(token)，里边包含了小F的user id，下一次小F再次通过Http请求访问我的时候，把这个token通过Http header带过来不就可以了。</p>
<p>不过这和session id没有本质区别啊，任何人都可以可以伪造，所以我得想点儿办法，让别人伪造不了。</p>
<p>那就对数据做一个签名吧，比如说我用SHA256算法，加上一个只有我才知道的密钥，对数据做一个签名，把这个签名和数据一起作为token，由于密钥别人不知道，就无法伪造token了。</p>
<a class="lightgallery" href="https://i.loli.net/2020/12/26/W328XH6pg1QRqMN.png" title="hash加密得到token" data-thumbnail="https://i.loli.net/2020/12/26/W328XH6pg1QRqMN.png">
        <img
            class="lazyload"
            src="/myblog/svg/loading.min.svg"
            data-src="https://i.loli.net/2020/12/26/W328XH6pg1QRqMN.png"
            data-srcset="https://i.loli.net/2020/12/26/W328XH6pg1QRqMN.png, https://i.loli.net/2020/12/26/W328XH6pg1QRqMN.png 1.5x, https://i.loli.net/2020/12/26/W328XH6pg1QRqMN.png 2x"
            data-sizes="auto"
            alt="https://i.loli.net/2020/12/26/W328XH6pg1QRqMN.png" />
    </a>
<p>这个token 我不保存，当小F把这个token 给我发过来的时候，我再用同样的HMAC-SHA256 算法和同样的密钥，对数据再计算一次签名，和token 中的签名做个比较，如果相同，我就知道小F已经登录过了，并且可以直接取到小F的user id，如果不相同，数据部分肯定被人篡改过，我就告诉发送者：对不起，没有认证。</p>
<a class="lightgallery" href="https://i.loli.net/2020/12/26/KMgLj9wrsQG5ufO.png" title="token验证" data-thumbnail="https://i.loli.net/2020/12/26/KMgLj9wrsQG5ufO.png">
        <img
            class="lazyload"
            src="/myblog/svg/loading.min.svg"
            data-src="https://i.loli.net/2020/12/26/KMgLj9wrsQG5ufO.png"
            data-srcset="https://i.loli.net/2020/12/26/KMgLj9wrsQG5ufO.png, https://i.loli.net/2020/12/26/KMgLj9wrsQG5ufO.png 1.5x, https://i.loli.net/2020/12/26/KMgLj9wrsQG5ufO.png 2x"
            data-sizes="auto"
            alt="https://i.loli.net/2020/12/26/KMgLj9wrsQG5ufO.png" />
    </a>
<p>Token 中的数据是明文保存的（虽然我会用Base64做下编码，但那不是加密），还是可以被别人看到的，所以我不能在其中保存像密码这样的敏感信息。</p>
<p>当然，如果一个人的token被别人偷走了，那我也没办法，我也会认为小偷就是合法用户，这其实和一个人的session id被别人偷走是一样的。</p>
<p>这样一来，我就不保存session id了，我只是生成token，然后验证token，我用我的CPU计算时间获取了我的session存储空间 ！</p>
<h2 id="cookie">cookie</h2>
<p>cookie 是一个非常具体的东西，指的就是浏览器里面能永久存储的一种数据，仅仅是浏览器实现的一种数据存储功能。</p>
<p>cookie由服务器生成，发送给浏览器，浏览器把cookie以kv形式保存到某个目录下的文本文件内，下一次请求同一网站时会把该cookie发送给服务器。</p>
<p>由于cookie是存在客户端上的，所以浏览器加入了一些限制确保cookie不会被恶意使用，同时不会占据太多磁盘空间，所以每个域的cookie数量是有限的。</p>
<h2 id="token的身份验证">Token的身份验证</h2>
<div class="details admonition digest">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>流程<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ol>
<li>用户通过用户名和密码发送请求。</li>
<li>程序验证。</li>
<li>程序返回一个签名的token 给客户端。</li>
<li>客户端储存token，并且每次用于每次发送请求。</li>
<li>服务端验证token并返回数据。</li>
</ol>
</div>
        </div>
    </div>
<a class="lightgallery" href="https://i.loli.net/2020/12/26/2R8N75PQVxlKvej.png" title="token验证" data-thumbnail="https://i.loli.net/2020/12/26/2R8N75PQVxlKvej.png">
        <img
            class="lazyload"
            src="/myblog/svg/loading.min.svg"
            data-src="https://i.loli.net/2020/12/26/2R8N75PQVxlKvej.png"
            data-srcset="https://i.loli.net/2020/12/26/2R8N75PQVxlKvej.png, https://i.loli.net/2020/12/26/2R8N75PQVxlKvej.png 1.5x, https://i.loli.net/2020/12/26/2R8N75PQVxlKvej.png 2x"
            data-sizes="auto"
            alt="https://i.loli.net/2020/12/26/2R8N75PQVxlKvej.png" />
    </a>
<h2 id="jwt">JWT</h2>
<p>JSON Web Token（缩写 JWT）是目前最流行的跨域认证解决方案。</p>
<h3 id="jwt的原理">JWT的原理</h3>
<p>JWT 的原理是，服务器认证以后，生成一个 JSON 对象，发回给用户。以后，用户与服务端通信的时候，都要发回这个 JSON 对象。服务器完全只靠这个对象认定用户身份。为了防止用户篡改数据，服务器在生成这个对象的时候，会加上签名。</p>
<p>JWT 的数据结构
它是一个很长的字符串，中间用点（.）分隔成三个部分。</p>
<p>JWT 的三个部分依次如下。</p>
<a class="lightgallery" href="https://i.loli.net/2020/12/26/N7aIfcqWjYh5kZl.png" title="token验证" data-thumbnail="https://i.loli.net/2020/12/26/N7aIfcqWjYh5kZl.png">
        <img
            class="lazyload"
            src="/myblog/svg/loading.min.svg"
            data-src="https://i.loli.net/2020/12/26/N7aIfcqWjYh5kZl.png"
            data-srcset="https://i.loli.net/2020/12/26/N7aIfcqWjYh5kZl.png, https://i.loli.net/2020/12/26/N7aIfcqWjYh5kZl.png 1.5x, https://i.loli.net/2020/12/26/N7aIfcqWjYh5kZl.png 2x"
            data-sizes="auto"
            alt="https://i.loli.net/2020/12/26/N7aIfcqWjYh5kZl.png" />
    </a>
<p>Header 部分是一个 JSON 对象，描述 JWT 的元数据，
Payload 部分也是一个 JSON 对象，用来存放实际需要传递的数据。JWT 规定了7个官方字段供选用。
Signature 部分是对前两部分的签名，防止数据篡改。</p>
<h2 id="项目实例">项目实例</h2>
<p>我们现在看下项目中的应用实例</p>
<h3 id="生成token">生成token</h3>
<p>先来看看后端是如何生成一个token的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&#34;/login&#34;</span><span class="p">,</span> <span class="kr">async</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">{</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">userinfo_pw</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">query</span><span class="p">(</span><span class="nx">my_user_info_with_password</span><span class="p">,</span> <span class="p">[</span><span class="nx">username</span><span class="p">]);</span>
  <span class="kr">const</span> <span class="nx">md5_pw</span> <span class="o">=</span> <span class="nx">md5</span><span class="p">(</span><span class="nx">password</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">userinfo_pw</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
      <span class="nx">code</span><span class="o">:</span> <span class="mi">4001</span><span class="p">,</span>
      <span class="nx">msg</span><span class="o">:</span> <span class="s2">&#34;no such user&#34;</span>
    <span class="p">});</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">md5_pw</span> <span class="o">===</span> <span class="nx">userinfo_pw</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">password</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="nx">iss</span><span class="o">:</span> <span class="s2">&#34;joyinn&#34;</span><span class="p">,</span>
        <span class="nx">aud</span><span class="o">:</span> <span class="nx">username</span><span class="p">,</span>
        <span class="nx">uid</span><span class="o">:</span> <span class="nx">userinfo_pw</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">uid</span>
      <span class="p">},</span>
      <span class="nx">myconfig</span><span class="p">.</span><span class="nx">jwtSecret</span><span class="p">,</span>
      <span class="p">{</span>
        <span class="c1">// 授权时效1day
</span><span class="c1"></span>        <span class="nx">expiresIn</span><span class="o">:</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span>
      <span class="p">}</span>
    <span class="p">);</span>
    <span class="c1">// update last login time
</span><span class="c1"></span>    <span class="kr">await</span> <span class="nx">query</span><span class="p">(</span><span class="nx">update_logintime</span><span class="p">,</span> <span class="p">[</span><span class="nx">userinfo_pw</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">uid</span><span class="p">]);</span>
    <span class="c1">// get userinfo
</span><span class="c1"></span>    <span class="kr">const</span> <span class="nx">userinfo</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">query</span><span class="p">(</span><span class="nx">my_user_info</span><span class="p">,</span> <span class="p">[</span><span class="nx">username</span><span class="p">]);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
      <span class="nx">code</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nx">msg</span><span class="o">:</span> <span class="s2">&#34;login ok&#34;</span><span class="p">,</span>
      <span class="nx">token</span><span class="p">,</span>
      <span class="nx">user</span><span class="o">:</span> <span class="nx">userinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">});</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
      <span class="nx">code</span><span class="o">:</span> <span class="mi">4002</span><span class="p">,</span>
      <span class="nx">msg</span><span class="o">:</span> <span class="s2">&#34;wrong password&#34;</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>当响应login handler，比对密码正确后，调用<code>jsonwebtoken</code>依赖库生成token</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">jwt</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;jsonwebtoken&#34;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span>
    <span class="p">{</span>
    <span class="nx">iss</span><span class="o">:</span> <span class="s2">&#34;joyinn&#34;</span><span class="p">,</span>
    <span class="nx">aud</span><span class="o">:</span> <span class="nx">username</span><span class="p">,</span>
    <span class="nx">uid</span><span class="o">:</span> <span class="nx">userinfo_pw</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">uid</span>
    <span class="p">},</span>
    <span class="nx">myconfig</span><span class="p">.</span><span class="nx">jwtSecret</span><span class="p">,</span>
    <span class="p">{</span>
    <span class="c1">// 授权时效1day
</span><span class="c1"></span>    <span class="nx">expiresIn</span><span class="o">:</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span>
    <span class="p">}</span>
<span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>这里<code>jwt.sign(payload, secretOrPrivateKey, [options, callback])</code>，具体文档可以参考<a href="https://github.com/auth0/node-jsonwebtoken" target="_blank" rel="noopener noreffer">jsonwebtoken</a></p>
<h3 id="判断token正确性">判断token正确性</h3>
<p>依旧是后端，我们怎么判断用户的请求携带的登录态信息是正确的
根据上面陈述的token原理，我们只需要利用secret对JWT的前两段加密得到签名，比对JWT给出的签名即可</p>
<p>具体实现我们可以采用express-jwt依赖库，会对headers中的Authorization字段的token进行检验</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// filename: app.js
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">expressJWT</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;express-jwt&#34;</span><span class="p">);</span>

<span class="c1">// ... other code
</span><span class="c1"></span>
<span class="c1">// 设置允许跨域访问该服务.
</span><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Access-Control-Allow-Origin&#34;</span><span class="p">,</span> <span class="s2">&#34;*&#34;</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="s2">&#34;Access-Control-Allow-Methods&#34;</span><span class="p">,</span> <span class="s2">&#34;GET,HEAD,OPTIONS,POST,PUT&#34;</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span>
    <span class="s2">&#34;Access-Control-Allow-Headers&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Origin, X-Requested-With, Content-Type, Accept, Authorization&#34;</span>
  <span class="p">);</span>
  <span class="nx">next</span><span class="p">();</span>
<span class="p">});</span>
<span class="c1">// jwt auth
</span><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
  <span class="nx">expressJWT</span><span class="p">({</span>
    <span class="nx">secret</span><span class="o">:</span> <span class="nx">myconfig</span><span class="p">.</span><span class="nx">jwtSecret</span>
  <span class="p">}).</span><span class="nx">unless</span><span class="p">({</span>
    <span class="nx">path</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">&#34;/user/login&#34;</span><span class="p">,</span>
      <span class="s2">&#34;/user/register&#34;</span><span class="p">,</span>
      <span class="s2">&#34;/user/mailtozju&#34;</span><span class="p">,</span>
      <span class="s2">&#34;/user/checkvalidcode&#34;</span>
    <span class="p">]</span> <span class="c1">//除了这个地址，其他的URL都需要验证
</span><span class="c1"></span>  <span class="p">})</span>
<span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>我们这里将jwt验证中间件放在url响应函数之前，同时通过unless参数设置不需要jwt检验的api，实现了一个拦截层中间件</p>
<h3 id="访问jwt内部payload">访问jwt内部payload</h3>
<p>中间件会将验证解析好的数据放在request里面，比如我们在handler里面可以通过req.user访问到token的所有信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// post one say
</span><span class="c1"></span><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">{</span> <span class="nx">photo</span><span class="p">,</span> <span class="nx">say_text</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">uid</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">uid</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">);</span>

  <span class="kr">const</span> <span class="nx">photoNum</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">photo</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;photoNum&#34;</span><span class="p">,</span> <span class="nx">photoNum</span><span class="p">);</span>
  <span class="kd">let</span> <span class="nx">type</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">photoNum</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">type</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">say_text</span> <span class="o">===</span> <span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="nx">type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">else</span> <span class="nx">type</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">insertResult</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">query</span><span class="p">(</span><span class="nx">post_say</span><span class="p">,</span> <span class="p">[</span><span class="nx">type</span><span class="p">,</span> <span class="nx">say_text</span><span class="p">,</span> <span class="nx">photo</span><span class="p">,</span> <span class="nx">uid</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
    <span class="nx">code</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">msg</span><span class="o">:</span> <span class="s2">&#34;insert success&#34;</span><span class="p">,</span>
    <span class="nx">insertId</span><span class="o">:</span> <span class="nx">insertResult</span><span class="p">.</span><span class="nx">insertId</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="前端http通信的设置">前端http通信的设置</h3>
<p>这里我的实例项目是<code>vuejs</code>，http通信采用了<code>axios</code>，作为一个plugin被调用</p>
<p>我们为了实现jwt加载，需要在发送数据包和接收数据包的时候均对axios模块添加一些逻辑</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// 在发送之前检查localstorage里面有无token字段，如果有就写入Authorization字段
</span><span class="c1"></span><span class="mi">_</span><span class="nx">axios</span><span class="p">.</span><span class="nx">interceptors</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">my_token</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s2">&#34;token&#34;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">my_token</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">config</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="s2">&#34;Authorization&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">my_token</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">config</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">);</span>
<span class="c1">// 在收到以后检查response中有无token字段，如果有就将token写入到localstorage中
</span><span class="c1">// 如果响应发生了错误（一般是由于在未登录状态下访问api、或者token有误导致被express-jwt拦截）
</span><span class="c1">// 那么就移除token并且跳转到登录页面
</span><span class="c1"></span><span class="mi">_</span><span class="nx">axios</span><span class="p">.</span><span class="nx">interceptors</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s2">&#34;token&#34;</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">token</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">response</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">errRes</span> <span class="o">=</span> <span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">errRes</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">401</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s2">&#34;token&#34;</span><span class="p">);</span>
        <span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&#34;/login&#34;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>我对vue默认的axios plugin做了二次封装，添加了传入自定义config以及token支持，详细代码可见<a href="https://gist.github.com/wkk5194/26ce5ecaeaf08c0e428c4533c9844217" target="_blank" rel="noopener noreffer">gist</a></p>
<script type="application/javascript" src="https://gist.github.com/wkk5194/26ce5ecaeaf08c0e428c4533c9844217.js"></script>

<h3 id="bonus-路由守卫">bonus: 路由守卫</h3>
<p>我们有了用户登录态，对vue路由守卫实践起来自然就容易了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">Vue</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">Router</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">router</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Router</span><span class="p">({</span>
  <span class="nx">mode</span><span class="o">:</span> <span class="s2">&#34;history&#34;</span><span class="p">,</span>
  <span class="nx">base</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">BASE_URL</span><span class="p">,</span>
  <span class="nx">routes</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nx">path</span><span class="o">:</span> <span class="s2">&#34;/&#34;</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;home&#34;</span><span class="p">,</span>
      <span class="nx">component</span><span class="o">:</span> <span class="nx">Home</span><span class="p">,</span>
      <span class="nx">meta</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">requireAuth</span><span class="o">:</span> <span class="kc">true</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nx">path</span><span class="o">:</span> <span class="s2">&#34;/login&#34;</span><span class="p">,</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;login&#34;</span><span class="p">,</span>
      <span class="nx">component</span><span class="o">:</span> <span class="nx">Login</span><span class="p">,</span>
      <span class="nx">meta</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">requireAuth</span><span class="o">:</span> <span class="kc">false</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="c1">// ... more routes
</span><span class="c1"></span>  <span class="p">]</span>
<span class="p">});</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">beforeEach</span><span class="p">((</span><span class="nx">to</span><span class="p">,</span> <span class="nx">from</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s2">&#34;token&#34;</span><span class="p">)</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">matched</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">record</span> <span class="p">=&gt;</span> <span class="nx">record</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">requireAuth</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Auth</span><span class="p">.</span><span class="nx">loggedIn</span><span class="p">(</span><span class="nx">token</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">next</span><span class="p">(</span><span class="s2">&#34;/login&#34;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">isLogin</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&#34;/user/getuserinfo&#34;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
          <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="s2">&#34;setUser&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">user</span><span class="p">);</span>
          <span class="nx">next</span><span class="p">();</span>
        <span class="p">});</span>
      <span class="p">}</span> <span class="k">else</span> <span class="nx">next</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">path</span> <span class="o">===</span> <span class="s2">&#34;/login&#34;</span> <span class="o">&amp;&amp;</span> <span class="nx">Auth</span><span class="p">.</span><span class="nx">loggedIn</span><span class="p">(</span><span class="nx">token</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">next</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">next</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">});</span>
<span class="kr">export</span> <span class="k">default</span> <span class="nx">router</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>我们对路由的meta对象加入requireAuth，设置布尔值表示是否需要路由守卫</p>
<p>接下来在<code>router.beforeEach</code>函数中对token进行检验，剩余对state更新以及路由跳转等逻辑我想不需要再赘述</p>
<h3 id="btw">btw</h3>
<p>如果对这一工程实例感兴趣的话可以查看<a href="https://github.com/ZJU-PAPIC/joyinn" target="_blank" rel="noopener noreffer">joyinn</a></p>
<p>这是一个论坛的demo，采用expressjs+mysql+vue全家桶，说不定你能有所启发呢！</p>
</div></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by Hugo | Theme is LoveIt
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/landingwind" target="_blank">wkk</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/myblog/lib/katex/katex.min.4afae7d446ba01ebf7fff19893eaf3a1.css" integrity="md5-Svrn1Ea6Aev3//GYk&#43;rzoQ=="><link rel="stylesheet" href="/myblog/lib/katex/copy-tex.min.b1994d1b9785dd8801dbf655df7bf6d9.css" integrity="md5-sZlNG5eF3YgB2/ZV33v22Q=="><link rel="stylesheet" href="/myblog/lib/cookieconsent/cookieconsent.min.acf82ee47549fdc386d02768992a49ad.css" integrity="md5-rPgu5HVJ/cOG0CdomSpJrQ=="><script type="text/javascript" src="/myblog/lib/smooth-scroll/smooth-scroll.min.100efdceabf7a138f3297e437d078f74.js" integrity="md5-EA79zqv3oTjzKX5DfQePdA=="></script><script type="text/javascript" src="/myblog/lib/lazysizes/lazysizes.min.b80e49640d4794d4333d00db76ea22f7.js" integrity="md5-uA5JZA1HlNQzPQDbduoi9w=="></script><script type="text/javascript" src="/myblog/lib/clipboard/clipboard.min.af8ab36589315582ccdd82f22e84bffb.js" integrity="md5-r4qzZYkxVYLM3YLyLoS/&#43;w=="></script><script type="text/javascript" src="/myblog/lib/katex/katex.min.c158c9e823b681cf535f46596b5e4eac.js" integrity="md5-wVjJ6CO2gc9TX0ZZa15OrA=="></script><script type="text/javascript" src="/myblog/lib/katex/auto-render.min.28cd0b98cd3f4fa37d52f3ffe47ad9d4.js" integrity="md5-KM0LmM0/T6N9UvP/5HrZ1A=="></script><script type="text/javascript" src="/myblog/lib/katex/copy-tex.min.bfaec7d1dea915d74a7a6d833f0ff62e.js" integrity="md5-v67H0d6pFddKem2DPw/2Lg=="></script><script type="text/javascript" src="/myblog/lib/katex/mhchem.min.1bbb252363e83547d4b2186a41eaca28.js" integrity="md5-G7slI2PoNUfUshhqQerKKA=="></script><script type="text/javascript" src="/myblog/lib/cookieconsent/cookieconsent.min.4a48532bf0b17c058b8b6854f49de23f.js" integrity="md5-SkhTK/CxfAWLi2hU9J3iPw=="></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/myblog/js/theme.min.7bc7989e979c4a19d97db3ab311a80fe.js" integrity="md5-e8eYnpecShnZfbOrMRqA/g=="></script></body>
</html>
